{"version":3,"sources":["serviceWorker.js","store/types.ts","store/reducer.ts","store/index.ts","components/Visualizer/Visualizations/VisualizationHOC.tsx","utils/colors.ts","components/Visualizer/Visualizations/Waveform/index.tsx","components/Visualizer/Visualizations/Waveform/utils.ts","components/Visualizer/Visualizations/Drummer/index.tsx","components/Visualizer/Visualizations/Halpern/three/sceneManager.ts","components/Visualizer/Visualizations/Halpern/three/entities/polys.ts","components/Visualizer/Visualizations/Halpern/three/entities/camera.ts","components/Visualizer/Visualizations/Halpern/three/entities/renderer.ts","components/Visualizer/Visualizations/Halpern/index.tsx","components/Visualizer/Visualizations/Stars/three/entities/shaders.ts","components/Visualizer/Visualizations/Stars/three/entities/polys.ts","components/Visualizer/Visualizations/Stars/three/entities/light.ts","components/Visualizer/Visualizations/Stars/three/sceneManager.ts","components/Visualizer/Visualizations/Stars/three/entities/renderer.ts","components/Visualizer/Visualizations/Stars/three/entities/camera.ts","components/Visualizer/Visualizations/Stars/index.tsx","components/Visualizer/Visualizations/Rain/renderer.ts","utils/index.ts","components/Visualizer/Visualizations/Rain/city/building.ts","components/Visualizer/Visualizations/Rain/city/index.ts","components/Visualizer/Visualizations/Rain/rain.ts","components/Visualizer/Visualizations/Rain/home/wall.ts","components/Visualizer/Visualizations/Rain/utils.ts","components/Visualizer/Visualizations/Rain/home/window.ts","components/Visualizer/Visualizations/Rain/home/dresser.ts","components/Visualizer/Visualizations/Rain/home/pictures.ts","components/Visualizer/Visualizations/Rain/home/table.ts","components/Visualizer/Visualizations/Rain/home/clock.ts","components/Visualizer/Visualizations/Rain/home/cat.ts","components/Visualizer/Visualizations/Rain/home/lamp.ts","components/Visualizer/Visualizations/Rain/home/index.ts","components/Visualizer/Visualizations/Rain/index.tsx","components/Visualizer/Visualizations/index.tsx","components/Visualizer/Visualizations/MobileDisabled/index.tsx","components/Visualizer/VisualizationSelector.tsx","components/Analyser/index.tsx","config/index.ts","components/Loading/index.tsx","components/Controls/QualitySelect/index.tsx","store/actions.ts","components/Controls/index.tsx","components/NoWebAudioApi/index.tsx","App.tsx","utils/hooks.ts","index.tsx"],"names":["Boolean","window","location","hostname","match","ActionConstants","initialState","currentVisualizationIndex","prevVisualizationIndex","quality","store","createStore","state","arguments","length","undefined","action","type","GO_TO_NEXT_VISUALIZATION","Object","objectSpread","GO_TO_PREV_VISUALIZATION","SET_QUALITY","__REDUX_DEVTOOLS_EXTENSION__","defaultProps","data","Uint8Array","lowPassData","options","wrap","WrappedComponent","_ref","rawIntensitiesRef","useRef","lowPassIntensitiesRef","startingTimestampRef","Date","now","totalDifferenceFromRawBaseline","totalDifferenceFromLowBaseline","renderedData","map","rawDataElement","i","Math","abs","lowPassDataElement","smoothing","sum","count","rangeIndex","rawIntensityMax","lowPassIntensitySum","lowPassIntensityCount","lowPassIntensityMax","current","forEach","rawIntensity","lowPassIntensity","currentRawIntensity","recentLowPassAvgIntensity","currentLowPassIntensity","concat","shift","isBeat","react_default","a","createElement","intensity","colorTriples","colorTriple","id","randomColorTriple","floor","random","getRandomColors","numColors","areUnique","colors","randomTriple","randomColor","includes","push","getRandomColor","getRandomColorTriple","colorCopy","toConsumableArray","reverse","VisualizationHOC","canvasRef","useEffect","canvas","resizeCanvas","_window","innerWidth","innerHeight","_window$devicePixelRa","devicePixelRatio","width","height","ctx","getContext","fillStyle","fillRect","addEventListener","removeEventListener","intervalId","setInterval","clearInterval","lineWidth","lineCap","getColors","sliceWidth","color","strokeStyle","beginPath","x","moveTo","dataElement","y","lineTo","stroke","className","ref","QUALITY","0","NUM_DRUMMERS","1","2","_useState","useState","_useState2","slicedToArray","size","setSize","_useState3","_useState4","colorSize","setColorSize","colorsRef","values","lastChangedTimestamp","onResize","maxSideLength","max","colorDiameter","sqrt","pow","numDrummers","freqMap","numPerSlice","freqKey","freqData","ceiling","newColor","drummers","entries","_ref2","_ref3","hitCount","drummerContainerSize","key","style","opacity","classNames","hit","MIN_HIT_COUNT","smallestDrummerSize","transitions","useTransition","from","item","backgroundColor","scale","enter","leave","config","slow","_ref4","props","_ref5","objectWithoutProperties","web","div","transform","interpolate","s","DELAY_BEFORE_ROTATING_X","CAMERA_MAX_DISTANCE","CAMERA_DRIFT","ROTATE_Y","ROTATE_X","sphereSegments","sceneManager","rendererContainer","animationFrameId","segments","sceneInitializedTimestamp","t","sphereGeometry","SphereGeometry","halpern","vertices","parameters","radius","widthSegments","heightSegments","positions","Float32Array","vertex","toArray","geometry","BufferGeometry","addAttribute","BufferAttribute","attributes","position","dynamic","material","PointsMaterial","TextureLoader","load","alphaTest","transparent","Points","createPoints","camera","startingY","PerspectiveCamera","set","lookAt","Vector3","createCamera","renderer","WebGLRenderer","alpha","setPixelRatio","setClearColor","createRenderer","appendChild","domElement","scene","Scene","add","clock","Clock","aspect","updateProjectionMatrix","render","onVisibilityChange","document","visibilityState","stop","start","animate","delta","getDelta","rotateY","rotateX","PI","translateY","cos","translateX","translateZ","requestAnimationFrame","cleanup","cancelAnimationFrame","removeChild","remove","dispose","RIPPLE_SPEED","rendererRef","managedSceneRef","originalVerticesRef","sphereDataSegmentsRef","vertexSegmentLengthRef","focusedDataRef","Array","fill","managedScene","halpernGeometry","array","slice","rippleSpeed","focusedDataIndex","splice","halpernBufferPositions","getAttribute","vertexSegmentIndex","ceil","dataIndex","vertexSegmentWeight","min","scalar","needsUpdate","starVertexShader","starFragmentShader","createCloud","texture","PlaneGeometry","cloudMaterial","MeshLambertMaterial","depthTest","rotateZ","cloud","Mesh","zPosition","createDirectionalLight","DirectionalLight","MAX_STAR_ALPHA","MIN_STAR_ALPHA","STAR_ALPHA_DELTA","STATIC_LIGHT_COLOR","VARIABLE_LIGHT_COLOR","STAR_COUNT","CLOUD_COUNT","lightIntensity","antialias","stars","starCount","alphas","j","shaderMaterial","ShaderMaterial","uniforms","value","Color","vertexShader","fragmentShader","createStars","cloudCover","Group","cloudCount","aLight","AmbientLight","fixedDLight","dLight","starAlphas","alphaDirection","children","lightTimestampRef","currentLightIntensity","newLightIntensity","WINDOW_FRAME_THICKNESS_DIVISOR","Renderer","classCallCheck","this","canvasWidth","canvasHeight","oneThirdCanvasWidth","oneHalfCanvasHeight","windowFrameThickness","roundedRadius","save","createClass","restore","args","modulo","number1","number2","isInteger","number","randomNumberBetween","decimalPrecision","randomFloat","Number","toPrecision","Building","blueprint","lights","lightHeight","lightPadding","lightsPerFloor","buildingXPadding","buildingTopPadding","gapWidth","lightWidth","isOn","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","next","done","light","err","return","City","_Renderer","_this","possibleConstructorReturn","getPrototypeOf","call","layers","generateBuildings","inherits","_this2","_loop","layer","gap","building","leftMostBuilding","xOffset","get","prototype","currentLayer","generateLights","RAINDROPS_HEIGHTWISE","Raindrop","raindropHeight","createdDate","timeDelta","Rainfall","raindrops","nextRaindrops","raindrop","tick","startingX","Wall","linearGradient","createLinearGradient","addColorStop","defaultCornerRadii","tl","tr","br","bl","roundedRect","quadraticCurveTo","closePath","Window","clearRect","muntinWidth","topLeftX","topRightX","topY","leftX","leftTopY","leftBottomY","rect","Dresser","dresserHandleMidpoint","speakerWidth","speakerHeight","speakerX","speakerY","driverRadius","driverCenterX","driverCenterY","arc","dividerWidth","deckX","deckHeight","deckY","deckDetailX","bottomDetailY","knobRadius","knobX","knobY","clip","translate","knobMarkerAngle","knobMarkerStart","sin","knobMarkerEnd","dresser","stereo","wooferRadius","wooferCenterY","Pictures","pictures","_assertThisInitialize","assertThisInitialized","_this$pictures$","gradient1","nodes","nodeSize","point1","point2","currentNode","pop","_i","otherNode","_this$pictures$2","gradient2","randomAngle","planetX","planetY","randomRadius","_this$pictures$3","gradient3","starX","starY","graph","orbits","FRUIT_COLORS","Table","thickness","tableCornerRadii","bowlCenterX","bowlWidth","bowlHeight","fruits","stemAngle","fruit","_i2","stemStart","stemEnd","bowlCornerRadii","bowlBaseHeight","bowlBaseWidth","bowlDecorationY","leg","top","centerpiece","clockSize","clockCoords","angle","end","hours","getHours","minutes","getMinutes","seconds","getSeconds","rotate","face","hands","Cat","isWagging","prevTailAngle","headRadius","bodyHeight","bodyWidth","createdTimestamp","tailWidth","tailY","lineJoin","rightEar","point","leftEar","head","body","tail","nextTailAngle","tailEnd","Lamp","stemX","stemHeight","lampWidth","shadeTopLeft","shadeTopRight","shadeBottomRight","shadeBottomLeft","lightAngle","deltaX","deltaY","atan2","radiansBetween","lightTriangleAdjacentWidth","tan","lightBottomLeftX","lightBottomRightX","stem","lampshade","Home","wall","table","MAX_RAINDROPS_PER_TICK","cityCanvasRef","cityRef","cityCanvas","resizeCity","dpi","city","createCity","rainCanvasRef","rainfallRef","rainCanvas","resizeRain","_window2","rainfall","createRain","homeCanvasRef","homeRef","clockInterval","homeCanvas","resizeHome","_window3","home","clearTimeout","createHome","catCanvasRef","catRef","catCanvas","resizeCat","_window4","cat","adoptCat","lampCanvasRef","lampRef","lampCanvas","resizeLamp","_window5","lamp","createLamp","newRaindropsAdded","raindropsToAdd","visualizations","src","process","test","navigator","userAgent","component","Rain","Stars","Waveform","Drummer","Halpern","styledVisualizations","vis","rest","assign","connect","currentIndex","prevIndex","visIndex","direction","useCallback","prev","translateXMultiplier","initial","Fragment","Visualization","Analyser","context","source","rawData","setRawData","setLowPassData","animationFrameIdRef","rawAnalyser","createAnalyser","fftSize","smoothingTimeConstant","destination","filter","createBiquadFilter","lowPassAnalyser","rawDataContainer","getByteTimeDomainData","lowPassDataContainer","disconnect","Visualizer_VisualizationSelector","Loading","show","qualities","label","dispatch","setQuality","Actions","onHover","onHoverStop","onMouseEnter","onMouseLeave","onChange","e","target","goToNextVisualization","goToPrevVisualization","isOverlayShown","setIsOverlayShown","isControlHovered","setIsControlHovered","timeoutRef","touchTimestampRef","onKeyDown","event","which","showOverlay","setTimeout","togglePlay","resume","recordTouchTimestamp","preventDefault","goToRepo","open","onMouseDown","nativeEvent","onMouseUp","onTouchEnd","onPrev","stopPropagation","onNext","doNothing","wantsToPlay","isPlaying","components_Loading","onTouchStart","onMouseMove","onClick","Controls_QualitySelect","versionInfo","play","pause","viewBox","strokeWidth","strokeLinecap","strokeLinejoin","points","NoWebAudioApi","App","setWantsToPlay","setIsPlaying","_useStateRef","setState","stateRef","useStateRef","_useStateRef2","setContext","contextRef","_useState5","_useState6","setSource","_useState7","_useState8","isContextUnavailable","setIsContextUnavailable","audioRef","AudioContext","audioElement","onAudioPlay","onAudioPause","onAudioError","console","error","initializeAudioContext","createMediaElementSource","paused","components_NoWebAudioApi","preload","crossOrigin","components_Analyser","components_Controls","ReactDOM","es","src_App","getElementById","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.37464813.chunk.js","sourcesContent":["// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","export type Quality = 0 | 1 | 2;\r\n\r\nexport type StoreState = {\r\n  currentVisualizationIndex: number;\r\n  prevVisualizationIndex: number;\r\n  quality: Quality;\r\n};\r\n\r\nexport enum ActionConstants {\r\n  BEGIN_VISUALIZATION_TRANSITION = 'BEGIN_VISUALIZATION_TRANSITION',\r\n  END_VISUALIZATION_TRANSITION = 'END_VISUALIZATION_TRANSITION',\r\n  GO_TO_PREV_VISUALIZATION = 'GO_TO_PREV_VISUALIZATION',\r\n  GO_TO_NEXT_VISUALIZATION = 'GO_TO_NEXT_VISUALIZATION',\r\n  SET_QUALITY = 'SET_QUALITY'\r\n}\r\n\r\ninterface GoToNextVisualizationAction {\r\n  type: typeof ActionConstants.GO_TO_NEXT_VISUALIZATION;\r\n}\r\n\r\ninterface GoToPrevVisualizationAction {\r\n  type: typeof ActionConstants.GO_TO_PREV_VISUALIZATION;\r\n}\r\n\r\ninterface SetQualityAction {\r\n  type: typeof ActionConstants.SET_QUALITY;\r\n  quality: Quality;\r\n}\r\n\r\nexport type ActionUnionType =\r\n  | GoToNextVisualizationAction\r\n  | GoToPrevVisualizationAction\r\n  | SetQualityAction;\r\n","import { StoreState, ActionConstants, ActionUnionType } from './types';\r\n\r\nconst initialState: StoreState = {\r\n  currentVisualizationIndex: 0,\r\n  prevVisualizationIndex: 0,\r\n  quality: 2\r\n};\r\n\r\nexport default function reducer(\r\n  state = initialState,\r\n  action: ActionUnionType\r\n): StoreState {\r\n  switch (action.type) {\r\n    case ActionConstants.GO_TO_NEXT_VISUALIZATION:\r\n      return {\r\n        ...state,\r\n        currentVisualizationIndex: state.currentVisualizationIndex + 1,\r\n        prevVisualizationIndex: state.currentVisualizationIndex\r\n      };\r\n\r\n    case ActionConstants.GO_TO_PREV_VISUALIZATION:\r\n      return {\r\n        ...state,\r\n        currentVisualizationIndex: state.currentVisualizationIndex - 1,\r\n        prevVisualizationIndex: state.currentVisualizationIndex\r\n      };\r\n\r\n    case ActionConstants.SET_QUALITY:\r\n      return {\r\n        ...state,\r\n        quality: action.quality\r\n      };\r\n\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n","import { createStore } from 'redux';\r\nimport reducer from './reducer';\r\n\r\nconst store = createStore(\r\n  reducer,\r\n  (window as any).__REDUX_DEVTOOLS_EXTENSION__ &&\r\n    (window as any).__REDUX_DEVTOOLS_EXTENSION__()\r\n);\r\n\r\nexport default store;\r\n","import React, { useState, useEffect, useRef } from 'react';\r\nimport { Options } from './index';\r\nimport { Quality } from '../../../store/types';\r\nimport './Visualization.scss';\r\n\r\nexport type Props = {\r\n  // array of frequency data with values 0-255\r\n  data: Uint8Array;\r\n  lowPassData: Uint8Array;\r\n  options?: Options;\r\n  quality: Quality;\r\n};\r\n\r\nexport type WrappedProps = {\r\n  data: Uint8Array;\r\n  lowPassData: Uint8Array;\r\n  isBeat: boolean;\r\n  intensity: number;\r\n  lowPassIntensity: number;\r\n  quality: Quality;\r\n};\r\n\r\nconst defaultProps: Props = {\r\n  data: new Uint8Array(),\r\n  lowPassData: new Uint8Array(),\r\n  options: {},\r\n  quality: 2\r\n};\r\n\r\n// all visualization components should be wrapped with this HOC\r\nexport function wrap(\r\n  WrappedComponent: React.ComponentType<WrappedProps>\r\n): React.ComponentType<Props> {\r\n  return function({\r\n    data,\r\n    lowPassData,\r\n    options,\r\n    quality\r\n  }: Props = defaultProps) {\r\n    const rawIntensitiesRef = useRef<number[]>([]);\r\n    const lowPassIntensitiesRef = useRef<number[]>([]);\r\n    const startingTimestampRef = useRef<number>(Date.now());\r\n\r\n    let totalDifferenceFromRawBaseline = 0;\r\n    let totalDifferenceFromLowBaseline = 0;\r\n\r\n    const renderedData = data.map((rawDataElement, i) => {\r\n      totalDifferenceFromRawBaseline += Math.abs(rawDataElement - 128);\r\n\r\n      const lowPassDataElement = lowPassData[i];\r\n      totalDifferenceFromLowBaseline += Math.abs(lowPassDataElement - 128);\r\n\r\n      if (options == null || !options.smoothing) {\r\n        return rawDataElement;\r\n      } else {\r\n        // smooth out each data value using a range of values around it,\r\n        // the range of this window is the value of options.smoothing\r\n        let sum = 0;\r\n        let count = 0;\r\n\r\n        let rangeIndex = i - options.smoothing;\r\n\r\n        while (rangeIndex < i + options.smoothing) {\r\n          const rawDataAtRangeIndex = data[rangeIndex] || 128;\r\n          sum += rawDataAtRangeIndex;\r\n          count += 1;\r\n          rangeIndex += 1;\r\n        }\r\n\r\n        return sum / count;\r\n      }\r\n    });\r\n\r\n    let rawIntensityMax = 0;\r\n\r\n    let lowPassIntensitySum = 0;\r\n    let lowPassIntensityCount = 0;\r\n    let lowPassIntensityMax = 0;\r\n\r\n    rawIntensitiesRef.current.forEach((rawIntensity, i) => {\r\n      if (rawIntensity > rawIntensityMax) {\r\n        rawIntensityMax = rawIntensity;\r\n      }\r\n\r\n      const lowPassIntensity = lowPassIntensitiesRef.current[i];\r\n      lowPassIntensitySum += lowPassIntensity;\r\n      lowPassIntensityCount += 1;\r\n\r\n      if (lowPassIntensity > lowPassIntensityMax) {\r\n        lowPassIntensityMax = lowPassIntensity;\r\n      }\r\n    });\r\n\r\n    const currentRawIntensity = totalDifferenceFromRawBaseline / data.length;\r\n    const recentLowPassAvgIntensity =\r\n      lowPassIntensitySum / lowPassIntensityCount || 0;\r\n\r\n    const currentLowPassIntensity =\r\n      totalDifferenceFromLowBaseline / lowPassData.length;\r\n\r\n    rawIntensitiesRef.current = rawIntensitiesRef.current.concat(\r\n      currentRawIntensity\r\n    );\r\n    lowPassIntensitiesRef.current = lowPassIntensitiesRef.current.concat(\r\n      currentLowPassIntensity\r\n    );\r\n\r\n    // remove intensities older than 2 seconds\r\n    if (Date.now() - startingTimestampRef.current > 2000) {\r\n      rawIntensitiesRef.current.shift();\r\n      lowPassIntensitiesRef.current.shift();\r\n    }\r\n\r\n    const isBeat = currentLowPassIntensity > recentLowPassAvgIntensity * 1.5;\r\n\r\n    return (\r\n      <WrappedComponent\r\n        data={renderedData}\r\n        lowPassData={lowPassData}\r\n        isBeat={isBeat}\r\n        intensity={currentRawIntensity}\r\n        lowPassIntensity={currentLowPassIntensity}\r\n        quality={quality}\r\n      />\r\n    );\r\n  };\r\n}\r\n","const colorTriples = [\r\n  ['#0E9AA7', '#F6CD61', '#FE8A71'],\r\n  ['#EE4540', '#801336', '#2D142C'],\r\n  ['#8FB9A8', '#FDFBD4', '#FCD0BA'],\r\n  ['#AC6D83', '#685D79', '#465C7A'],\r\n  ['#F36E38', '#EF4648', '#582841'],\r\n  ['#F1F1F1', '#9BD7D1', '#305D7A'],\r\n  ['#DEA5B6', '#F3CD8C', '#F2E9C2'],\r\n  ['#E27B47', '#EFCA58', '#46B29E'],\r\n  ['#2E7345', '#2E9975', '#2DB3B3'],\r\n  ['#52A3CC', '#7EA1E5', '#AAAAF2'],\r\n  ['#CC5285', '#CC5285', '#F2BCAA'],\r\n  ['#D8E0BB', '#B6CEC7', '#86A3C3']\r\n];\r\n\r\nconst colorTriplesWithIds = colorTriples.map((colorTriple, i) => ({\r\n  id: i,\r\n  colorTriple\r\n}));\r\n\r\nfunction randomColorTriple() {\r\n  return colorTriples[Math.floor(Math.random() * colorTriples.length)];\r\n}\r\n\r\nexport function getRandomColors(numColors: number, areUnique?: boolean): string[] {\r\n  const colors: string[] = [];\r\n\r\n  while (colors.length < numColors) {\r\n    const randomTriple = randomColorTriple();\r\n    const randomColor = randomTriple[Math.floor(Math.random() * randomTriple.length)];\r\n\r\n    if (areUnique && colors.includes(randomColor)) {\r\n      break;\r\n    }\r\n\r\n    colors.push(randomColor);\r\n  }\r\n  return colors;\r\n}\r\n\r\nexport function getRandomColor() {\r\n  return getRandomColors(1)[0];\r\n}\r\n\r\nexport function getRandomColorTriple() {\r\n  const colorCopy = [...randomColorTriple()];\r\n  if (Math.random() <= 0.5) {\r\n    return colorCopy.reverse();\r\n  } else {\r\n    return colorCopy;\r\n  }\r\n}\r\n","import React, { useRef, useEffect } from 'react';\r\nimport * as VisualizationHOC from '../VisualizationHOC';\r\nimport { getColors } from './utils';\r\nimport './Waveform.scss';\r\n\r\nconst LINE_WIDTH = 10;\r\nconst LINE_X_OFFSET = 0;\r\nconst LINE_Y_OFFSET = 5;\r\n\r\nconst Waveform: React.FC<VisualizationHOC.WrappedProps> = ({\r\n  data,\r\n  quality\r\n}) => {\r\n  const canvasRef = useRef<HTMLCanvasElement>(null);\r\n\r\n  useEffect(() => {\r\n    const canvas = canvasRef.current!;\r\n\r\n    const resizeCanvas = () => {\r\n      const { innerWidth, innerHeight, devicePixelRatio = 1 } = window;\r\n\r\n      canvas.width = innerWidth * devicePixelRatio;\r\n      canvas.height = innerHeight * devicePixelRatio;\r\n\r\n      // initial paint to match fade out color from rounding error\r\n      const ctx = canvas.getContext('2d')!;\r\n      ctx.fillStyle = '#101010';\r\n      ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n    };\r\n\r\n    resizeCanvas();\r\n\r\n    window.addEventListener('resize', resizeCanvas);\r\n    return () => window.removeEventListener('resize', resizeCanvas);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const canvas = canvasRef.current!;\r\n    const ctx = canvas.getContext('2d')!;\r\n\r\n    const fadeOut = () => {\r\n      ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';\r\n      ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n    };\r\n\r\n    const intervalId = window.setInterval(fadeOut, 7);\r\n    return () => window.clearInterval(intervalId);\r\n  }, []);\r\n\r\n  // paint on every data update\r\n  useEffect(() => {\r\n    const canvas = canvasRef.current!;\r\n    const ctx = canvas.getContext('2d')!;\r\n    ctx.lineWidth = LINE_WIDTH;\r\n    ctx.lineCap = 'round';\r\n\r\n    const colors = getColors(quality + 1);\r\n\r\n    const sliceWidth = canvas.width / data.length;\r\n\r\n    colors.forEach((color, i) => {\r\n      ctx.strokeStyle = color;\r\n      ctx.beginPath();\r\n\r\n      let x = i * LINE_X_OFFSET;\r\n      ctx.moveTo(x, canvas.height / 2);\r\n\r\n      data.forEach(dataElement => {\r\n        const y =\r\n          (dataElement / 255.0) * canvas.height -\r\n          (LINE_Y_OFFSET * colors.length) / 2;\r\n        ctx.lineTo(x, y + i * ((LINE_Y_OFFSET * colors.length) / 2));\r\n        x += sliceWidth;\r\n      });\r\n\r\n      ctx.lineTo(x, canvas.height / 2);\r\n      ctx.stroke();\r\n    });\r\n  }, [data]);\r\n\r\n  return (\r\n    <div className=\"waveform\">\r\n      <div className=\"backdrop\" />\r\n      <canvas ref={canvasRef} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default VisualizationHOC.wrap(Waveform);\r\n","import {\r\n  getRandomColorTriple,\r\n  getRandomColors,\r\n  getRandomColor\r\n} from '../../../../utils/colors';\r\n\r\nexport function getColors(numColors: number) {\r\n  switch (numColors) {\r\n    case 3:\r\n      return getRandomColorTriple();\r\n    case 2:\r\n      return getRandomColors(2, true);\r\n    case 1:\r\n      return [getRandomColor()];\r\n    default:\r\n      return getRandomColorTriple();\r\n  }\r\n}\r\n","import React, { useState, useRef, useEffect } from 'react';\r\nimport { useTransition, animated, interpolate, config } from 'react-spring';\r\nimport classNames from 'classnames';\r\nimport * as VisualizationHOC from '../VisualizationHOC';\r\nimport './Drummer.scss';\r\nimport { getRandomColor } from '../../../../utils/colors';\r\nimport { DATA_SIZE } from '../../../../config';\r\nimport { QualitySettings } from '../index';\r\n\r\nconst MIN_HIT_COUNT = 0.04;\r\nconst MIN_FREQUENCY_VARIATION = 10;\r\nconst MIN_DELAY_BETWEEN_COLOR_CHANGE = 200;\r\n\r\nconst QUALITY: QualitySettings = {\r\n  0: { NUM_DRUMMERS: 6 },\r\n  1: { NUM_DRUMMERS: 10 },\r\n  2: { NUM_DRUMMERS: 16 }\r\n};\r\n\r\nconst minHitCount = MIN_HIT_COUNT * DATA_SIZE;\r\n\r\nconst Drummer: React.FC<VisualizationHOC.WrappedProps> = ({\r\n  data,\r\n  isBeat,\r\n  quality\r\n}) => {\r\n  const [size, setSize] = useState(0);\r\n  const [colorSize, setColorSize] = useState(0);\r\n\r\n  const colorsRef = useRef({\r\n    values: [getRandomColor()],\r\n    lastChangedTimestamp: Date.now()\r\n  });\r\n\r\n  useEffect(() => {\r\n    const onResize = () => {\r\n      const { innerWidth, innerHeight } = window;\r\n      const maxSideLength = Math.max(innerWidth, innerHeight);\r\n      setSize(maxSideLength * 2);\r\n\r\n      const colorDiameter = Math.sqrt(\r\n        Math.pow(innerWidth, 2) + Math.pow(innerHeight, 2)\r\n      );\r\n      setColorSize(colorDiameter);\r\n    };\r\n\r\n    onResize();\r\n\r\n    window.addEventListener('resize', onResize);\r\n    return () => window.removeEventListener('resize', onResize);\r\n  }, []);\r\n\r\n  const colors = colorsRef.current;\r\n  const numDrummers = QUALITY[quality].NUM_DRUMMERS;\r\n\r\n  const freqMap: { [key: string]: number } = {};\r\n  const numPerSlice = 256 / numDrummers;\r\n\r\n  let freqKey = 0;\r\n  while (freqKey < numDrummers) {\r\n    freqMap[freqKey] = 0;\r\n    freqKey += 1;\r\n  }\r\n\r\n  data.forEach(freqData => {\r\n    let freqKey = 0;\r\n    while (freqKey < numDrummers) {\r\n      const ceiling = numPerSlice * (freqKey + 1);\r\n      if (\r\n        Math.abs(freqData - 128) > MIN_FREQUENCY_VARIATION &&\r\n        freqData <= ceiling\r\n      ) {\r\n        freqMap[freqKey] += 1;\r\n        break;\r\n      }\r\n      freqKey += 1;\r\n    }\r\n  });\r\n\r\n  // space out background color changes so they're not jarring\r\n  const now = Date.now();\r\n  if (\r\n    isBeat &&\r\n    now - colors.lastChangedTimestamp > MIN_DELAY_BETWEEN_COLOR_CHANGE\r\n  ) {\r\n    let newColor;\r\n    do {\r\n      newColor = getRandomColor();\r\n    } while (colors.values[colors.values.length - 1] === newColor);\r\n\r\n    colors.values.push(newColor);\r\n    if (colors.values.length > 1) {\r\n      colors.values.shift();\r\n    }\r\n    colors.lastChangedTimestamp = now;\r\n  }\r\n\r\n  const drummers = Object.entries(freqMap).map(([freqKey, hitCount], i) => {\r\n    const drummerContainerSize = ((1 + +freqKey) * size) / numDrummers;\r\n\r\n    return (\r\n      <div\r\n        key={freqKey}\r\n        className=\"drummer-container\"\r\n        style={{\r\n          width: `${drummerContainerSize}px`,\r\n          height: `${drummerContainerSize}px`,\r\n          opacity: ((numDrummers - i) / numDrummers) * 0.5 * 0.25\r\n        }}\r\n      >\r\n        <div className={classNames('beat', { hit: hitCount > minHitCount })} />\r\n      </div>\r\n    );\r\n  });\r\n\r\n  const smallestDrummerSize = size / (numDrummers * 2);\r\n\r\n  const transitions = useTransition(colors.values, null, {\r\n    from: item => ({\r\n      backgroundColor: item,\r\n      width: smallestDrummerSize,\r\n      height: smallestDrummerSize,\r\n      scale: 1\r\n    }),\r\n    enter: { scale: (colorSize / smallestDrummerSize) * 1.5 },\r\n    leave: { scale: 0 },\r\n    config: config.slow\r\n  });\r\n\r\n  return (\r\n    <div className=\"drummer\">\r\n      {drummers}\r\n      {transitions.map(({ item, props, key }) => {\r\n        const { scale, ...style } = props as any;\r\n\r\n        return (\r\n          <animated.div\r\n            className=\"color-overlay\"\r\n            key={key}\r\n            style={{\r\n              ...style,\r\n              transform: interpolate(\r\n                [scale],\r\n                (s: number) => `translate3d(0, 0, 0) scale(${s})`\r\n              )\r\n            }}\r\n          />\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default VisualizationHOC.wrap(Drummer);\r\n","import { Scene, PointsMaterial, Clock } from 'three';\r\nimport { createRenderer } from './entities/renderer';\r\nimport { createCamera } from './entities/camera';\r\nimport { createSphereGeometry, createPoints } from './entities/polys';\r\nimport { Quality } from '../../../../../store/types';\r\nimport { QualitySettings } from '../../index';\r\n\r\nconst DELAY_BEFORE_ROTATING_X = 1500;\r\nconst CAMERA_MAX_DISTANCE = 200;\r\nconst CAMERA_DRIFT = 0.025;\r\nconst ROTATE_Y = -0.3;\r\nconst ROTATE_X = 0.3;\r\n\r\nconst QUALITY: QualitySettings = {\r\n  0: { sphereSegments: 30 },\r\n  1: { sphereSegments: 48 },\r\n  2: { sphereSegments: 72 }\r\n};\r\n\r\nexport default function sceneManager(\r\n  rendererContainer: HTMLDivElement,\r\n  quality: Quality\r\n) {\r\n  let animationFrameId: number;\r\n  let sceneInitializedTimestamp = Date.now();\r\n  let t = 0;\r\n\r\n  const sphereGeometry = createSphereGeometry(QUALITY[quality].sphereSegments);\r\n  const halpern = createPoints(sphereGeometry);\r\n  const camera = createCamera(CAMERA_MAX_DISTANCE);\r\n  const renderer = createRenderer();\r\n  rendererContainer.appendChild(renderer.domElement);\r\n\r\n  const scene = new Scene();\r\n  scene.add(halpern);\r\n\r\n  // clock is started in Halpern component when the\r\n  // animation loop is started\r\n  const clock = new Clock();\r\n\r\n  window.addEventListener('resize', onResize);\r\n  document.addEventListener('visibilitychange', onVisibilityChange);\r\n\r\n  function animate() {\r\n    const delta = clock.getDelta();\r\n\r\n    halpern.rotateY(ROTATE_Y * delta);\r\n\r\n    if (Date.now() - sceneInitializedTimestamp > DELAY_BEFORE_ROTATING_X) {\r\n      halpern.rotateX(ROTATE_X * delta);\r\n    }\r\n\r\n    t += delta;\r\n\r\n    if (t >= Math.PI * 2) {\r\n      t = 0;\r\n    }\r\n\r\n    camera.translateY(Math.cos(t) * CAMERA_DRIFT);\r\n    camera.translateX(Math.cos(t) * CAMERA_DRIFT);\r\n    camera.translateZ(Math.cos(t) * CAMERA_DRIFT * 5);\r\n\r\n    renderer.render(scene, camera);\r\n    animationFrameId = window.requestAnimationFrame(animate);\r\n  }\r\n\r\n  function cleanup() {\r\n    window.cancelAnimationFrame(animationFrameId);\r\n    window.removeEventListener('resize', onResize);\r\n    document.removeEventListener('visibilitychange', onVisibilityChange);\r\n    rendererContainer.removeChild(renderer.domElement);\r\n\r\n    scene.remove(halpern);\r\n\r\n    halpern.geometry.dispose();\r\n    (halpern.material as PointsMaterial).dispose();\r\n    sphereGeometry.dispose();\r\n  }\r\n\r\n  function onResize() {\r\n    camera.aspect = window.innerWidth / window.innerHeight;\r\n    camera.updateProjectionMatrix();\r\n\r\n    renderer.setSize(window.innerWidth, window.innerHeight);\r\n    renderer.render(scene, camera);\r\n  }\r\n\r\n  function onVisibilityChange() {\r\n    if (document.visibilityState === 'hidden') {\r\n      clock.stop();\r\n    } else {\r\n      clock.start();\r\n    }\r\n  }\r\n\r\n  return {\r\n    clock,\r\n    sphereGeometry,\r\n    halpern,\r\n    animate,\r\n    cleanup\r\n  };\r\n}\r\n","import {\r\n  Points,\r\n  PointsMaterial,\r\n  SphereGeometry,\r\n  BufferGeometry,\r\n  BufferAttribute,\r\n  TextureLoader\r\n} from 'three';\r\n\r\nexport function createSphereGeometry(segments: number): SphereGeometry {\r\n  return new SphereGeometry(48, segments, segments);\r\n}\r\n\r\nexport function createPoints(sphereGeometry: SphereGeometry): Points {\r\n  const pointGeometry = new SphereGeometry(\r\n    sphereGeometry.parameters.radius,\r\n    sphereGeometry.parameters.widthSegments,\r\n    sphereGeometry.parameters.heightSegments\r\n  );\r\n\r\n  const { vertices } = pointGeometry;\r\n  const positions = new Float32Array(vertices.length * 3);\r\n\r\n  vertices.forEach((vertex, i) => {\r\n    vertex.toArray(positions, i * 3);\r\n  });\r\n\r\n  const geometry = new BufferGeometry();\r\n  geometry.addAttribute('position', new BufferAttribute(positions, 3));\r\n  (geometry.attributes.position as BufferAttribute).dynamic = true;\r\n\r\n  const material = new PointsMaterial({\r\n    size: 0.5,\r\n    map: new TextureLoader().load('assets/images/point.png'),\r\n    alphaTest: 0.5,\r\n    color: 0x666666,\r\n    transparent: true\r\n  });\r\n\r\n  return new Points(geometry, material);\r\n}\r\n","import { PerspectiveCamera, Vector3 } from 'three';\r\n\r\nexport function createCamera(startingY: number) {\r\n  const camera = new PerspectiveCamera(\r\n    75,\r\n    window.innerWidth / window.innerHeight,\r\n    0.1,\r\n    1000\r\n  );\r\n\r\n  camera.position.set(0, startingY, 0);\r\n  camera.lookAt(new Vector3(0, 0, 0));\r\n\r\n  return camera;\r\n}\r\n","import { WebGLRenderer } from 'three';\r\n\r\nexport function createRenderer() {\r\n  const { innerWidth, innerHeight } = window;\r\n\r\n  const renderer = new WebGLRenderer({ alpha: true });\r\n  renderer.setPixelRatio(window.devicePixelRatio);\r\n  renderer.setSize(innerWidth, innerHeight);\r\n  renderer.setClearColor(0x000000, 0);\r\n\r\n  return renderer;\r\n}\r\n","import React, { useEffect, useRef } from 'react';\r\nimport { BufferGeometry, BufferAttribute } from 'three';\r\nimport * as VisualizationHOC from '../VisualizationHOC';\r\nimport sceneManager from './three/sceneManager';\r\nimport { QualitySettings } from '../index';\r\nimport './Halpern.scss';\r\n\r\nconst VERTEX_SEGMENT_WEIGHT_COEFFICIENT = 0.1;\r\nconst BASELINE_VERTEX_SCALAR_FACTOR = 1;\r\n\r\nconst QUALITY: QualitySettings = {\r\n  0: { RIPPLE_SPEED: 2 },\r\n  1: { RIPPLE_SPEED: 3 },\r\n  2: { RIPPLE_SPEED: 4 }\r\n};\r\n\r\nconst Halpern: React.FC<VisualizationHOC.WrappedProps> = ({\r\n  data,\r\n  quality\r\n}) => {\r\n  const rendererRef = useRef<HTMLDivElement>(null);\r\n  const managedSceneRef = useRef<any>();\r\n  const originalVerticesRef = useRef<ArrayLike<number>>();\r\n  const sphereDataSegmentsRef = useRef<number>();\r\n  const vertexSegmentLengthRef = useRef<number>();\r\n  const focusedDataRef = useRef<number[]>(new Array(data.length).fill(128));\r\n\r\n  useEffect(() => {\r\n    const rendererContainer = rendererRef.current!;\r\n    const managedScene = sceneManager(rendererContainer, quality);\r\n\r\n    managedSceneRef.current = managedScene;\r\n\r\n    const halpernGeometry = managedScene.halpern.geometry as BufferGeometry;\r\n\r\n    sphereDataSegmentsRef.current = Math.floor(\r\n      data.length / managedScene.sphereGeometry.parameters.widthSegments\r\n    );\r\n\r\n    // split vertices up into segments belonging to slices of x cross sections,\r\n    // first and last vertices are at top and bottom of sphere\r\n    vertexSegmentLengthRef.current =\r\n      (managedScene.sphereGeometry.vertices.length - 2) /\r\n      (managedScene.sphereGeometry.parameters.widthSegments - 1);\r\n\r\n    originalVerticesRef.current = (halpernGeometry.attributes.position\r\n      .array as Float32Array).slice(0);\r\n\r\n    managedScene.clock.start();\r\n\r\n    managedScene.animate();\r\n\r\n    return managedScene.cleanup;\r\n  }, [quality]);\r\n\r\n  useEffect(() => {\r\n    const rippleSpeed = QUALITY[quality].RIPPLE_SPEED;\r\n    const focusedDataIndex = Math.floor(data.length / 2);\r\n\r\n    focusedDataRef.current.splice(0, rippleSpeed);\r\n    focusedDataRef.current = focusedDataRef.current.concat(\r\n      new Array(rippleSpeed).fill(data[focusedDataIndex])\r\n    );\r\n\r\n    const halpernGeometry = managedSceneRef.current!.halpern.geometry;\r\n    const halpernBufferPositions = halpernGeometry.getAttribute('position')\r\n      .array as Float32Array;\r\n\r\n    let i = 0;\r\n    while (i < originalVerticesRef.current!.length) {\r\n      // find which segment the current index belongs to\r\n      const vertexSegmentIndex = Math.ceil(\r\n        Math.floor(i / 3) / vertexSegmentLengthRef.current!\r\n      );\r\n\r\n      const dataIndex = vertexSegmentIndex * sphereDataSegmentsRef.current!;\r\n      const vertexSegmentWeight = Math.min(\r\n        vertexSegmentIndex,\r\n        vertexSegmentLengthRef.current! - vertexSegmentIndex\r\n      );\r\n\r\n      const dataVariation =\r\n        Math.abs(focusedDataRef.current[dataIndex] - 128) / 255;\r\n\r\n      const scalar =\r\n        dataVariation *\r\n          vertexSegmentWeight *\r\n          VERTEX_SEGMENT_WEIGHT_COEFFICIENT +\r\n        BASELINE_VERTEX_SCALAR_FACTOR;\r\n\r\n      // update X, Y, and Z vector positions in BufferGeometry\r\n      halpernBufferPositions[i] = originalVerticesRef.current![i] * scalar;\r\n      halpernBufferPositions[i + 1] =\r\n        originalVerticesRef.current![i + 1] * scalar;\r\n      halpernBufferPositions[i + 2] =\r\n        originalVerticesRef.current![i + 2] * scalar;\r\n\r\n      i += 3;\r\n    }\r\n\r\n    // inform three.js that vertices should be repositioned,\r\n    // final render is handled in sceneManager animate loop\r\n    (halpernGeometry.getAttribute(\r\n      'position'\r\n    ) as BufferAttribute).needsUpdate = true;\r\n  }, [data]);\r\n\r\n  return <div className=\"halpern\" ref={rendererRef} />;\r\n};\r\n\r\nexport default VisualizationHOC.wrap(Halpern);\r\n","export const starVertexShader = `\r\nattribute float alpha;\r\nvarying float vAlpha;\r\n\r\nvoid main() {\r\n  vAlpha = alpha;\r\n  vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\r\n  gl_PointSize = 4.0 * alpha;\r\n  gl_Position = projectionMatrix * mvPosition;\r\n}\r\n`;\r\n\r\nexport const starFragmentShader = `\r\nuniform vec3 color;\r\nvarying float vAlpha;\r\n\r\nvoid main() {\r\n  float r = 0.0;\r\n  vec2 cxy = 2.0 * gl_PointCoord - 1.0;\r\n  r = dot(cxy, cxy);\r\n  if (r > 1.0) {\r\n    discard;\r\n  }\r\n\r\n  gl_FragColor = vec4(color, vAlpha);\r\n}\r\n`;\r\n","import {\r\n  Points,\r\n  BufferAttribute,\r\n  ShaderMaterial,\r\n  Color,\r\n  BufferGeometry,\r\n  TextureLoader,\r\n  MeshLambertMaterial,\r\n  Mesh,\r\n  PlaneGeometry\r\n} from 'three';\r\nimport { starVertexShader, starFragmentShader } from './shaders';\r\n\r\nexport function createStars(starCount: number): Points {\r\n  const geometry = new BufferGeometry();\r\n\r\n  const positions = new Float32Array(starCount * 3);\r\n\r\n  let i = 0;\r\n  while (i < starCount) {\r\n    // add random x, y, and z vector positions\r\n    positions[i++] = Math.random() * 100 - 50;\r\n    positions[i++] = Math.random() * 100 - 50;\r\n    positions[i++] = Math.random() * 100 - 50;\r\n  }\r\n\r\n  geometry.addAttribute('position', new BufferAttribute(positions, 3));\r\n\r\n  const alphas = new Float32Array(geometry.attributes.position.count * 1);\r\n\r\n  let j = 0;\r\n  while (j < alphas.length) {\r\n    alphas[j] = Math.random();\r\n    j += 1;\r\n  }\r\n\r\n  geometry.addAttribute('alpha', new BufferAttribute(alphas, 1));\r\n\r\n  const shaderMaterial = new ShaderMaterial({\r\n    uniforms: {\r\n      color: { type: 'c', value: new Color(0xffffff) }\r\n    },\r\n    vertexShader: starVertexShader,\r\n    fragmentShader: starFragmentShader,\r\n    transparent: true\r\n  });\r\n\r\n  return new Points(geometry, shaderMaterial);\r\n}\r\n\r\nexport function createCloud(): Mesh {\r\n  const texture = Math.random() < 0.5 ? 'cloud.png' : 'smoke.png';\r\n\r\n  const geometry = new PlaneGeometry(50, 50);\r\n\r\n  const cloudMaterial = new MeshLambertMaterial({\r\n    map: new TextureLoader().load(`assets/images/${texture}`),\r\n    transparent: true,\r\n    opacity: 0.15,\r\n    depthTest: false\r\n  });\r\n\r\n  geometry.rotateZ(Math.random() * 360);\r\n\r\n  const cloud = new Mesh(geometry, cloudMaterial);\r\n\r\n  const zPosition = Math.random() * 15 + 10;\r\n\r\n  cloud.position.set(\r\n    Math.random() * 100 - 50,\r\n    Math.random() * 100 - 50,\r\n    Math.random() < 0.5 ? zPosition : -zPosition\r\n  );\r\n\r\n  return cloud;\r\n}\r\n","import { DirectionalLight, AmbientLight } from 'three';\r\n\r\nexport function createAmbientLight(color: number, intensity: number) {\r\n  return new AmbientLight(color, intensity);\r\n}\r\n\r\nexport function createDirectionalLight(color: number, intensity: number) {\r\n  return new DirectionalLight(color, intensity);\r\n}\r\n","import {\r\n  Scene,\r\n  PointsMaterial,\r\n  BufferGeometry,\r\n  BufferAttribute,\r\n  Group,\r\n  Mesh,\r\n  ShaderMaterial,\r\n  Clock\r\n} from 'three';\r\nimport { createRenderer } from './entities/renderer';\r\nimport { createCamera } from './entities/camera';\r\nimport { createStars, createCloud } from './entities/polys';\r\nimport { createAmbientLight, createDirectionalLight } from './entities/light';\r\nimport { QualitySettings } from '../../index';\r\n\r\nconst MAX_STAR_ALPHA = 1.0;\r\nconst MIN_STAR_ALPHA = 0.2;\r\nconst STAR_ALPHA_DELTA = 0.75;\r\nconst ROTATE_Y = 0.025;\r\nconst ROTATE_X = 0.001;\r\nconst STATIC_LIGHT_COLOR = 0x00c4b6;\r\nconst VARIABLE_LIGHT_COLOR = 0xd10022;\r\n\r\nconst QUALITY: QualitySettings = {\r\n  0: {\r\n    STAR_COUNT: 5 * 1000,\r\n    CLOUD_COUNT: 20\r\n  },\r\n  1: {\r\n    STAR_COUNT: 10 * 1000,\r\n    CLOUD_COUNT: 40\r\n  },\r\n  2: {\r\n    STAR_COUNT: 20 * 1000,\r\n    CLOUD_COUNT: 65\r\n  }\r\n};\r\n\r\nexport default function sceneManager(\r\n  rendererContainer: HTMLDivElement,\r\n  quality: number,\r\n  lightIntensity: number\r\n) {\r\n  let animationFrameId: number;\r\n\r\n  const renderer = createRenderer();\r\n  rendererContainer.appendChild(renderer.domElement);\r\n  const camera = createCamera();\r\n  const scene = new Scene();\r\n\r\n  const stars = createStars(QUALITY[quality].STAR_COUNT);\r\n  scene.add(stars);\r\n\r\n  const cloudCover = new Group();\r\n\r\n  let cloudCount = 0;\r\n  while (cloudCount <= QUALITY[quality].CLOUD_COUNT) {\r\n    const cloud = createCloud();\r\n    cloudCover.add(cloud);\r\n    cloudCount += 1;\r\n  }\r\n\r\n  scene.add(cloudCover);\r\n\r\n  const aLight = createAmbientLight(0xffffff, lightIntensity);\r\n  scene.add(aLight);\r\n\r\n  const fixedDLight = createDirectionalLight(STATIC_LIGHT_COLOR, 2);\r\n  fixedDLight.position.set(0, 0, 1);\r\n  scene.add(fixedDLight);\r\n\r\n  const dLight = createDirectionalLight(VARIABLE_LIGHT_COLOR, lightIntensity);\r\n  dLight.position.set(0, 0, 1);\r\n  scene.add(dLight);\r\n\r\n  // create a fixed array to track which direction to adjust each star alpha\r\n  const starAlphas = (stars.geometry as BufferGeometry).attributes.alpha;\r\n  const alphaDirection = new Float32Array(starAlphas.count);\r\n\r\n  for (let i = 0; i < alphaDirection.length; i++) {\r\n    // direction of 1 means alpha should increase\r\n    // -1 means alpha should decrease\r\n    alphaDirection[i] = Math.random() < 0.5 ? 1 : -1;\r\n  }\r\n\r\n  // clock is started in Stars component when\r\n  // the animation loop is first triggered\r\n  const clock = new Clock();\r\n\r\n  window.addEventListener('resize', onResize);\r\n  document.addEventListener('visibilitychange', onVisibilityChange);\r\n\r\n  function animate() {\r\n    const delta = clock.getDelta();\r\n\r\n    stars.rotateX(ROTATE_X * delta);\r\n    stars.rotateY(ROTATE_Y * delta);\r\n\r\n    cloudCover.rotateX(ROTATE_X * 24 * delta);\r\n    cloudCover.rotateY(ROTATE_Y * 2 * delta);\r\n    cloudCover.rotateZ(ROTATE_X * 3 * delta);\r\n\r\n    cloudCover.children.forEach(cloud => {\r\n      (cloud as Mesh).lookAt(camera.position);\r\n    });\r\n\r\n    // use alphaDirection to maintain alpha adjustment direction until we\r\n    // reach a limit, then switch the direction\r\n    for (let i = 0; i < starAlphas.count; i++) {\r\n      if (alphaDirection[i] > 0) {\r\n        (starAlphas.array as Float32Array)[i] *= 1 + STAR_ALPHA_DELTA * delta;\r\n        if ((starAlphas.array as Float32Array)[i] > MAX_STAR_ALPHA) {\r\n          alphaDirection[i] = -1;\r\n        }\r\n      } else {\r\n        (starAlphas.array as Float32Array)[i] *= 1 - STAR_ALPHA_DELTA * delta;\r\n        if ((starAlphas.array as Float32Array)[i] < MIN_STAR_ALPHA) {\r\n          alphaDirection[i] = 1;\r\n        }\r\n      }\r\n    }\r\n\r\n    (starAlphas as BufferAttribute).needsUpdate = true;\r\n\r\n    renderer.render(scene, camera);\r\n    animationFrameId = window.requestAnimationFrame(animate);\r\n  }\r\n\r\n  function cleanup() {\r\n    window.cancelAnimationFrame(animationFrameId);\r\n    window.removeEventListener('resize', onResize);\r\n    document.removeEventListener('visibilitychange', onVisibilityChange);\r\n    rendererContainer.removeChild(renderer.domElement);\r\n\r\n    scene.remove(stars);\r\n    stars.geometry.dispose();\r\n    (stars.material as PointsMaterial).dispose();\r\n\r\n    scene.remove(cloudCover);\r\n    cloudCover.children.forEach(cloud => {\r\n      (cloud as Mesh).geometry.dispose();\r\n      ((cloud as Mesh).material as ShaderMaterial).dispose();\r\n    });\r\n  }\r\n\r\n  function onResize() {\r\n    camera.aspect = window.innerWidth / window.innerHeight;\r\n    camera.updateProjectionMatrix();\r\n\r\n    renderer.setSize(window.innerWidth, window.innerHeight);\r\n    renderer.render(scene, camera);\r\n  }\r\n\r\n  function onVisibilityChange() {\r\n    if (document.visibilityState === 'hidden') {\r\n      clock.stop();\r\n    } else {\r\n      clock.start();\r\n    }\r\n  }\r\n\r\n  return {\r\n    clock,\r\n    animate,\r\n    cleanup,\r\n    dLight\r\n  };\r\n}\r\n","import { WebGLRenderer } from 'three';\r\n\r\nexport function createRenderer() {\r\n  const { innerWidth, innerHeight } = window;\r\n\r\n  const renderer = new WebGLRenderer({ antialias: true });\r\n  renderer.setPixelRatio(window.devicePixelRatio);\r\n  renderer.setSize(innerWidth, innerHeight);\r\n  renderer.setClearColor(0x0000f, 1);\r\n\r\n  return renderer;\r\n}\r\n","import { PerspectiveCamera } from 'three';\r\n\r\nexport function createCamera() {\r\n  const camera = new PerspectiveCamera(\r\n    50,\r\n    window.innerWidth / window.innerHeight,\r\n    1,\r\n    1000\r\n  );\r\n\r\n  return camera;\r\n}\r\n","import React, { useRef, useEffect } from 'react';\r\nimport * as VisualizationHOC from '../VisualizationHOC';\r\nimport sceneManager from './three/sceneManager';\r\nimport './Stars.scss';\r\n\r\nconst MIN_DELAY_BETWEEN_INTENSITY_CHANGE = 75;\r\nconst MAX_LIGHT_INTENSITY_INCREASE_DELTA = 2.5;\r\nconst MIN_LIGHT_INTENSITY = 1;\r\n\r\nconst Stars: React.FC<VisualizationHOC.WrappedProps> = ({\r\n  data,\r\n  intensity,\r\n  quality\r\n}) => {\r\n  const rendererRef = useRef<HTMLDivElement>(null);\r\n  const managedSceneRef = useRef<any>();\r\n  const lightTimestampRef = useRef<number>(Date.now());\r\n\r\n  useEffect(() => {\r\n    const rendererContainer = rendererRef.current!;\r\n    const managedScene = sceneManager(\r\n      rendererContainer,\r\n      quality,\r\n      MIN_LIGHT_INTENSITY\r\n    );\r\n\r\n    managedSceneRef.current = managedScene;\r\n\r\n    managedScene.clock.start();\r\n    managedScene.animate();\r\n\r\n    return managedScene.cleanup;\r\n  }, [quality]);\r\n\r\n  useEffect(() => {\r\n    const now = Date.now();\r\n\r\n    if (now - lightTimestampRef.current <= MIN_DELAY_BETWEEN_INTENSITY_CHANGE) {\r\n      return;\r\n    }\r\n\r\n    const { dLight } = managedSceneRef.current!;\r\n\r\n    const currentLightIntensity = dLight.intensity;\r\n\r\n    let newLightIntensity = intensity / 2 || MIN_LIGHT_INTENSITY;\r\n\r\n    if (\r\n      newLightIntensity - currentLightIntensity >\r\n      MAX_LIGHT_INTENSITY_INCREASE_DELTA\r\n    ) {\r\n      newLightIntensity =\r\n        currentLightIntensity + MAX_LIGHT_INTENSITY_INCREASE_DELTA;\r\n    }\r\n\r\n    dLight.intensity = newLightIntensity;\r\n\r\n    lightTimestampRef.current = now;\r\n  }, [data]);\r\n\r\n  return <div className=\"stars\" ref={rendererRef} />;\r\n};\r\n\r\nexport default VisualizationHOC.wrap(Stars);\r\n","const WINDOW_FRAME_THICKNESS_DIVISOR = 50;\r\n\r\nexport abstract class Renderer {\r\n  protected canvasWidth: number;\r\n  protected canvasHeight: number;\r\n  protected oneThirdCanvasWidth: number;\r\n  protected oneHalfCanvasHeight: number;\r\n  protected windowFrameThickness: number;\r\n  protected roundedRadius: number;\r\n\r\n  constructor(protected ctx: CanvasRenderingContext2D) {\r\n    this.canvasWidth = ctx.canvas.width;\r\n    this.canvasHeight = ctx.canvas.height;\r\n    this.oneThirdCanvasWidth = this.canvasWidth / 3;\r\n    this.oneHalfCanvasHeight = this.canvasHeight / 2;\r\n    this.windowFrameThickness = Math.floor(\r\n      Math.max(this.canvasWidth, this.canvasHeight) /\r\n        WINDOW_FRAME_THICKNESS_DIVISOR\r\n    );\r\n    this.roundedRadius = Math.floor(this.windowFrameThickness / 3);\r\n    ctx.save();\r\n  }\r\n\r\n  // for initial paint - subclasses should call super.render()\r\n  render(): void {\r\n    this.ctx.restore();\r\n  }\r\n\r\n  // for animation\r\n  tick(args: any): void {}\r\n}\r\n","export function modulo(number1: number, number2: number): number {\r\n  return ((number1 % number2) + number2) % number2;\r\n}\r\n\r\nexport function isMobileDevice(): boolean {\r\n  return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(\r\n    navigator.userAgent\r\n  );\r\n}\r\n\r\nfunction isInteger(number: number) {\r\n  return modulo(number, 1) === 0;\r\n}\r\n\r\nexport function randomNumberBetween(\r\n  min: number,\r\n  max: number,\r\n  decimalPrecision = 1\r\n) {\r\n  if (isInteger(min) && isInteger(max)) {\r\n    return min + Math.floor(Math.random() * (max - min));\r\n  }\r\n  const randomFloat = min + Math.random() * (max - min);\r\n  return Number(randomFloat.toPrecision(decimalPrecision));\r\n}\r\n","import { randomNumberBetween } from '../../../../../utils';\r\n\r\nconst LIGHT_COLOR = 'rgb(255, 255, 255)';\r\nconst MIN_LIGHT_HEIGHT_RATIO = 0.01;\r\nconst MAX_LIGHT_HEIGHT_RATIO = 0.025;\r\nconst MIN_LIGHTS_PER_FLOOR = 3;\r\nconst MAX_LIGHTS_PER_FLOOR = 10;\r\nconst MIN_GAP_WIDTH_RATIO = 0.01;\r\nconst MAX_GAP_WIDTH_RATIO = 0.05;\r\nconst MIN_LIGHT_PADDING_RATIO = 0.01;\r\nconst MAX_LIGHT_PADDING_RATIO = 0.03;\r\nconst MIN_BUILDING_X_PADDING_RATIO = 0.05;\r\nconst MAX_BUILDING_X_PADDING_RATIO = 0.1;\r\nconst MIN_BUILDING_TOP_PADDING_RATIO = 0.025;\r\nconst MAX_BUILDING_TOP_PADDING_RATIO = 0.1;\r\n\r\nexport type BuildingBlueprint = {\r\n  ctx: CanvasRenderingContext2D;\r\n  canvasHeight: number;\r\n  x: number;\r\n  y: number;\r\n  width: number;\r\n  height: number;\r\n  color: string;\r\n};\r\n\r\ntype Light = {\r\n  x: number;\r\n  y: number;\r\n  width: number;\r\n  height: number;\r\n  isOn: boolean;\r\n};\r\n\r\nexport class Building {\r\n  private ctx: CanvasRenderingContext2D;\r\n  private canvasHeight: number;\r\n\r\n  public x: number;\r\n  public y: number;\r\n  public width: number;\r\n  public height: number;\r\n  public color: string;\r\n  public lights: Light[] = [];\r\n\r\n  constructor(blueprint: BuildingBlueprint) {\r\n    this.ctx = blueprint.ctx;\r\n    this.canvasHeight = blueprint.canvasHeight;\r\n    this.x = blueprint.x;\r\n    this.y = blueprint.y;\r\n    this.width = blueprint.width;\r\n    this.height = blueprint.height;\r\n    this.color = blueprint.color;\r\n  }\r\n\r\n  // called externally so that buildings may be\r\n  // repositioned before light positions are determined\r\n  generateLights() {\r\n    const { canvasHeight, width, height } = this;\r\n\r\n    const lightHeight =\r\n      randomNumberBetween(MIN_LIGHT_HEIGHT_RATIO, MAX_LIGHT_HEIGHT_RATIO) *\r\n      height;\r\n\r\n    const lightPadding =\r\n      randomNumberBetween(MIN_LIGHT_PADDING_RATIO, MAX_LIGHT_PADDING_RATIO) *\r\n      height;\r\n\r\n    const lightsPerFloor = randomNumberBetween(\r\n      MIN_LIGHTS_PER_FLOOR,\r\n      MAX_LIGHTS_PER_FLOOR\r\n    );\r\n\r\n    const buildingXPadding =\r\n      randomNumberBetween(\r\n        MIN_BUILDING_X_PADDING_RATIO,\r\n        MAX_BUILDING_X_PADDING_RATIO\r\n      ) * width;\r\n\r\n    const buildingTopPadding =\r\n      randomNumberBetween(\r\n        MIN_BUILDING_TOP_PADDING_RATIO,\r\n        MAX_BUILDING_TOP_PADDING_RATIO\r\n      ) * height;\r\n\r\n    const gapWidth =\r\n      randomNumberBetween(MIN_GAP_WIDTH_RATIO, MAX_GAP_WIDTH_RATIO) * width;\r\n\r\n    const lightWidth =\r\n      (this.width - buildingXPadding * 2 - gapWidth * (lightsPerFloor - 1)) /\r\n      lightsPerFloor;\r\n\r\n    const lights: Light[] = [];\r\n    let x = this.x + buildingXPadding;\r\n    let y = this.y + buildingTopPadding;\r\n\r\n    while (y < canvasHeight * 0.98) {\r\n      // each iteration generates a row of lights for the floor\r\n      if (x >= this.x + this.width - buildingXPadding) {\r\n        // start a new floor\r\n        x = this.x + buildingXPadding;\r\n        y += lightHeight + lightPadding;\r\n      } else {\r\n        lights.push({\r\n          x,\r\n          y,\r\n          width: lightWidth,\r\n          height: lightHeight,\r\n          isOn: Math.random() > 0.4\r\n        });\r\n\r\n        x += lightWidth + gapWidth;\r\n      }\r\n    }\r\n\r\n    this.lights = lights;\r\n  }\r\n\r\n  render() {\r\n    const { ctx, x, y, width, height, color } = this;\r\n    ctx.save();\r\n\r\n    // render building\r\n    ctx.fillStyle = color;\r\n    ctx.fillRect(x, y, width, height);\r\n\r\n    // render lights\r\n    ctx.fillStyle = LIGHT_COLOR;\r\n    for (const light of this.lights) {\r\n      if (light.isOn) {\r\n        ctx.fillRect(light.x, light.y, light.width, light.height);\r\n      }\r\n    }\r\n\r\n    ctx.restore();\r\n  }\r\n}\r\n","import { Renderer } from '../renderer';\r\nimport { Building } from './building';\r\nimport { randomNumberBetween } from '../../../../../utils';\r\nimport { getRandomColor } from '../../../../../utils/colors';\r\n\r\nconst LAYER_OVERLAY_COLOR = 'rgba(65, 35, 66, 0.6)';\r\n\r\nconst MAX_BUILDING_HEIGHT_RATIO = 0.95;\r\nconst MIN_BUILDING_HEIGHT_RATIO = 0.3;\r\nconst MIN_BUILDING_WIDTH_RATIO = 0.08;\r\nconst MAX_BUILDING_WIDTH_RATIO = 0.15;\r\nconst MIN_BUILDING_GAP_RATIO = 0.02;\r\nconst MAX_BUILDING_GAP_RATIO = 0.05;\r\nconst MIN_LAYERS = 4;\r\nconst MAX_LAYERS = 8;\r\n\r\nexport class City extends Renderer {\r\n  private layers: Building[][] = [];\r\n\r\n  constructor(ctx: CanvasRenderingContext2D) {\r\n    super(ctx);\r\n    this.generateBuildings();\r\n  }\r\n\r\n  generateBuildings() {\r\n    const { ctx, canvasWidth, canvasHeight } = this;\r\n\r\n    const layers = randomNumberBetween(MIN_LAYERS, MAX_LAYERS);\r\n\r\n    for (let i = 0; i < layers; i++) {\r\n      // buildings per layer\r\n      const layer: Building[] = [];\r\n      let x = 0;\r\n\r\n      while (x < canvasWidth) {\r\n        const width =\r\n          randomNumberBetween(\r\n            MIN_BUILDING_WIDTH_RATIO,\r\n            MAX_BUILDING_WIDTH_RATIO,\r\n            2\r\n          ) * canvasWidth;\r\n\r\n        const height =\r\n          randomNumberBetween(\r\n            MIN_BUILDING_HEIGHT_RATIO,\r\n            MAX_BUILDING_HEIGHT_RATIO,\r\n            2\r\n          ) * canvasHeight;\r\n\r\n        const gap =\r\n          randomNumberBetween(MIN_BUILDING_GAP_RATIO, MAX_BUILDING_GAP_RATIO) *\r\n          canvasWidth;\r\n\r\n        const building = new Building({\r\n          y: canvasHeight - height,\r\n          color: getRandomColor(),\r\n          ctx,\r\n          canvasHeight,\r\n          x,\r\n          width,\r\n          height\r\n        });\r\n\r\n        layer.push(building);\r\n\r\n        x += width + gap;\r\n      }\r\n\r\n      // offset the buildings so the leftmost starts off screen\r\n      const leftMostBuilding = layer[0];\r\n\r\n      const xOffset = randomNumberBetween(\r\n        leftMostBuilding.width * 0.25,\r\n        leftMostBuilding.width * 0.75\r\n      );\r\n\r\n      layer.forEach(building => (building.x -= xOffset));\r\n      this.layers.push(layer);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    super.render();\r\n\r\n    const { ctx, canvasWidth, canvasHeight, layers } = this;\r\n\r\n    for (let i = 0; i < layers.length; i++) {\r\n      const currentLayer = layers[i];\r\n      currentLayer.forEach(building => building.generateLights());\r\n\r\n      for (const building of currentLayer) {\r\n        building.render();\r\n      }\r\n\r\n      // fade each layer out a bit\r\n      ctx.fillStyle = LAYER_OVERLAY_COLOR;\r\n      ctx.fillRect(0, 0, canvasWidth, canvasHeight);\r\n    }\r\n  }\r\n}\r\n","const TIME_TO_FALL = 400;\r\nconst RAINDROPS_HEIGHTWISE = 15;\r\nconst RAINDROP_COLOR = '#788';\r\n\r\nclass Raindrop {\r\n  private raindropHeight = 0;\r\n  private createdDate = 0;\r\n\r\n  constructor(\r\n    public x: number,\r\n    public y: number,\r\n    private ctx: CanvasRenderingContext2D,\r\n    private canvasHeight: number\r\n  ) {\r\n    this.raindropHeight = Math.floor(this.canvasHeight / RAINDROPS_HEIGHTWISE);\r\n    this.createdDate = Date.now();\r\n  }\r\n\r\n  tick(now: number) {\r\n    const timeDelta = now - this.createdDate;\r\n    this.y = Math.floor((timeDelta / TIME_TO_FALL) * this.canvasHeight);\r\n  }\r\n\r\n  render() {\r\n    const { ctx } = this;\r\n    ctx.fillStyle = RAINDROP_COLOR;\r\n    ctx.fillRect(this.x, this.y, 1, this.raindropHeight);\r\n  }\r\n}\r\n\r\nexport class Rainfall {\r\n  private raindrops: Raindrop[] = [];\r\n  public canvasWidth = 0;\r\n  public canvasHeight = 0;\r\n\r\n  constructor(private ctx: CanvasRenderingContext2D) {\r\n    this.canvasWidth = ctx.canvas.width;\r\n    this.canvasHeight = ctx.canvas.height;\r\n  }\r\n\r\n  tick() {\r\n    const nextRaindrops: Raindrop[] = [];\r\n    const { raindrops, canvasHeight } = this;\r\n    const now = Date.now();\r\n\r\n    raindrops.forEach(raindrop => {\r\n      raindrop.tick(now);\r\n\r\n      if (raindrop.y < canvasHeight) {\r\n        nextRaindrops.push(raindrop);\r\n      }\r\n    });\r\n\r\n    this.raindrops = nextRaindrops;\r\n  }\r\n\r\n  add() {\r\n    const { raindrops, ctx, canvasWidth, canvasHeight } = this;\r\n    const startingX = Math.floor(Math.random() * (canvasWidth - 1) + 1);\r\n    const startingY = -canvasHeight / RAINDROPS_HEIGHTWISE;\r\n\r\n    raindrops.push(new Raindrop(startingX, startingY, ctx, canvasHeight));\r\n  }\r\n\r\n  render() {\r\n    this.raindrops.forEach(raindrop => raindrop.render());\r\n  }\r\n}\r\n","import { Renderer } from '../renderer';\r\n\r\nconst WALL_START_COLOR = '#181623';\r\nconst WALL_END_COLOR = '#111019';\r\n\r\nexport class Wall extends Renderer {\r\n  constructor(ctx: CanvasRenderingContext2D) {\r\n    super(ctx);\r\n  }\r\n\r\n  render() {\r\n    super.render();\r\n\r\n    const { ctx, canvasWidth, canvasHeight } = this;\r\n\r\n    const linearGradient = this.ctx.createLinearGradient(0, 0, 0, canvasHeight);\r\n    linearGradient.addColorStop(0, WALL_START_COLOR);\r\n    linearGradient.addColorStop(1, WALL_END_COLOR);\r\n    ctx.fillStyle = linearGradient;\r\n    ctx.fillRect(0, 0, canvasWidth, canvasHeight);\r\n  }\r\n}\r\n","export type CornerRadii = {\r\n  tl: number;\r\n  tr: number;\r\n  br: number;\r\n  bl: number;\r\n};\r\n\r\nconst defaultCornerRadii = {\r\n  tl: 0,\r\n  tr: 0,\r\n  br: 0,\r\n  bl: 0\r\n};\r\n\r\nexport function roundedRect(\r\n  ctx: CanvasRenderingContext2D,\r\n  x: number,\r\n  y: number,\r\n  width: number,\r\n  height: number,\r\n  radius: CornerRadii = defaultCornerRadii,\r\n  stroke = false\r\n) {\r\n  ctx.beginPath();\r\n\r\n  ctx.moveTo(x + radius.tl, y);\r\n  ctx.lineTo(x + width - radius.tr, y);\r\n  ctx.quadraticCurveTo(x + width, y, x + width, y + radius.tr);\r\n\r\n  ctx.lineTo(x + width, y + height - radius.br);\r\n  ctx.quadraticCurveTo(\r\n    x + width,\r\n    y + height,\r\n    x + width - radius.br,\r\n    y + height\r\n  );\r\n\r\n  ctx.lineTo(x + radius.bl, y + height);\r\n  ctx.quadraticCurveTo(x, y + height, x, y + height - radius.bl);\r\n\r\n  ctx.lineTo(x, y + radius.tl);\r\n  ctx.quadraticCurveTo(x, y, x + radius.tl, y);\r\n\r\n  ctx.closePath();\r\n  ctx.fill();\r\n  stroke && ctx.stroke();\r\n}\r\n\r\nexport function distanceBetween(\r\n  point1: { x: number; y: number },\r\n  point2: { x: number; y: number }\r\n) {\r\n  return Math.sqrt(\r\n    Math.pow(point2.x - point1.x, 2) + Math.pow(point2.y - point1.y, 2)\r\n  );\r\n}\r\n\r\n// where 0 degrees corresponds to positive direction of x-axis\r\nexport function radiansBetween(\r\n  point1: { x: number; y: number },\r\n  point2: { x: number; y: number }\r\n) {\r\n  const deltaX = point2.x - point1.x;\r\n  const deltaY = point2.y - point1.y;\r\n  return Math.atan2(deltaY, deltaX);\r\n}\r\n","import { Renderer } from '../renderer';\r\nimport { roundedRect, CornerRadii } from '../utils';\r\n\r\nconst WINDOW_FRAME_COLOR = '#3D1A1E';\r\nconst WINDOW_DECORATION_COLOR = '#682634';\r\n\r\nexport class Window extends Renderer {\r\n  constructor(ctx: CanvasRenderingContext2D) {\r\n    super(ctx);\r\n  }\r\n\r\n  render() {\r\n    super.render();\r\n\r\n    const {\r\n      ctx,\r\n      oneThirdCanvasWidth,\r\n      oneHalfCanvasHeight,\r\n      windowFrameThickness\r\n    } = this;\r\n\r\n    ctx.fillStyle = WINDOW_FRAME_COLOR;\r\n\r\n    // window trim\r\n    ctx.fillRect(\r\n      oneThirdCanvasWidth - windowFrameThickness,\r\n      oneHalfCanvasHeight / 2 - windowFrameThickness,\r\n      oneThirdCanvasWidth + windowFrameThickness * 2,\r\n      oneHalfCanvasHeight + windowFrameThickness * 2\r\n    );\r\n\r\n    // make a hole\r\n    ctx.clearRect(\r\n      oneThirdCanvasWidth,\r\n      oneHalfCanvasHeight / 2,\r\n      oneThirdCanvasWidth,\r\n      oneHalfCanvasHeight\r\n    );\r\n\r\n    // window muntin\r\n    const muntinWidth = Math.floor(windowFrameThickness / 2);\r\n\r\n    const topLeftX = (oneThirdCanvasWidth * 4) / 3 - (muntinWidth * 2) / 3;\r\n    const topRightX = (oneThirdCanvasWidth * 5) / 3 - muntinWidth / 3;\r\n    const topY = oneHalfCanvasHeight / 2 - windowFrameThickness;\r\n\r\n    const leftX = oneThirdCanvasWidth - windowFrameThickness;\r\n    const leftTopY = (oneHalfCanvasHeight * 5) / 6 - (muntinWidth * 2) / 3;\r\n    const leftBottomY = (oneHalfCanvasHeight * 7) / 6 - muntinWidth / 3;\r\n\r\n    ctx.fillRect(\r\n      topLeftX,\r\n      topY,\r\n      muntinWidth,\r\n      oneHalfCanvasHeight + windowFrameThickness * 2\r\n    );\r\n\r\n    ctx.fillRect(\r\n      topRightX,\r\n      topY,\r\n      muntinWidth,\r\n      oneHalfCanvasHeight + windowFrameThickness * 2\r\n    );\r\n\r\n    ctx.fillRect(\r\n      leftX,\r\n      leftTopY,\r\n      oneThirdCanvasWidth + windowFrameThickness * 2,\r\n      muntinWidth\r\n    );\r\n\r\n    ctx.fillRect(\r\n      leftX,\r\n      leftBottomY,\r\n      oneThirdCanvasWidth + windowFrameThickness * 2,\r\n      muntinWidth\r\n    );\r\n\r\n    ctx.fillStyle = WINDOW_DECORATION_COLOR;\r\n\r\n    // window head\r\n    ctx.fillRect(\r\n      oneThirdCanvasWidth - windowFrameThickness * 2,\r\n      oneHalfCanvasHeight / 2 - windowFrameThickness * 2,\r\n      oneThirdCanvasWidth + windowFrameThickness * 4,\r\n      windowFrameThickness - 1\r\n    );\r\n\r\n    // window stool\r\n    const windowSillCornerRadii: CornerRadii = {\r\n      tl: 0,\r\n      tr: 0,\r\n      bl: this.roundedRadius,\r\n      br: this.roundedRadius\r\n    };\r\n\r\n    roundedRect(\r\n      ctx,\r\n      oneThirdCanvasWidth - windowFrameThickness * 2,\r\n      (oneHalfCanvasHeight * 3) / 2 + windowFrameThickness + 1,\r\n      oneThirdCanvasWidth + windowFrameThickness * 4,\r\n      windowFrameThickness,\r\n      windowSillCornerRadii\r\n    );\r\n\r\n    // trim decoration\r\n    ctx.lineWidth = 2;\r\n    ctx.strokeStyle = WINDOW_DECORATION_COLOR;\r\n    ctx.rect(\r\n      oneThirdCanvasWidth - (windowFrameThickness * 2) / 3,\r\n      oneHalfCanvasHeight / 2 - (windowFrameThickness * 2) / 3,\r\n      oneThirdCanvasWidth + (windowFrameThickness * 4) / 3,\r\n      oneHalfCanvasHeight + (windowFrameThickness * 4) / 3\r\n    );\r\n    ctx.stroke();\r\n\r\n    ctx.rect(\r\n      oneThirdCanvasWidth - (windowFrameThickness * 5) / 9,\r\n      oneHalfCanvasHeight / 2 - (windowFrameThickness * 5) / 9,\r\n      oneThirdCanvasWidth + (windowFrameThickness * 10) / 9,\r\n      oneHalfCanvasHeight + (windowFrameThickness * 10) / 9\r\n    );\r\n    ctx.stroke();\r\n  }\r\n}\r\n","import { Renderer } from '../renderer';\r\n\r\nconst WOOD_COLOR = '#122C2B';\r\nconst WOOD_DECORATION_COLOR = '#091c1b';\r\nconst STEREO_COLOR = '#222';\r\nconst STEREO_DETAIL_COLOR = '#444';\r\nconst STEREO_DARK_COLOR = '#111';\r\n\r\nexport class Dresser extends Renderer {\r\n  constructor(ctx: CanvasRenderingContext2D) {\r\n    super(ctx);\r\n  }\r\n\r\n  dresser() {\r\n    const { ctx, canvasWidth, canvasHeight, windowFrameThickness } = this;\r\n\r\n    const x = (canvasWidth * 2) / 3 + windowFrameThickness * 5;\r\n    const y = (canvasHeight * 2) / 3;\r\n\r\n    // dresser body\r\n    ctx.fillStyle = WOOD_COLOR;\r\n    ctx.fillRect(x, y, canvasWidth, canvasHeight);\r\n\r\n    // dresser detail rectangle\r\n    ctx.strokeStyle = WOOD_DECORATION_COLOR;\r\n    ctx.lineWidth = 3;\r\n    ctx.beginPath();\r\n    ctx.rect(\r\n      x + windowFrameThickness,\r\n      y + windowFrameThickness,\r\n      canvasWidth,\r\n      canvasHeight\r\n    );\r\n    ctx.stroke();\r\n\r\n    // dresser top handle\r\n    const dresserWidth = canvasWidth - (x + windowFrameThickness);\r\n    const dresserHandleMidpoint =\r\n      x + windowFrameThickness + (dresserWidth * 3) / 5;\r\n\r\n    ctx.beginPath();\r\n    ctx.moveTo(dresserHandleMidpoint, y + windowFrameThickness * 2.5);\r\n    ctx.lineTo(canvasWidth, y + windowFrameThickness * 2.5);\r\n    ctx.lineWidth = (windowFrameThickness * 2) / 3;\r\n    ctx.stroke();\r\n\r\n    // dresser horizontal detail line\r\n    ctx.beginPath();\r\n    ctx.moveTo(x + windowFrameThickness, y + windowFrameThickness * 6);\r\n    ctx.lineTo(canvasWidth, y + windowFrameThickness * 6);\r\n    ctx.lineWidth = 2;\r\n    ctx.stroke();\r\n\r\n    // dresser bottom handle\r\n    ctx.beginPath();\r\n    ctx.moveTo(dresserHandleMidpoint, y + windowFrameThickness * 7.5);\r\n    ctx.lineTo(canvasWidth, y + windowFrameThickness * 7.5);\r\n    ctx.lineWidth = (windowFrameThickness * 2) / 3;\r\n    ctx.stroke();\r\n  }\r\n\r\n  stereo() {\r\n    const { ctx, canvasWidth, canvasHeight, windowFrameThickness } = this;\r\n\r\n    const dresserX = (canvasWidth * 2) / 3 + windowFrameThickness * 5;\r\n    const dresserY = (canvasHeight * 2) / 3;\r\n\r\n    // speaker body\r\n    const speakerWidth = windowFrameThickness * 3.5;\r\n    const speakerHeight = canvasHeight * 0.2;\r\n    const speakerX = dresserX + windowFrameThickness * 4;\r\n    const speakerY = dresserY - speakerHeight;\r\n\r\n    ctx.fillStyle = STEREO_COLOR;\r\n    ctx.fillRect(speakerX, speakerY, speakerWidth, speakerHeight);\r\n\r\n    // mid driver\r\n    const driverRadius = Math.min(speakerWidth, speakerHeight) / 8;\r\n    const driverCenterX = speakerX + speakerWidth / 2;\r\n    const driverCenterY = speakerY + driverRadius * 2;\r\n\r\n    ctx.fillStyle = STEREO_DARK_COLOR;\r\n    ctx.beginPath();\r\n    ctx.arc(driverCenterX, driverCenterY, driverRadius, 0, Math.PI * 2);\r\n    ctx.fill();\r\n\r\n    // dividers\r\n    const dividerWidth = windowFrameThickness / 10;\r\n    ctx.fillStyle = STEREO_DARK_COLOR;\r\n\r\n    ctx.fillRect(\r\n      speakerX - dividerWidth,\r\n      speakerY,\r\n      dividerWidth,\r\n      speakerHeight\r\n    );\r\n\r\n    ctx.fillRect(\r\n      speakerX + speakerWidth,\r\n      speakerY,\r\n      dividerWidth,\r\n      speakerHeight\r\n    );\r\n\r\n    // deck\r\n    const deckX = speakerX + speakerWidth + dividerWidth;\r\n    const deckHeight = speakerHeight * 0.8;\r\n    const deckY = speakerY + speakerHeight - deckHeight;\r\n\r\n    ctx.fillStyle = STEREO_COLOR;\r\n    ctx.fillRect(deckX, deckY, canvasWidth, deckHeight);\r\n\r\n    const deckDetailX = deckX + windowFrameThickness / 2;\r\n\r\n    ctx.fillStyle = STEREO_DETAIL_COLOR;\r\n    ctx.strokeStyle = STEREO_DARK_COLOR;\r\n    ctx.lineWidth = windowFrameThickness / 8;\r\n    ctx.beginPath();\r\n    ctx.rect(\r\n      deckDetailX,\r\n      deckY + windowFrameThickness * 1.5,\r\n      canvasWidth,\r\n      deckHeight * 0.25\r\n    );\r\n    ctx.fill();\r\n    ctx.stroke();\r\n\r\n    ctx.fillStyle = STEREO_DARK_COLOR;\r\n    ctx.fillRect(\r\n      deckDetailX,\r\n      deckY + windowFrameThickness,\r\n      canvasWidth,\r\n      windowFrameThickness / 4\r\n    );\r\n\r\n    const bottomDetailY = deckY + deckHeight - windowFrameThickness * 0.8;\r\n    ctx.fillRect(\r\n      deckX + windowFrameThickness * 2,\r\n      bottomDetailY,\r\n      canvasWidth,\r\n      windowFrameThickness / 4\r\n    );\r\n\r\n    ctx.fillStyle = STEREO_DETAIL_COLOR;\r\n    const knobRadius = windowFrameThickness / 2;\r\n    const knobX = deckX + windowFrameThickness;\r\n    const knobY = bottomDetailY + windowFrameThickness / 8;\r\n    ctx.beginPath();\r\n    ctx.arc(knobX, knobY, knobRadius, 0, Math.PI * 2);\r\n    ctx.fill();\r\n    ctx.clip();\r\n    ctx.save();\r\n\r\n    ctx.translate(knobX, knobY);\r\n    const knobMarkerAngle = Math.PI * 0.75;\r\n    const knobMarkerStart = {\r\n      x: Math.sin(knobMarkerAngle) * (knobRadius - windowFrameThickness / 4),\r\n      y: Math.cos(knobMarkerAngle) * (knobRadius - windowFrameThickness / 4)\r\n    };\r\n    const knobMarkerEnd = {\r\n      x: Math.sin(knobMarkerAngle) * knobRadius * 2,\r\n      y: Math.cos(knobMarkerAngle) * knobRadius * 2\r\n    };\r\n    ctx.lineWidth = windowFrameThickness / 8;\r\n    ctx.lineCap = 'round';\r\n    ctx.beginPath();\r\n    ctx.moveTo(knobMarkerStart.x, knobMarkerStart.y);\r\n    ctx.lineTo(knobMarkerEnd.x, knobMarkerEnd.y);\r\n    ctx.stroke();\r\n    ctx.restore();\r\n\r\n    ctx.restore();\r\n  }\r\n\r\n  render() {\r\n    super.render();\r\n\r\n    this.dresser();\r\n    this.stereo();\r\n    this.tick();\r\n  }\r\n\r\n  tick(isBeat = false) {\r\n    const { ctx, canvasWidth, canvasHeight, windowFrameThickness } = this;\r\n\r\n    const dresserX = (canvasWidth * 2) / 3 + windowFrameThickness * 5;\r\n    const dresserY = (canvasHeight * 2) / 3;\r\n\r\n    // speaker body\r\n    const speakerWidth = windowFrameThickness * 3.5;\r\n    const speakerHeight = canvasHeight * 0.2;\r\n    const speakerX = dresserX + windowFrameThickness * 4;\r\n    const speakerY = dresserY - speakerHeight;\r\n\r\n    // mid driver\r\n    const driverRadius = Math.min(speakerWidth, speakerHeight) / 8;\r\n    const driverCenterX = speakerX + speakerWidth / 2;\r\n\r\n    // speaker woofer\r\n    const wooferRadius = Math.min(speakerWidth, speakerHeight) / 2.5;\r\n    const wooferCenterY = Math.max(\r\n      speakerY + wooferRadius + driverRadius * 4,\r\n      speakerY + speakerHeight - (wooferRadius + driverRadius * 2)\r\n    );\r\n\r\n    ctx.strokeStyle = STEREO_DETAIL_COLOR;\r\n    ctx.fillStyle = STEREO_COLOR;\r\n    ctx.lineWidth = windowFrameThickness / 8;\r\n    ctx.beginPath();\r\n    ctx.arc(driverCenterX, wooferCenterY, wooferRadius, 0, Math.PI * 2);\r\n    ctx.fill();\r\n    ctx.stroke();\r\n\r\n    ctx.fillStyle = STEREO_DARK_COLOR;\r\n    ctx.beginPath();\r\n    ctx.arc(\r\n      driverCenterX,\r\n      wooferCenterY,\r\n      isBeat ? wooferRadius * 0.63 : wooferRadius * 0.6,\r\n      0,\r\n      Math.PI * 2\r\n    );\r\n    ctx.fill();\r\n  }\r\n}\r\n","import { Renderer } from '../renderer';\r\nimport { distanceBetween } from '../utils';\r\n\r\nconst WOOD_COLOR = '#122C2B';\r\n\r\ntype Picture = {\r\n  x: number;\r\n  y: number;\r\n  width: number;\r\n  height: number;\r\n};\r\n\r\nexport class Pictures extends Renderer {\r\n  pictures: Picture[] = [];\r\n\r\n  constructor(ctx: CanvasRenderingContext2D) {\r\n    super(ctx);\r\n\r\n    const { oneThirdCanvasWidth, windowFrameThickness } = this;\r\n\r\n    // X & Y coords and dimensions for each picture\r\n    this.pictures.push({\r\n      x: (oneThirdCanvasWidth * 3) / 4 - windowFrameThickness * 4,\r\n      y: -windowFrameThickness,\r\n      width: windowFrameThickness * 4,\r\n      height: windowFrameThickness * 5\r\n    });\r\n\r\n    this.pictures.push({\r\n      x: this.pictures[0].x - windowFrameThickness * 7,\r\n      y: windowFrameThickness * 2,\r\n      width: windowFrameThickness * 5,\r\n      height: windowFrameThickness * 4\r\n    });\r\n\r\n    this.pictures.push({\r\n      x: this.pictures[1].x + windowFrameThickness * 2,\r\n      y:\r\n        this.pictures[1].y +\r\n        this.pictures[1].height +\r\n        windowFrameThickness * 1.5,\r\n      width: windowFrameThickness * 6,\r\n      height: windowFrameThickness * 8\r\n    });\r\n  }\r\n\r\n  graph() {\r\n    const { ctx, windowFrameThickness } = this;\r\n    const { x, y, width, height } = this.pictures[0];\r\n\r\n    ctx.save();\r\n    ctx.beginPath();\r\n    ctx.rect(x, y, width, height);\r\n    ctx.clip();\r\n\r\n    const gradient1 = ctx.createLinearGradient(x, y, x, y + height);\r\n    gradient1.addColorStop(0, '#24131f');\r\n    gradient1.addColorStop(1, '#051b1f');\r\n    ctx.fillStyle = gradient1;\r\n    ctx.fill();\r\n\r\n    const nodes: Array<{ x: number; y: number }> = [];\r\n    const nodeSize = windowFrameThickness / 6;\r\n\r\n    for (let i = 0; i < 20; i++) {\r\n      nodes.push({\r\n        x: Math.floor(Math.random() * width + x),\r\n        y: Math.floor(Math.random() * height + y)\r\n      });\r\n    }\r\n\r\n    const nodeColor = '#703c3a';\r\n    ctx.fillStyle = nodeColor;\r\n    ctx.strokeStyle = nodeColor;\r\n    ctx.lineWidth = 1;\r\n\r\n    while (nodes.length) {\r\n      const currentNode = nodes.pop()!;\r\n      ctx.beginPath();\r\n      ctx.arc(currentNode.x, currentNode.y, nodeSize / 2, 0, Math.PI * 2);\r\n      ctx.fill();\r\n\r\n      for (const otherNode of nodes) {\r\n        if (distanceBetween(currentNode, otherNode) < height / 4) {\r\n          ctx.beginPath();\r\n          ctx.moveTo(currentNode.x, currentNode.y);\r\n          ctx.lineTo(otherNode.x, otherNode.y);\r\n          ctx.stroke();\r\n        }\r\n      }\r\n    }\r\n\r\n    ctx.strokeStyle = WOOD_COLOR;\r\n    ctx.lineWidth = windowFrameThickness / 1.5;\r\n    ctx.beginPath();\r\n    ctx.rect(x, y, width, height);\r\n    ctx.stroke();\r\n\r\n    ctx.restore();\r\n  }\r\n\r\n  orbits() {\r\n    const { ctx, windowFrameThickness } = this;\r\n    const { x, y, width, height } = this.pictures[1];\r\n\r\n    ctx.save();\r\n\r\n    ctx.beginPath();\r\n    ctx.rect(x, y, width, height);\r\n    ctx.clip();\r\n\r\n    const gradient2 = ctx.createLinearGradient(x, y, x, y + height);\r\n    gradient2.addColorStop(0, '#556e53');\r\n    gradient2.addColorStop(1, '#29435c');\r\n    ctx.fillStyle = gradient2;\r\n    ctx.fill();\r\n\r\n    // sun\r\n    const color = '#879591';\r\n    ctx.fillStyle = color;\r\n    ctx.strokeStyle = color;\r\n    ctx.beginPath();\r\n    ctx.arc(x + width / 2, y + height / 2, height / 14, 0, Math.PI * 2);\r\n    ctx.fill();\r\n\r\n    // orbits\r\n    for (\r\n      let radius = Math.floor(height / 6);\r\n      radius <= height / 2;\r\n      radius += windowFrameThickness / 4\r\n    ) {\r\n      ctx.beginPath();\r\n      ctx.arc(x + width / 2, y + height / 2, radius, 0, Math.PI * 2);\r\n      ctx.stroke();\r\n\r\n      const randomAngle = Math.random() * Math.PI * 2;\r\n      const planetX = x + width / 2 + Math.cos(randomAngle) * radius;\r\n      const planetY = y + height / 2 + Math.sin(randomAngle) * radius;\r\n      const randomRadius = Math.random() * (width / 64) + width / 192;\r\n      ctx.beginPath();\r\n      ctx.arc(planetX, planetY, randomRadius, 0, Math.PI * 2);\r\n      ctx.fill();\r\n    }\r\n\r\n    ctx.strokeStyle = '#152a38';\r\n    ctx.lineWidth = windowFrameThickness / 1.2;\r\n    ctx.beginPath();\r\n    ctx.rect(x, y, width, height);\r\n    ctx.stroke();\r\n\r\n    ctx.restore();\r\n  }\r\n\r\n  stars() {\r\n    const { ctx, windowFrameThickness } = this;\r\n    const { x, y, width, height } = this.pictures[2];\r\n\r\n    ctx.save();\r\n\r\n    // background\r\n    ctx.beginPath();\r\n    ctx.rect(x, y, width, height);\r\n    ctx.clip();\r\n\r\n    const gradient3 = ctx.createLinearGradient(x, y, x, y + height);\r\n    gradient3.addColorStop(0, '#09325E');\r\n    gradient3.addColorStop(0.75, '#2A2A47');\r\n    ctx.fillStyle = gradient3;\r\n    ctx.fill();\r\n\r\n    // sky\r\n    ctx.fillStyle = '#F5E7F8';\r\n    const starCount = 60;\r\n\r\n    for (let i = 0; i < starCount; i++) {\r\n      const starX = Math.floor(Math.random() * width + x);\r\n      const starY = Math.floor(Math.random() * height + y);\r\n      const radius = Math.floor(Math.random() * 2 + 1);\r\n      ctx.beginPath();\r\n      ctx.arc(starX, starY, radius, 0, Math.PI * 2);\r\n      ctx.fill();\r\n    }\r\n\r\n    ctx.strokeStyle = '#0D0B21';\r\n    ctx.lineWidth = windowFrameThickness / 1.5;\r\n    ctx.beginPath();\r\n    ctx.rect(x, y, width, height);\r\n    ctx.stroke();\r\n\r\n    ctx.restore();\r\n  }\r\n\r\n  render() {\r\n    super.render();\r\n\r\n    this.graph();\r\n    this.orbits();\r\n    this.stars();\r\n  }\r\n}\r\n","import { Renderer } from '../renderer';\r\nimport { roundedRect, CornerRadii } from '../utils';\r\n\r\nconst WOOD_COLOR = '#122C2B';\r\nconst TABLE_DECORATION_COLOR = '#06151A';\r\nconst BOWL_COLOR = '#3e3e3e';\r\nconst BOWL_BASE_COLOR = '#1e1e1e';\r\nconst FRUIT_COLORS = ['#564837', '#713C3A'];\r\nconst FRUIT_STEM_COLOR = '#04070F';\r\n\r\nexport class Table extends Renderer {\r\n  y: number;\r\n\r\n  constructor(ctx: CanvasRenderingContext2D) {\r\n    super(ctx);\r\n\r\n    this.y = this.canvasHeight * 0.7;\r\n  }\r\n\r\n  top() {\r\n    const {\r\n      ctx,\r\n      y,\r\n      windowFrameThickness,\r\n      oneThirdCanvasWidth,\r\n      roundedRadius\r\n    } = this;\r\n\r\n    const width = oneThirdCanvasWidth * 0.7;\r\n    const thickness = windowFrameThickness * 1.35;\r\n\r\n    const tableCornerRadii: CornerRadii = {\r\n      tl: 0,\r\n      tr: roundedRadius,\r\n      br: 0,\r\n      bl: 0\r\n    };\r\n\r\n    ctx.fillStyle = WOOD_COLOR;\r\n    roundedRect(ctx, 0, y, width, thickness, tableCornerRadii);\r\n\r\n    ctx.fillStyle = TABLE_DECORATION_COLOR;\r\n    ctx.beginPath();\r\n    ctx.rect(\r\n      0,\r\n      y + thickness - windowFrameThickness / 4,\r\n      width,\r\n      windowFrameThickness / 4\r\n    );\r\n    ctx.fill();\r\n  }\r\n\r\n  leg() {\r\n    const {\r\n      ctx,\r\n      y,\r\n      windowFrameThickness,\r\n      canvasHeight,\r\n      oneThirdCanvasWidth\r\n    } = this;\r\n\r\n    ctx.strokeStyle = WOOD_COLOR;\r\n    ctx.lineWidth = windowFrameThickness * 1.5;\r\n    ctx.beginPath();\r\n    ctx.moveTo(oneThirdCanvasWidth * 0.5, y);\r\n    ctx.lineTo(oneThirdCanvasWidth * 0.5, canvasHeight);\r\n    ctx.stroke();\r\n  }\r\n\r\n  centerpiece() {\r\n    const {\r\n      ctx,\r\n      y,\r\n      windowFrameThickness,\r\n      canvasWidth,\r\n      oneThirdCanvasWidth\r\n    } = this;\r\n\r\n    const bowlCenterX = oneThirdCanvasWidth * 0.25;\r\n    const bowlWidth = oneThirdCanvasWidth * 0.3;\r\n    const bowlHeight = windowFrameThickness * 2;\r\n\r\n    // fruit\r\n    const fruits = [\r\n      {\r\n        xOffset: (bowlWidth - bowlWidth * 0.4) / 4,\r\n        y: y - bowlHeight,\r\n        radius: bowlWidth * 0.2,\r\n        color: FRUIT_COLORS[0],\r\n        stemAngle: Math.PI * 0.9\r\n      },\r\n      {\r\n        xOffset: -(bowlWidth - bowlWidth * 0.4) / 4,\r\n        y: y - bowlHeight + bowlHeight / 8,\r\n        radius: bowlWidth * 0.2,\r\n        color: FRUIT_COLORS[1],\r\n        stemAngle: Math.PI * 1.1\r\n      }\r\n    ];\r\n\r\n    for (const fruit of fruits) {\r\n      ctx.fillStyle = fruit.color;\r\n      ctx.beginPath();\r\n      ctx.arc(\r\n        bowlCenterX + fruit.xOffset,\r\n        fruit.y,\r\n        fruit.radius,\r\n        0,\r\n        Math.PI * 2\r\n      );\r\n      ctx.fill();\r\n    }\r\n\r\n    ctx.strokeStyle = FRUIT_STEM_COLOR;\r\n    ctx.lineCap = 'round';\r\n    ctx.lineWidth = 2;\r\n\r\n    for (const fruit of fruits) {\r\n      ctx.save();\r\n      ctx.translate(bowlCenterX + fruit.xOffset, fruit.y);\r\n      const stemStart = {\r\n        x: Math.sin(fruit.stemAngle) * fruits[1].radius * 0.9,\r\n        y: Math.cos(fruit.stemAngle) * fruits[1].radius * 0.9\r\n      };\r\n      const stemEnd = {\r\n        x: Math.sin(fruit.stemAngle) * fruits[1].radius * 1.1,\r\n        y: Math.cos(fruit.stemAngle) * fruits[1].radius * 1.1\r\n      };\r\n      ctx.beginPath();\r\n      ctx.moveTo(stemStart.x, stemStart.y);\r\n      ctx.lineTo(stemEnd.x, stemEnd.y);\r\n      ctx.stroke();\r\n      ctx.restore();\r\n    }\r\n\r\n    // bowl\r\n    const bowlCornerRadii: CornerRadii = {\r\n      tl: 0,\r\n      tr: 0,\r\n      br: oneThirdCanvasWidth * 0.1,\r\n      bl: oneThirdCanvasWidth * 0.1\r\n    };\r\n\r\n    const bowlBaseHeight = bowlHeight / 8;\r\n    const bowlBaseWidth = bowlWidth * 0.5;\r\n\r\n    ctx.fillStyle = BOWL_BASE_COLOR;\r\n    ctx.fillRect(\r\n      bowlCenterX - bowlBaseWidth / 2,\r\n      y - bowlHeight - bowlBaseHeight,\r\n      bowlBaseWidth,\r\n      bowlHeight + bowlBaseHeight\r\n    );\r\n\r\n    ctx.fillStyle = BOWL_COLOR;\r\n    roundedRect(\r\n      ctx,\r\n      bowlCenterX - bowlWidth / 2,\r\n      y - bowlHeight - bowlBaseHeight,\r\n      bowlWidth,\r\n      bowlHeight,\r\n      bowlCornerRadii\r\n    );\r\n\r\n    ctx.save();\r\n    ctx.clip();\r\n    ctx.lineWidth = 2;\r\n    ctx.strokeStyle = TABLE_DECORATION_COLOR;\r\n    const bowlDecorationY = y - bowlHeight - bowlBaseHeight + bowlHeight / 6;\r\n    ctx.beginPath();\r\n    ctx.moveTo(0, bowlDecorationY);\r\n    ctx.lineTo(canvasWidth, bowlDecorationY);\r\n    ctx.stroke();\r\n    ctx.restore();\r\n  }\r\n\r\n  render() {\r\n    super.render();\r\n\r\n    this.leg();\r\n    this.top();\r\n    this.centerpiece();\r\n  }\r\n}\r\n","import { Renderer } from '../renderer';\r\n\r\nconst WOOD_COLOR = '#122C2B';\r\nconst CLOCK_INNER_COLOR = '#4B4721';\r\nconst CLOCK_HANDS_COLOR = '#192124';\r\nconst CLOCK_DECORATION_COLOR = '#06151A';\r\n\r\nexport class Clock extends Renderer {\r\n  private clockSize: number;\r\n  private clockCoords: { x: number; y: number };\r\n\r\n  constructor(ctx: CanvasRenderingContext2D) {\r\n    super(ctx);\r\n    this.clockSize = this.windowFrameThickness * 5;\r\n    const x = Math.max(\r\n      this.canvasWidth * 0.7,\r\n      (this.canvasWidth * 2) / 3 + this.windowFrameThickness * 8\r\n    );\r\n    const y = this.canvasHeight / 5;\r\n    this.clockCoords = { x, y };\r\n  }\r\n\r\n  face() {\r\n    const { ctx, clockSize, clockCoords } = this;\r\n    const { x, y } = clockCoords;\r\n\r\n    ctx.strokeStyle = WOOD_COLOR;\r\n\r\n    // clock frame\r\n    ctx.lineWidth = this.windowFrameThickness / 2;\r\n    ctx.beginPath();\r\n    ctx.arc(x, y, clockSize / 1.75, 0, Math.PI * 2, true);\r\n    ctx.stroke();\r\n\r\n    ctx.strokeStyle = CLOCK_DECORATION_COLOR;\r\n    ctx.beginPath();\r\n    ctx.arc(x, y, clockSize / 2, 0, Math.PI * 2, true);\r\n    ctx.stroke();\r\n\r\n    ctx.beginPath();\r\n    ctx.arc(x, y, clockSize / 2, 0, Math.PI * 2, true);\r\n    ctx.fillStyle = CLOCK_INNER_COLOR;\r\n    ctx.fill();\r\n\r\n    // markings\r\n    ctx.lineWidth = 2;\r\n    ctx.strokeStyle = CLOCK_HANDS_COLOR;\r\n\r\n    ctx.save();\r\n    ctx.translate(x, y);\r\n\r\n    for (let i = 1; i <= 60; i++) {\r\n      const angle = (i * Math.PI) / 30;\r\n\r\n      const start = {\r\n        x: Math.sin(angle) * (clockSize / 2 - clockSize / 20),\r\n        y: Math.cos(angle) * (clockSize / 2 - clockSize / 20)\r\n      };\r\n      const end = {\r\n        x: Math.sin(angle) * (clockSize / 2 - clockSize / 15),\r\n        y: Math.cos(angle) * (clockSize / 2 - clockSize / 15)\r\n      };\r\n\r\n      ctx.beginPath();\r\n      ctx.moveTo(start.x, start.y);\r\n      ctx.lineTo(end.x, end.y);\r\n      ctx.stroke();\r\n    }\r\n\r\n    ctx.restore();\r\n  }\r\n\r\n  hands() {\r\n    const { ctx, clockSize, clockCoords } = this;\r\n    const { x, y } = clockCoords;\r\n\r\n    // fill in hands area so we can redraw them\r\n    ctx.beginPath();\r\n    ctx.arc(x, y, clockSize / 2 - clockSize / 15, 0, Math.PI * 2, true);\r\n    ctx.fillStyle = CLOCK_INNER_COLOR;\r\n    ctx.fill();\r\n\r\n    ctx.lineWidth = clockSize / 40;\r\n    ctx.lineCap = 'round';\r\n    ctx.strokeStyle = CLOCK_HANDS_COLOR;\r\n\r\n    ctx.save();\r\n    ctx.translate(x, y);\r\n\r\n    const now = new Date();\r\n    const hours = now.getHours();\r\n    const minutes = now.getMinutes();\r\n    const seconds = now.getSeconds();\r\n\r\n    // hour hand\r\n    ctx.save();\r\n    ctx.rotate((Math.PI / 6) * (hours + minutes / 60 + seconds / 3600));\r\n    ctx.beginPath();\r\n    ctx.moveTo(0, 10);\r\n    ctx.lineTo(0, -clockSize / 4);\r\n    ctx.stroke();\r\n    ctx.restore();\r\n\r\n    // minute hand\r\n    ctx.save();\r\n    ctx.rotate((Math.PI / 30) * (minutes + seconds / 60));\r\n    ctx.beginPath();\r\n    ctx.moveTo(0, 10);\r\n    ctx.lineTo(0, -clockSize / 2.75);\r\n    ctx.stroke();\r\n    ctx.restore();\r\n\r\n    // second hand\r\n    ctx.lineWidth = clockSize / 100;\r\n    ctx.save();\r\n    ctx.rotate((Math.PI / 30) * seconds);\r\n    ctx.beginPath();\r\n    ctx.moveTo(0, 10);\r\n    ctx.lineTo(0, -clockSize / 2.7);\r\n    ctx.stroke();\r\n    ctx.restore();\r\n\r\n    ctx.restore();\r\n  }\r\n\r\n  render() {\r\n    super.render();\r\n    this.face();\r\n    this.hands();\r\n  }\r\n\r\n  tick() {\r\n    this.hands();\r\n  }\r\n}\r\n","import { Renderer } from '../renderer';\r\n\r\nconst CAT_COLOR = '#000';\r\n\r\nexport class Cat extends Renderer {\r\n  private isWagging = false;\r\n  private prevTailAngle = -Math.PI / 2;\r\n  private headRadius: number;\r\n  private bodyHeight: number;\r\n  private bodyWidth: number;\r\n  private x: number;\r\n  private createdTimestamp: number;\r\n  private tailWidth: number;\r\n  private tailY: number;\r\n\r\n  constructor(ctx: CanvasRenderingContext2D) {\r\n    super(ctx);\r\n\r\n    const {\r\n      windowFrameThickness,\r\n      oneThirdCanvasWidth,\r\n      oneHalfCanvasHeight\r\n    } = this;\r\n\r\n    this.x = oneThirdCanvasWidth * 2 - windowFrameThickness * 1.2;\r\n    this.headRadius = windowFrameThickness;\r\n    this.bodyHeight = windowFrameThickness * 3;\r\n    this.bodyWidth = windowFrameThickness * 2.2;\r\n    this.createdTimestamp = Date.now();\r\n    this.tailWidth = windowFrameThickness / 2;\r\n    this.tailY =\r\n      (oneHalfCanvasHeight * 3) / 2 + windowFrameThickness - this.tailWidth / 2;\r\n  }\r\n\r\n  head() {\r\n    const { ctx, oneHalfCanvasHeight, x, headRadius } = this;\r\n    const y = (oneHalfCanvasHeight * 3) / 2 - this.bodyHeight - this.headRadius;\r\n\r\n    ctx.fillStyle = CAT_COLOR;\r\n    ctx.strokeStyle = CAT_COLOR;\r\n    ctx.beginPath();\r\n    ctx.arc(x, y, headRadius, 0, Math.PI * 2);\r\n    ctx.fill();\r\n\r\n    // ears\r\n    ctx.save();\r\n    ctx.translate(x, y);\r\n\r\n    ctx.lineWidth = 5;\r\n    ctx.lineJoin = 'round';\r\n\r\n    const rightEar = {\r\n      start: {\r\n        x: Math.sin(Math.PI * 0.85) * headRadius,\r\n        y: Math.cos(Math.PI * 0.85) * headRadius\r\n      },\r\n      point: {\r\n        x: Math.sin(Math.PI * 0.8) * headRadius * 1.4,\r\n        y: Math.cos(Math.PI * 0.8) * headRadius * 1.4\r\n      },\r\n      end: {\r\n        x: Math.sin(Math.PI * 0.7) * headRadius,\r\n        y: Math.cos(Math.PI * 0.7) * headRadius\r\n      }\r\n    };\r\n\r\n    ctx.beginPath();\r\n    ctx.moveTo(rightEar.start.x, rightEar.start.y);\r\n    ctx.lineTo(rightEar.point.x, rightEar.point.y);\r\n    ctx.lineTo(rightEar.end.x, rightEar.end.y);\r\n    ctx.closePath();\r\n    ctx.fill();\r\n    ctx.stroke();\r\n\r\n    const leftEar = {\r\n      start: {\r\n        x: Math.sin(Math.PI * 1.2) * headRadius,\r\n        y: Math.cos(Math.PI * 1.2) * headRadius\r\n      },\r\n      point: {\r\n        x: Math.sin(Math.PI * 1.22) * headRadius * 1.5,\r\n        y: Math.cos(Math.PI * 1.22) * headRadius * 1.5\r\n      },\r\n      end: {\r\n        x: Math.sin(Math.PI * 1.3) * headRadius,\r\n        y: Math.cos(Math.PI * 1.3) * headRadius\r\n      }\r\n    };\r\n\r\n    ctx.beginPath();\r\n    ctx.moveTo(leftEar.start.x, leftEar.start.y);\r\n    ctx.lineTo(leftEar.point.x, leftEar.point.y);\r\n    ctx.lineTo(leftEar.end.x, leftEar.end.y);\r\n    ctx.closePath();\r\n    ctx.fill();\r\n    ctx.stroke();\r\n\r\n    ctx.restore();\r\n  }\r\n\r\n  body() {\r\n    const {\r\n      ctx,\r\n      oneHalfCanvasHeight,\r\n      windowFrameThickness,\r\n      x,\r\n      headRadius,\r\n      bodyWidth,\r\n      bodyHeight\r\n    } = this;\r\n    const y = (oneHalfCanvasHeight * 3) / 2 - bodyHeight;\r\n\r\n    ctx.beginPath();\r\n    ctx.moveTo(x, y - headRadius / 2);\r\n    ctx.quadraticCurveTo(\r\n      x - bodyWidth * 0.75,\r\n      y + bodyHeight / 4,\r\n      x - bodyWidth / 3,\r\n      y + bodyHeight + windowFrameThickness\r\n    );\r\n    ctx.lineTo(x + bodyWidth / 2, y + bodyHeight + windowFrameThickness);\r\n    ctx.quadraticCurveTo(\r\n      x + bodyWidth * 1.2,\r\n      y + bodyHeight + windowFrameThickness,\r\n      x + bodyWidth / 3,\r\n      y - headRadius / 3\r\n    );\r\n    ctx.closePath();\r\n    ctx.fill();\r\n\r\n    // left leg\r\n    ctx.beginPath();\r\n    ctx.moveTo(x - bodyWidth / 4, y + bodyHeight * 0.3);\r\n    ctx.quadraticCurveTo(\r\n      x - bodyWidth,\r\n      y + bodyHeight,\r\n      x - bodyWidth / 3,\r\n      y + bodyHeight + windowFrameThickness\r\n    );\r\n    ctx.lineTo(x + bodyWidth / 2, y + bodyHeight + windowFrameThickness);\r\n    ctx.closePath();\r\n    ctx.fill();\r\n  }\r\n\r\n  tail() {\r\n    const { ctx, tailWidth, x, bodyWidth, tailY } = this;\r\n\r\n    ctx.lineWidth = tailWidth;\r\n    ctx.lineCap = 'round';\r\n    ctx.beginPath();\r\n    ctx.moveTo(x, tailY);\r\n    ctx.lineTo(x - bodyWidth, tailY);\r\n    ctx.stroke();\r\n  }\r\n\r\n  render() {\r\n    super.render();\r\n\r\n    const { ctx, canvasWidth, canvasHeight } = this;\r\n    ctx.clearRect(0, 0, canvasWidth, canvasHeight);\r\n\r\n    this.head();\r\n    this.body();\r\n    this.tail();\r\n  }\r\n\r\n  tick() {\r\n    const {\r\n      ctx,\r\n      canvasWidth,\r\n      canvasHeight,\r\n      createdTimestamp,\r\n      x,\r\n      bodyWidth,\r\n      tailY\r\n    } = this;\r\n    ctx.clearRect(0, 0, canvasWidth, canvasHeight);\r\n\r\n    this.head();\r\n    this.body();\r\n\r\n    // tail wag\r\n    const timeDelta = Date.now() - createdTimestamp;\r\n\r\n    // oscillate between angles\r\n    let nextTailAngle =\r\n      -Math.PI / 2 + (Math.sin(timeDelta / 200) * -Math.PI) / 20;\r\n\r\n    if (this.prevTailAngle > -Math.PI / 2 && nextTailAngle < -Math.PI / 2) {\r\n      // each oscillation has a chance of producing a tail wag\r\n      this.isWagging = Math.random() < 0.1;\r\n    }\r\n\r\n    this.prevTailAngle = nextTailAngle;\r\n\r\n    if (nextTailAngle > -Math.PI / 2) {\r\n      nextTailAngle = -Math.PI / 2;\r\n    }\r\n\r\n    if (!this.isWagging) {\r\n      this.tail();\r\n      return;\r\n    }\r\n\r\n    ctx.save();\r\n    ctx.translate(x, tailY);\r\n\r\n    const tailEnd = {\r\n      x: Math.sin(nextTailAngle) * bodyWidth,\r\n      y: Math.cos(nextTailAngle) * bodyWidth\r\n    };\r\n\r\n    ctx.beginPath();\r\n    ctx.moveTo(0, 0);\r\n    ctx.quadraticCurveTo(\r\n      -bodyWidth,\r\n      (-Math.cos(nextTailAngle) * bodyWidth) / 10,\r\n      tailEnd.x,\r\n      tailEnd.y\r\n    );\r\n    ctx.stroke();\r\n\r\n    ctx.restore();\r\n  }\r\n}\r\n","import { Renderer } from '../renderer';\r\nimport { radiansBetween } from '../utils';\r\n\r\nconst STEM_COLOR = '#8e8e8e';\r\nconst LIGHT_COLOR = 'rgba(252, 243, 126, 0.085)';\r\n\r\ntype ShadeCoords = { x: number; y: number };\r\n\r\nexport class Lamp extends Renderer {\r\n  private stemX: number;\r\n  private stemHeight: number;\r\n  private lampWidth: number;\r\n  private shadeTopLeft: ShadeCoords;\r\n  private shadeTopRight: ShadeCoords;\r\n  private shadeBottomRight: ShadeCoords;\r\n  private shadeBottomLeft: ShadeCoords;\r\n\r\n  constructor(ctx: CanvasRenderingContext2D) {\r\n    super(ctx);\r\n\r\n    const { canvasWidth, canvasHeight, windowFrameThickness } = this;\r\n\r\n    this.stemX = (canvasWidth * 7) / 11;\r\n    this.stemHeight = canvasHeight / 5;\r\n    this.lampWidth = windowFrameThickness * 3.5;\r\n\r\n    this.shadeTopLeft = {\r\n      x: this.stemX - windowFrameThickness / 5,\r\n      y: this.stemHeight + windowFrameThickness\r\n    };\r\n    this.shadeTopRight = {\r\n      x: this.stemX + windowFrameThickness / 5,\r\n      y: this.stemHeight + windowFrameThickness\r\n    };\r\n    this.shadeBottomRight = {\r\n      x: this.stemX + this.lampWidth / 2,\r\n      y: this.stemHeight + windowFrameThickness * 3\r\n    };\r\n    this.shadeBottomLeft = {\r\n      x: this.stemX - this.lampWidth / 2,\r\n      y: this.stemHeight + windowFrameThickness * 3\r\n    };\r\n  }\r\n\r\n  stem() {\r\n    const { ctx, windowFrameThickness, stemX, stemHeight } = this;\r\n\r\n    ctx.strokeStyle = STEM_COLOR;\r\n    ctx.fillStyle = STEM_COLOR;\r\n    ctx.lineWidth = windowFrameThickness / 5;\r\n\r\n    ctx.beginPath();\r\n    ctx.moveTo(stemX, 0);\r\n    ctx.lineTo(stemX, stemHeight);\r\n    ctx.stroke();\r\n\r\n    ctx.lineWidth = 1;\r\n    ctx.fillRect(\r\n      stemX - windowFrameThickness / 5,\r\n      stemHeight - 1,\r\n      (windowFrameThickness * 2) / 5,\r\n      windowFrameThickness\r\n    );\r\n    ctx.stroke();\r\n  }\r\n\r\n  lampshade() {\r\n    const {\r\n      ctx,\r\n      shadeTopLeft,\r\n      shadeTopRight,\r\n      shadeBottomRight,\r\n      shadeBottomLeft\r\n    } = this;\r\n\r\n    ctx.beginPath();\r\n    ctx.moveTo(shadeTopLeft.x, shadeTopLeft.y);\r\n    ctx.lineTo(shadeTopRight.x, shadeTopRight.y);\r\n    ctx.lineTo(shadeBottomRight.x, shadeBottomRight.y);\r\n    ctx.lineTo(shadeBottomLeft.x, shadeBottomLeft.y);\r\n    ctx.closePath();\r\n    ctx.fill();\r\n    ctx.stroke();\r\n  }\r\n\r\n  light() {\r\n    const {\r\n      ctx,\r\n      canvasHeight,\r\n      windowFrameThickness,\r\n      stemX,\r\n      stemHeight,\r\n      lampWidth,\r\n      shadeTopLeft,\r\n      shadeBottomRight,\r\n      shadeBottomLeft\r\n    } = this;\r\n\r\n    // thin line of bright light color at bottom\r\n    ctx.fillStyle = '#ff7';\r\n    ctx.fillRect(\r\n      shadeBottomLeft.x,\r\n      shadeBottomLeft.y,\r\n      shadeBottomRight.x - shadeBottomLeft.x,\r\n      2\r\n    );\r\n\r\n    ctx.fillStyle = LIGHT_COLOR;\r\n    const lightHeight = canvasHeight - shadeBottomLeft.y;\r\n    // compensate for inverted canvas y-coords when\r\n    // getting angle between lampshade corners\r\n    const lightAngle = radiansBetween(shadeBottomLeft, {\r\n      x: shadeTopLeft.x,\r\n      y: shadeBottomLeft.y + shadeBottomLeft.y - shadeTopLeft.y\r\n    });\r\n\r\n    // light makes a right triangle with bottom of canvas so\r\n    // we can calculate its adjacent width using height and\r\n    // the angle of the lampshade\r\n    // tan θ = opposite (height) / adjacent (width)\r\n    const lightTriangleAdjacentWidth = lightHeight / Math.tan(lightAngle);\r\n\r\n    const lightBottomLeftX = shadeBottomLeft.x - lightTriangleAdjacentWidth;\r\n    const lightBottomRightX = shadeBottomRight.x + lightTriangleAdjacentWidth;\r\n\r\n    ctx.beginPath();\r\n    ctx.moveTo(stemX - lampWidth / 2, stemHeight + windowFrameThickness * 3);\r\n    ctx.lineTo(stemX + lampWidth / 2, stemHeight + windowFrameThickness * 3);\r\n    ctx.lineTo(lightBottomRightX, canvasHeight);\r\n    ctx.lineTo(lightBottomLeftX, canvasHeight);\r\n    ctx.fill();\r\n  }\r\n\r\n  render() {\r\n    super.render();\r\n\r\n    this.stem();\r\n    this.lampshade();\r\n    this.tick();\r\n  }\r\n\r\n  tick() {\r\n    const {\r\n      ctx,\r\n      canvasWidth,\r\n      canvasHeight,\r\n      windowFrameThickness,\r\n      stemHeight\r\n    } = this;\r\n\r\n    ctx.clearRect(\r\n      0,\r\n      stemHeight + windowFrameThickness * 3,\r\n      canvasWidth,\r\n      canvasHeight\r\n    );\r\n\r\n    this.light();\r\n  }\r\n}\r\n","import { Renderer } from '../renderer';\r\nimport { Wall } from './wall';\r\nimport { Window } from './window';\r\nimport { Dresser } from './dresser';\r\nimport { Pictures } from './pictures';\r\nimport { Table } from './table';\r\nimport { Clock } from './clock';\r\n\r\nexport { Cat } from './cat';\r\nexport { Lamp } from './lamp';\r\n\r\nexport class Home extends Renderer {\r\n  wall: Wall;\r\n  window: Window;\r\n  dresser: Dresser;\r\n  pictures: Pictures;\r\n  table: Table;\r\n  clock: Clock;\r\n\r\n  constructor(ctx: CanvasRenderingContext2D) {\r\n    super(ctx);\r\n\r\n    this.wall = new Wall(ctx);\r\n    this.window = new Window(ctx);\r\n    this.dresser = new Dresser(ctx);\r\n    this.pictures = new Pictures(ctx);\r\n    this.table = new Table(ctx);\r\n    this.clock = new Clock(ctx);\r\n  }\r\n\r\n  render() {\r\n    this.wall.render();\r\n    this.window.render();\r\n    this.dresser.render();\r\n    this.pictures.render();\r\n    this.table.render();\r\n    this.clock.render();\r\n  }\r\n}\r\n","import React, { useRef, useEffect } from 'react';\r\nimport * as VisualizationHOC from '../VisualizationHOC';\r\nimport { QualitySettings } from '../index';\r\nimport { City } from './city';\r\nimport { Rainfall } from './rain';\r\nimport { Home, Cat, Lamp } from './home';\r\nimport './Rain.scss';\r\n\r\nconst MIN_RAINDROPS_PER_TICK = 1;\r\n\r\nconst QUALITY: QualitySettings = {\r\n  0: { MAX_RAINDROPS_PER_TICK: 10 },\r\n  1: { MAX_RAINDROPS_PER_TICK: 33 },\r\n  2: { MAX_RAINDROPS_PER_TICK: 100 }\r\n};\r\n\r\nconst Rain: React.FC<VisualizationHOC.WrappedProps> = ({\r\n  data,\r\n  isBeat,\r\n  lowPassIntensity,\r\n  quality\r\n}) => {\r\n  // city\r\n  const cityCanvasRef = useRef<HTMLCanvasElement>(null);\r\n  const cityRef = useRef<City>();\r\n\r\n  useEffect(() => {\r\n    const cityCanvas = cityCanvasRef.current!;\r\n\r\n    const createCity = (width: number, height: number, dpi: number) => {\r\n      cityCanvas.width = width * dpi;\r\n      cityCanvas.height = height * dpi;\r\n\r\n      const ctx = cityCanvas.getContext('2d')!;\r\n      const city = new City(ctx);\r\n      cityRef.current = city;\r\n      city.render();\r\n    };\r\n\r\n    const resizeCity = () => {\r\n      const { innerWidth, innerHeight, devicePixelRatio } = window;\r\n      createCity(innerWidth, innerHeight, devicePixelRatio);\r\n    };\r\n\r\n    resizeCity();\r\n\r\n    window.addEventListener('resize', resizeCity);\r\n    return () => window.removeEventListener('resize', resizeCity);\r\n  }, []);\r\n\r\n  // rain\r\n  const rainCanvasRef = useRef<HTMLCanvasElement>(null);\r\n  const rainfallRef = useRef<Rainfall>();\r\n\r\n  useEffect(() => {\r\n    const rainCanvas = rainCanvasRef.current!;\r\n\r\n    const createRain = (width: number, height: number, dpi: number) => {\r\n      rainCanvas.width = width * dpi;\r\n      rainCanvas.height = height * dpi;\r\n\r\n      const ctx = rainCanvas.getContext('2d')!;\r\n      let rainfall = rainfallRef.current;\r\n      if (rainfall == null) {\r\n        rainfallRef.current = new Rainfall(ctx);\r\n      } else {\r\n        rainfall = rainfallRef.current!;\r\n        rainfall.canvasWidth = width;\r\n        rainfall.canvasHeight = height;\r\n      }\r\n    };\r\n\r\n    const resizeRain = () => {\r\n      const { innerWidth, innerHeight, devicePixelRatio } = window;\r\n      createRain(innerWidth, innerHeight, devicePixelRatio);\r\n    };\r\n\r\n    resizeRain();\r\n\r\n    window.addEventListener('resize', resizeRain);\r\n    return () => window.removeEventListener('resize', resizeRain);\r\n  }, []);\r\n\r\n  const homeCanvasRef = useRef<HTMLCanvasElement>(null);\r\n  const homeRef = useRef<Home>();\r\n\r\n  // home\r\n  useEffect(() => {\r\n    const homeCanvas = homeCanvasRef.current!;\r\n\r\n    let clockInterval: number;\r\n\r\n    const createHome = (width: number, height: number, dpi: number) => {\r\n      homeCanvas.width = width * dpi;\r\n      homeCanvas.height = height * dpi;\r\n\r\n      const ctx = homeCanvas.getContext('2d')!;\r\n\r\n      const home = new Home(ctx);\r\n      homeRef.current = home;\r\n      home.render();\r\n\r\n      clockInterval && window.clearTimeout(clockInterval);\r\n      clockInterval = window.setInterval(() => home.clock.tick(), 1000);\r\n    };\r\n\r\n    const resizeHome = () => {\r\n      const { innerWidth, innerHeight, devicePixelRatio } = window;\r\n      createHome(innerWidth, innerHeight, devicePixelRatio);\r\n    };\r\n\r\n    resizeHome();\r\n\r\n    window.addEventListener('resize', resizeHome);\r\n    return () => window.removeEventListener('resize', resizeHome);\r\n  }, []);\r\n\r\n  // cat\r\n  const catCanvasRef = useRef<HTMLCanvasElement>(null);\r\n  const catRef = useRef<Cat>();\r\n\r\n  useEffect(() => {\r\n    const catCanvas = catCanvasRef.current!;\r\n\r\n    const adoptCat = (width: number, height: number, dpi: number) => {\r\n      catCanvas.width = width * dpi;\r\n      catCanvas.height = height * dpi;\r\n\r\n      const ctx = catCanvas.getContext('2d')!;\r\n\r\n      const cat = new Cat(ctx);\r\n      catRef.current = cat;\r\n      cat.render();\r\n    };\r\n\r\n    const resizeCat = () => {\r\n      const { innerWidth, innerHeight, devicePixelRatio } = window;\r\n      adoptCat(innerWidth, innerHeight, devicePixelRatio);\r\n    };\r\n\r\n    resizeCat();\r\n\r\n    window.addEventListener('resize', resizeCat);\r\n    return () => window.removeEventListener('resize', resizeCat);\r\n  }, []);\r\n\r\n  // lamp\r\n  const lampCanvasRef = useRef<HTMLCanvasElement>(null);\r\n  const lampRef = useRef<Lamp>();\r\n\r\n  useEffect(() => {\r\n    const lampCanvas = lampCanvasRef.current!;\r\n\r\n    const createLamp = (width: number, height: number, dpi: number) => {\r\n      lampCanvas.width = width * dpi;\r\n      lampCanvas.height = height * dpi;\r\n\r\n      const ctx = lampCanvas.getContext('2d')!;\r\n\r\n      const lamp = new Lamp(ctx);\r\n      lampRef.current = lamp;\r\n      lamp.render();\r\n    };\r\n\r\n    const resizeLamp = () => {\r\n      const { innerWidth, innerHeight, devicePixelRatio } = window;\r\n      createLamp(innerWidth, innerHeight, devicePixelRatio);\r\n    };\r\n\r\n    resizeLamp();\r\n\r\n    window.addEventListener('resize', resizeLamp);\r\n    return () => window.removeEventListener('resize', resizeLamp);\r\n  }, []);\r\n\r\n  // call animating effects on each data and isBeat change\r\n  useEffect(() => {\r\n    const home = homeRef.current!;\r\n    const rainfall = rainfallRef.current!;\r\n    const cat = catRef.current!;\r\n    const lamp = lampRef.current!;\r\n\r\n    let newRaindropsAdded = 0;\r\n    let raindropsToAdd = Math.floor(\r\n      lowPassIntensity / Math.max(1, 4 - quality)\r\n    );\r\n\r\n    if (raindropsToAdd < MIN_RAINDROPS_PER_TICK) {\r\n      raindropsToAdd = MIN_RAINDROPS_PER_TICK;\r\n    } else if (raindropsToAdd > QUALITY[quality].MAX_RAINDROPS_PER_TICK) {\r\n      raindropsToAdd = QUALITY[quality].MAX_RAINDROPS_PER_TICK;\r\n    }\r\n\r\n    while (newRaindropsAdded < raindropsToAdd) {\r\n      rainfall.add();\r\n      newRaindropsAdded += 1;\r\n    }\r\n\r\n    rainfall.tick();\r\n    home.dresser.tick(isBeat);\r\n    // re-render lamp light since the dresser stereo\r\n    // may have been repainted by changing isBeat\r\n    lamp.tick();\r\n    cat.tick();\r\n\r\n    const rainCanvas = rainCanvasRef.current!;\r\n    const rainCtx = rainCanvas.getContext('2d')!;\r\n\r\n    rainCtx.clearRect(0, 0, rainCanvas.width, rainCanvas.height);\r\n\r\n    rainfall.render();\r\n  }, [data, isBeat]);\r\n\r\n  return (\r\n    <div className=\"rain\">\r\n      <div className=\"backdrop\" />\r\n      <canvas ref={cityCanvasRef} />\r\n      <canvas ref={rainCanvasRef} />\r\n      <canvas ref={homeCanvasRef} />\r\n      <canvas ref={catCanvasRef} />\r\n      <canvas ref={lampCanvasRef} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default VisualizationHOC.wrap(Rain);\r\n","import Waveform from './Waveform';\r\nimport Drummer from './Drummer';\r\nimport Halpern from './Halpern';\r\nimport Stars from './Stars';\r\nimport Rain from './Rain';\r\nimport MobileDisabledComponent from './MobileDisabled';\r\nimport { Props } from './VisualizationHOC';\r\nimport { isMobileDevice as isMobileDeviceCheck } from '../../../utils';\r\n\r\nexport const isMobileDevice = isMobileDeviceCheck();\r\n\r\nexport type QualitySettings = {\r\n  [quality: number]: { [setting: string]: any };\r\n};\r\n\r\nexport type Options = {\r\n  smoothing?: number;\r\n  mobileDisabled?: boolean;\r\n};\r\n\r\nexport type SelectableVisualization = {\r\n  component: React.ComponentType<Props>;\r\n  options?: Options;\r\n};\r\n\r\nconst visualizations: SelectableVisualization[] = [\r\n  {\r\n    component: Rain\r\n  },\r\n  {\r\n    component: Stars,\r\n    options: { smoothing: 128 }\r\n  },\r\n  {\r\n    component: Waveform\r\n  },\r\n  {\r\n    component: Drummer,\r\n    options: { smoothing: 64 }\r\n  },\r\n  {\r\n    component: Halpern\r\n  }\r\n];\r\n\r\nexport default visualizations;\r\n\r\nexport const MobileDisabled: SelectableVisualization = {\r\n  component: MobileDisabledComponent\r\n};\r\n","import React from 'react';\r\nimport * as VisualizationHOC from '../VisualizationHOC';\r\nimport './MobileDisabled.scss';\r\n\r\nconst MobileDisabled: React.FC<VisualizationHOC.WrappedProps> = () => {\r\n  return (\r\n    <div className=\"mobile-disabled\">\r\n      <div className=\"content\">\r\n        <img\r\n          id=\"desktop-icon\"\r\n          src={process.env.PUBLIC_URL + '/assets/images/desktop.png'}\r\n        />\r\n        <div id=\"message\">\r\n          Sorry, this visualization cannot be viewed on a mobile device.\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default VisualizationHOC.wrap(MobileDisabled);\r\n","import React, { useCallback } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { useTransition, animated } from 'react-spring';\r\nimport * as VisualizationHOC from './Visualizations/VisualizationHOC';\r\nimport visualizations from './Visualizations';\r\nimport { modulo } from '../../utils';\r\nimport { StoreState } from '../../../src/store/types';\r\n\r\ntype Props = Pick<VisualizationHOC.Props, 'data' | 'lowPassData'>;\r\n\r\ntype StyledProps = Props &\r\n  Pick<StoreState, 'quality'> & {\r\n    style: React.CSSProperties;\r\n  };\r\n\r\nconst mapStateToProps = (state: StoreState) => ({\r\n  currentIndex: state.currentVisualizationIndex,\r\n  prevIndex: state.prevVisualizationIndex,\r\n  quality: state.quality\r\n});\r\n\r\nconst styledVisualizations = visualizations.map(vis => {\r\n  return (props: StyledProps) => {\r\n    const { style, ...rest } = props;\r\n    return (\r\n      <animated.div className=\"visualization\" style={props.style}>\r\n        <vis.component {...rest} options={vis.options} />\r\n      </animated.div>\r\n    );\r\n  };\r\n});\r\n\r\nconst VisualizationSelector: React.FC<\r\n  Props & ReturnType<typeof mapStateToProps>\r\n> = ({ data, lowPassData, prevIndex, currentIndex, quality }) => {\r\n  const visIndex = modulo(currentIndex, visualizations.length);\r\n\r\n  const direction = useCallback((current?, prev?) => {\r\n    let translateXMultiplier = 0;\r\n    if (current < prev) {\r\n      translateXMultiplier = 1;\r\n    } else if (prev < current) {\r\n      translateXMultiplier = -1;\r\n    }\r\n    return `translate3d(${100 * translateXMultiplier}%, 0, 0)`;\r\n  }, []);\r\n\r\n  const transitions = useTransition(visIndex, null, {\r\n    from: { transform: direction(currentIndex, prevIndex) },\r\n    enter: { transform: direction() },\r\n    leave: { transform: direction(prevIndex, currentIndex) },\r\n    initial: { transform: direction(0, -1) }\r\n  });\r\n\r\n  return (\r\n    <>\r\n      {transitions.map(({ item, props, key }) => {\r\n        const Visualization = styledVisualizations[item];\r\n        return (\r\n          <Visualization\r\n            key={key}\r\n            data={data}\r\n            lowPassData={lowPassData}\r\n            quality={quality}\r\n            style={props}\r\n          />\r\n        );\r\n      })}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default connect(\r\n  mapStateToProps,\r\n  null\r\n)(VisualizationSelector);\r\n","import React, { useState, useEffect, useRef } from 'react';\r\nimport VisualizationSelector from '../Visualizer/VisualizationSelector';\r\nimport { FFT_SIZE } from '../../config';\r\n\r\ntype Props = {\r\n  context: AudioContext;\r\n  source: MediaElementAudioSourceNode;\r\n};\r\n\r\nconst Analyser: React.FC<Props> = ({ context, source }) => {\r\n  const [rawData, setRawData] = useState(new Uint8Array());\r\n  const [lowPassData, setLowPassData] = useState(new Uint8Array());\r\n\r\n  const animationFrameIdRef = useRef<number>();\r\n\r\n  useEffect(() => {\r\n    const rawAnalyser = context.createAnalyser();\r\n    rawAnalyser.fftSize = FFT_SIZE;\r\n    rawAnalyser.smoothingTimeConstant = 0;\r\n    source.connect(rawAnalyser);\r\n    rawAnalyser.connect(context.destination);\r\n\r\n    const filter = context.createBiquadFilter();\r\n    filter.type = 'lowpass';\r\n    const lowPassAnalyser = context.createAnalyser();\r\n    lowPassAnalyser.fftSize = FFT_SIZE;\r\n    lowPassAnalyser.smoothingTimeConstant = 0;\r\n    source.connect(filter);\r\n    filter.connect(lowPassAnalyser);\r\n\r\n    const tick = () => {\r\n      const rawDataContainer = new Uint8Array(FFT_SIZE);\r\n      rawAnalyser.getByteTimeDomainData(rawDataContainer);\r\n      setRawData(rawDataContainer);\r\n\r\n      const lowPassDataContainer = new Uint8Array(FFT_SIZE);\r\n      lowPassAnalyser.getByteTimeDomainData(lowPassDataContainer);\r\n      setLowPassData(lowPassDataContainer);\r\n\r\n      animationFrameIdRef.current = window.requestAnimationFrame(tick);\r\n    };\r\n\r\n    animationFrameIdRef.current = window.requestAnimationFrame(tick);\r\n\r\n    return () => {\r\n      animationFrameIdRef.current != null &&\r\n        window.cancelAnimationFrame(animationFrameIdRef.current);\r\n      rawAnalyser && rawAnalyser.disconnect();\r\n      lowPassAnalyser && lowPassAnalyser.disconnect();\r\n      source && source.disconnect();\r\n    };\r\n  }, [context, source]);\r\n\r\n  return <VisualizationSelector data={rawData} lowPassData={lowPassData} />;\r\n};\r\n\r\nexport default Analyser;\r\n","export const FFT_SIZE = 512;\r\nexport const DATA_SIZE = FFT_SIZE / 2;\r\n","import React from 'react';\r\nimport classNames from 'classnames';\r\nimport './Loading.scss';\r\n\r\ntype Props = {\r\n  show?: boolean;\r\n};\r\n\r\nconst Loading: React.FC<Props> = ({ show }) => (\r\n  <div\r\n    className={classNames('loading', { show: show === false ? false : true })}\r\n  >\r\n    <span className=\"loading-dot\" />\r\n    <span className=\"loading-dot\" />\r\n    <span className=\"loading-dot\" />\r\n  </div>\r\n);\r\n\r\nexport default Loading;\r\n","import React from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { Dispatch } from 'redux';\r\nimport * as Actions from '../../../store/actions';\r\nimport { StoreState, Quality } from '../../../store/types';\r\nimport './Quality.scss';\r\n\r\ntype Props = {\r\n  onHover: () => void;\r\n  onHoverStop: () => void;\r\n} & ReturnType<typeof mapStateToProps> &\r\n  ReturnType<typeof mapDispatchToProps>;\r\n\r\nconst qualities = [\r\n  { label: 'low', value: 0 },\r\n  { label: 'medium', value: 1 },\r\n  { label: 'high', value: 2 }\r\n];\r\n\r\nconst QualitySelect: React.FC<Props> = ({\r\n  quality,\r\n  setQuality,\r\n  onHover,\r\n  onHoverStop\r\n}) => {\r\n  return (\r\n    <div id=\"quality\" onMouseEnter={onHover} onMouseLeave={onHoverStop}>\r\n      <select\r\n        value={quality}\r\n        onChange={e => setQuality(+e.target.value as Quality)}\r\n      >\r\n        {qualities.map(quality => (\r\n          <option key={quality.label} value={quality.value}>\r\n            {quality.label}\r\n          </option>\r\n        ))}\r\n      </select>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst mapStateToProps = (state: StoreState) => ({\r\n  quality: state.quality\r\n});\r\n\r\nconst mapDispatchToProps = (dispatch: Dispatch) => ({\r\n  setQuality: (quality: Quality) => dispatch(Actions.setQuality(quality))\r\n});\r\n\r\nexport default connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps\r\n)(QualitySelect);\r\n","import { ActionConstants, ActionUnionType, Quality } from './types';\r\n\r\nexport const goToNextVisualization = (): ActionUnionType => ({\r\n  type: ActionConstants.GO_TO_NEXT_VISUALIZATION\r\n});\r\n\r\nexport const goToPrevVisualization = (): ActionUnionType => ({\r\n  type: ActionConstants.GO_TO_PREV_VISUALIZATION\r\n});\r\n\r\nexport const setQuality = (quality: Quality): ActionUnionType => ({\r\n  type: ActionConstants.SET_QUALITY,\r\n  quality\r\n});\r\n","import React, { useState, useEffect, useCallback, useRef } from 'react';\r\nimport { Dispatch } from 'redux';\r\nimport { connect } from 'react-redux';\r\nimport classNames from 'classnames';\r\nimport Loading from '../Loading';\r\nimport * as Actions from '../../store/actions';\r\nimport * as versionInfo from '../../metadata/build-version.json';\r\nimport QualitySelect from './QualitySelect';\r\nimport './Controls.scss';\r\n\r\nconst CONTROLS_FADE_OUT_DELAY = 1500;\r\nconst TOUCH_WAS_CLICK_THRESHOLD = 250;\r\n\r\ntype Props = ReturnType<typeof mapDispatchToProps> & {\r\n  context?: AudioContext;\r\n  wantsToPlay: boolean;\r\n  isPlaying: boolean;\r\n  togglePlay: () => void;\r\n};\r\n\r\nconst Controls: React.FC<Props> = props => {\r\n  const [isOverlayShown, setIsOverlayShown] = useState(false);\r\n  const [isControlHovered, setIsControlHovered] = useState(false);\r\n\r\n  const timeoutRef = useRef<number>();\r\n  const touchTimestampRef = useRef<number>();\r\n\r\n  useEffect(() => {\r\n    const onKeyDown = (event: KeyboardEvent) => {\r\n      switch (event.which) {\r\n        case 37:\r\n        case 38: {\r\n          props.goToPrevVisualization();\r\n          break;\r\n        }\r\n        case 39:\r\n        case 40: {\r\n          props.goToNextVisualization();\r\n          break;\r\n        }\r\n      }\r\n    };\r\n\r\n    document.addEventListener('keydown', onKeyDown);\r\n    return () => document.removeEventListener('keydown', onKeyDown);\r\n  }, []);\r\n\r\n  const showOverlay = useCallback(() => {\r\n    timeoutRef.current != null && window.clearTimeout(timeoutRef.current);\r\n\r\n    setIsOverlayShown(true);\r\n    timeoutRef.current = window.setTimeout(() => {\r\n      if (!isControlHovered) {\r\n        setIsOverlayShown(false);\r\n      }\r\n    }, CONTROLS_FADE_OUT_DELAY);\r\n  }, [isControlHovered]);\r\n\r\n  const togglePlay = useCallback(() => {\r\n    props.context && props.context.resume();\r\n    props.togglePlay();\r\n    showOverlay();\r\n  }, [props.context, props.togglePlay]);\r\n\r\n  const recordTouchTimestamp = useCallback((event: React.TouchEvent) => {\r\n    event.preventDefault();\r\n    touchTimestampRef.current = Date.now();\r\n  }, []);\r\n\r\n  const goToRepo = () => window.open('https://github.com/blackwright/late');\r\n\r\n  const onMouseDown = useCallback((event: React.MouseEvent) => {\r\n    if (event.nativeEvent.which === 1) {\r\n      touchTimestampRef.current = Date.now();\r\n    }\r\n  }, []);\r\n\r\n  const onMouseUp = useCallback((event: React.MouseEvent) => {\r\n    if (\r\n      event.nativeEvent.which === 1 &&\r\n      touchTimestampRef.current &&\r\n      Date.now() - touchTimestampRef.current < TOUCH_WAS_CLICK_THRESHOLD\r\n    ) {\r\n      togglePlay();\r\n    }\r\n  }, []);\r\n\r\n  const onTouchEnd = useCallback(\r\n    (event: React.TouchEvent) => {\r\n      event.preventDefault();\r\n      if (\r\n        touchTimestampRef.current &&\r\n        Date.now() - touchTimestampRef.current < TOUCH_WAS_CLICK_THRESHOLD\r\n      ) {\r\n        showOverlay();\r\n      }\r\n    },\r\n    [isControlHovered]\r\n  );\r\n\r\n  const onPrev = useCallback(\r\n    (event: React.MouseEvent | React.TouchEvent) => {\r\n      event.stopPropagation();\r\n      props.goToPrevVisualization();\r\n      showOverlay();\r\n    },\r\n    [isControlHovered]\r\n  );\r\n\r\n  const onNext = useCallback(\r\n    (event: React.MouseEvent | React.TouchEvent) => {\r\n      event.stopPropagation();\r\n      props.goToNextVisualization();\r\n      showOverlay();\r\n    },\r\n    [isControlHovered]\r\n  );\r\n\r\n  const doNothing = useCallback((event: React.MouseEvent) => {\r\n    event.stopPropagation();\r\n  }, []);\r\n\r\n  const onHover = useCallback(() => setIsControlHovered(true), []);\r\n\r\n  const onHoverStop = useCallback(() => setIsControlHovered(false), []);\r\n\r\n  const { wantsToPlay, isPlaying } = props;\r\n\r\n  return (\r\n    <>\r\n      {wantsToPlay && !isPlaying && <Loading />}\r\n      <div\r\n        id=\"overlay\"\r\n        onTouchStart={recordTouchTimestamp}\r\n        onTouchEnd={onTouchEnd}\r\n        onMouseMove={showOverlay}\r\n        className={classNames({ show: isOverlayShown })}\r\n      >\r\n        <h1\r\n          id=\"title\"\r\n          onClick={goToRepo}\r\n          onTouchEnd={goToRepo}\r\n          onMouseEnter={onHover}\r\n          onMouseLeave={onHoverStop}\r\n        >\r\n          LATE\r\n        </h1>\r\n        <QualitySelect onHover={onHover} onHoverStop={onHoverStop} />\r\n        <div id=\"version\">build {versionInfo.version}</div>\r\n        {\r\n          <div\r\n            onMouseDown={onMouseDown}\r\n            onMouseUp={onMouseUp}\r\n            onTouchEnd={togglePlay}\r\n            onMouseEnter={onHover}\r\n            onMouseLeave={onHoverStop}\r\n            className={classNames({\r\n              play: !wantsToPlay && !isPlaying,\r\n              pause: wantsToPlay && isPlaying\r\n            })}\r\n          />\r\n        }\r\n        <div className=\"navigation\">\r\n          <div\r\n            className=\"arrow-container\"\r\n            onClick={onPrev}\r\n            onTouchStart={onPrev}\r\n            onMouseUp={doNothing}\r\n            onMouseEnter={onHover}\r\n            onMouseLeave={onHoverStop}\r\n          >\r\n            <svg\r\n              className=\"arrow\"\r\n              width=\"60px\"\r\n              height=\"80px\"\r\n              viewBox=\"0 0 50 80\"\r\n            >\r\n              <polyline\r\n                fill=\"none\"\r\n                stroke=\"#FFF\"\r\n                strokeWidth=\"3\"\r\n                strokeLinecap=\"round\"\r\n                strokeLinejoin=\"round\"\r\n                points=\"45.63,75.8 0.375,38.087 45.63,0.375\"\r\n              />\r\n            </svg>\r\n          </div>\r\n          <div\r\n            className=\"arrow-container\"\r\n            onClick={onNext}\r\n            onTouchStart={onNext}\r\n            onMouseUp={doNothing}\r\n            onMouseEnter={onHover}\r\n            onMouseLeave={onHoverStop}\r\n          >\r\n            <svg\r\n              className=\"arrow\"\r\n              width=\"60px\"\r\n              height=\"80px\"\r\n              viewBox=\"0 0 50 80\"\r\n            >\r\n              <polyline\r\n                fill=\"none\"\r\n                stroke=\"#FFF\"\r\n                strokeWidth=\"3\"\r\n                strokeLinecap=\"round\"\r\n                strokeLinejoin=\"round\"\r\n                points=\"0.375,0.375 45.63,38.087 0.375,75.8\"\r\n              />\r\n            </svg>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch: Dispatch) => ({\r\n  goToNextVisualization: () => dispatch(Actions.goToNextVisualization()),\r\n  goToPrevVisualization: () => dispatch(Actions.goToPrevVisualization())\r\n});\r\n\r\nexport default connect(\r\n  null,\r\n  mapDispatchToProps\r\n)(Controls);\r\n","import React from 'react';\r\nimport './NoWebAudioApi.scss';\r\n\r\nconst NoWebAudioApi = () => (\r\n  <div id=\"no-web-audio\">\r\n    <p>Your device doesn't fully support the Web Audio API.</p>\r\n    <p>This site should be viewed on a non-mobile or Android device.</p>\r\n  </div>\r\n);\r\n\r\nexport default NoWebAudioApi;\r\n","import React, { useState, useRef, useEffect, useCallback } from 'react';\nimport Analyser from './components/Analyser';\nimport Controls from './components/Controls';\nimport NoWebAudioApi from './components/NoWebAudioApi';\nimport { useStateRef } from './utils/hooks';\n\nconst AUDIO_SERVER_URL =\n  process.env.NODE_ENV === 'production'\n    ? process.env.REACT_APP_AUDIO_SERVER_URL\n    : 'http://localhost:3002';\n\ntype Props = {};\n\nconst App: React.FC<Props> = props => {\n  const [wantsToPlay, setWantsToPlay] = useState(false);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [context, setContext, contextRef] = useStateRef<\n    AudioContext | undefined\n  >(undefined);\n  const [source, setSource] = useState<MediaElementAudioSourceNode>();\n  const [isContextUnavailable, setIsContextUnavailable] = useState(false);\n\n  const audioRef = useRef<HTMLAudioElement>(null);\n\n  // disable if AudioContext is unavailable\n  useEffect(() => {\n    try {\n      new window.AudioContext();\n    } catch (err) {\n      setIsContextUnavailable(true);\n    }\n  }, []);\n\n  // attach audio event listeners\n  useEffect(() => {\n    const audioElement = audioRef.current!;\n\n    const onAudioPlay = () => setIsPlaying(true);\n    const onAudioPause = () => setIsPlaying(false);\n    const onAudioError = console.error;\n\n    audioElement.addEventListener('playing', onAudioPlay);\n    audioElement.addEventListener('pause', onAudioPause);\n    audioElement.addEventListener('error', onAudioError);\n\n    return () => {\n      audioElement.removeEventListener('playing', onAudioPlay);\n      audioElement.removeEventListener('pause', onAudioPause);\n      audioElement.removeEventListener('error', onAudioError);\n    };\n  }, []);\n\n  const initializeAudioContext = useCallback(() => {\n    const audioElement = audioRef.current!;\n    const context = new window.AudioContext();\n    const source = context.createMediaElementSource(audioElement);\n\n    setContext(context);\n    setSource(source);\n  }, [audioRef.current]);\n\n  const togglePlay = useCallback(() => {\n    const audioElement = audioRef.current!;\n\n    if (audioElement.paused) {\n      setWantsToPlay(true);\n      audioElement.play();\n\n      if (!contextRef.current) {\n        initializeAudioContext();\n      }\n    } else {\n      setWantsToPlay(false);\n      audioElement.pause();\n    }\n  }, [audioRef.current]);\n\n  if (isContextUnavailable) {\n    return <NoWebAudioApi />;\n  }\n\n  return (\n    <>\n      <audio\n        ref={audioRef}\n        id=\"audioElement\"\n        src={AUDIO_SERVER_URL}\n        preload={'auto'}\n        crossOrigin=\"anonymous\"\n      />\n\n      {context && source && <Analyser context={context} source={source} />}\n\n      <Controls\n        context={context}\n        wantsToPlay={wantsToPlay}\n        isPlaying={isPlaying}\n        togglePlay={togglePlay}\n      />\n    </>\n  );\n};\n\nexport default App;\n","import React, { useState, useEffect, useRef } from 'react';\r\n\r\nexport function useStateRef<S>(\r\n  initialState: S | (() => S)\r\n): [S, React.Dispatch<React.SetStateAction<S>>, React.MutableRefObject<S>] {\r\n  const [state, setState] = useState(initialState);\r\n  const stateRef = useRef(state);\r\n\r\n  useEffect(() => {\r\n    stateRef.current = state;\r\n  }, [state]);\r\n\r\n  return [state, setState, stateRef];\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { Provider } from 'react-redux';\r\nimport * as serviceWorker from './serviceWorker';\r\nimport store from './store';\r\nimport App from './App';\r\nimport './reset.scss';\r\nimport './index.scss';\r\n\r\nReactDOM.render(\r\n  <Provider store={store}>\r\n    <App />\r\n  </Provider>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: http://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}