{"version":3,"sources":["config/index.ts","utils/hooks.ts","serviceWorker.js","store/types.ts","store/reducer.ts","store/index.ts","components/Visualizer/Visualizations/LoadingVisualization/index.tsx","components/Visualizer/Visualizations/index.tsx","components/Visualizer/VisualizationSelector.tsx","components/Analyser/index.tsx","components/LoadingAudio/index.tsx","songs.ts","components/Controls/AudioControls/index.tsx","components/Controls/index.tsx","store/actions.ts","components/App/index.tsx","index.tsx","utils/index.ts"],"names":["__webpack_require__","d","__webpack_exports__","FFT_SIZE","DATA_SIZE","useStateRef","initialState","_useState","useState","_useState2","Object","C_Users_gao_Documents_Code_late_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__","state","setState","stateRef","useRef","useEffect","current","useDebouncedResize","fn","deps","debouncedFn","debounced","window","addEventListener","removeEventListener","Boolean","location","hostname","match","ActionConstants","currentVisualizationIndex","prevVisualizationIndex","store","createStore","arguments","length","undefined","type","GO_TO_NEXT_VISUALIZATION","objectSpread","GO_TO_PREV_VISUALIZATION","__REDUX_DEVTOOLS_EXTENSION__","LoadingVisualization","react_default","a","createElement","className","visualizations","component","React","lazy","e","then","bind","Promise","all","options","smoothing","styledVisualizations","map","vis","props","style","rest","objectWithoutProperties","web","div","assign","connect","currentIndex","prevIndex","_ref","data","lowPassData","visIndex","modulo","direction","useCallback","prev","translateXMultiplier","concat","transitions","useTransition","from","transform","enter","leave","initial","react","fallback","Visualizations_LoadingVisualization","_ref2","item","key","Visualization","Analyser","audioContext","audioSource","Uint8Array","slicedToArray","rawData","setRawData","_useState3","_useState4","setLowPassData","animationFrameIdRef","rawAnalyser","createAnalyser","fftSize","smoothingTimeConstant","destination","filter","createBiquadFilter","lowPassAnalyser","requestAnimationFrame","tick","rawDataContainer","getByteTimeDomainData","lowPassDataContainer","cancelAnimationFrame","disconnect","Visualizer_VisualizationSelector","LoadingAudio","_ref$isShown","isShown","classNames","show","songs","artist","title","path","AudioControls","onHover","onHoverStop","audioIndex","prevTrack","nextTrack","currentSong","id","onMouseEnter","onMouseLeave","toLocaleLowerCase","onTouchEnd","onMouseUp","index_es","icon","faStepBackward","size","faStepForward","dispatch","goToNextVisualization","goToPrevVisualization","isOverlayShown","setIsOverlayShown","isControlHovered","setIsControlHovered","timeoutRef","touchRef","onKeyDown","event","which","document","showOverlay","clearTimeout","setTimeout","togglePlay","resume","onTouchStart","preventDefault","timestamp","Date","now","x","touches","clientX","goToRepo","open","onMouseDown","nativeEvent","deltaX","changedTouches","Math","abs","onPrev","onNext","wantsToPlay","isPlaying","Fragment","components_LoadingAudio","onMouseMove","onClick","versionInfo","play","pause","width","height","viewBox","fill","stroke","strokeWidth","strokeLinecap","strokeLinejoin","points","Controls_AudioControls","App","setWantsToPlay","setIsPlaying","_useStateRef","_useStateRef2","setAudioContext","audioContextRef","_useState5","_useState6","setSource","_useStateRef3","_useStateRef4","setAudioIndex","audioRef","audioElement","nextAudioIndex","src","prevAudioIndex","shouldStayOnThisTrack","currentTime","onAudioPlay","onAudioPause","onAudioError","console","error","initializeAudioContext","AudioContext","webkitAudioContext","createMediaElementSource","paused","ref","preload","crossOrigin","components_Analyser","components_Controls","ReactDOM","render","es","components_App","getElementById","navigator","serviceWorker","ready","registration","unregister","number1","number2","isInteger","number","randomNumberBetween","min","max","decimalPrecision","floor","random","randomFloat","Number","toPrecision","msToWait","isImmediate","timeoutId","_len","args","Array","_key","context","this","shouldCallNow","apply"],"mappings":"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","file":"static/js/main.34b75903.chunk.js","sourcesContent":["export const FFT_SIZE = 512;\r\nexport const DATA_SIZE = FFT_SIZE / 2;\r\n","import React, { useState, useEffect, useRef } from 'react';\r\nimport { debounced } from '../utils';\r\n\r\nexport function useStateRef<S>(\r\n  initialState: S | (() => S)\r\n): [S, React.Dispatch<React.SetStateAction<S>>, React.MutableRefObject<S>] {\r\n  const [state, setState] = useState(initialState);\r\n  const stateRef = useRef(state);\r\n\r\n  useEffect(() => {\r\n    stateRef.current = state;\r\n  }, [state]);\r\n\r\n  return [state, setState, stateRef];\r\n}\r\n\r\nexport function useDebouncedResize(\r\n  fn: React.EffectCallback,\r\n  deps?: React.DependencyList\r\n) {\r\n  useEffect(() => {\r\n    fn();\r\n    const debouncedFn = debounced(fn);\r\n\r\n    window.addEventListener('resize', debouncedFn);\r\n    return () => window.removeEventListener('resize', debouncedFn);\r\n  }, deps);\r\n}\r\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","export type StoreState = {\r\n  currentVisualizationIndex: number;\r\n  prevVisualizationIndex: number;\r\n};\r\n\r\nexport enum ActionConstants {\r\n  BEGIN_VISUALIZATION_TRANSITION = 'BEGIN_VISUALIZATION_TRANSITION',\r\n  END_VISUALIZATION_TRANSITION = 'END_VISUALIZATION_TRANSITION',\r\n  GO_TO_PREV_VISUALIZATION = 'GO_TO_PREV_VISUALIZATION',\r\n  GO_TO_NEXT_VISUALIZATION = 'GO_TO_NEXT_VISUALIZATION'\r\n}\r\n\r\ninterface GoToNextVisualizationAction {\r\n  type: typeof ActionConstants.GO_TO_NEXT_VISUALIZATION;\r\n}\r\n\r\ninterface GoToPrevVisualizationAction {\r\n  type: typeof ActionConstants.GO_TO_PREV_VISUALIZATION;\r\n}\r\n\r\nexport type ActionUnionType =\r\n  | GoToNextVisualizationAction\r\n  | GoToPrevVisualizationAction;\r\n","import { StoreState, ActionConstants, ActionUnionType } from './types';\r\n\r\nconst initialState: StoreState = {\r\n  currentVisualizationIndex: 0,\r\n  prevVisualizationIndex: 0\r\n};\r\n\r\nexport default function reducer(\r\n  state = initialState,\r\n  action: ActionUnionType\r\n): StoreState {\r\n  switch (action.type) {\r\n    case ActionConstants.GO_TO_NEXT_VISUALIZATION:\r\n      return {\r\n        ...state,\r\n        currentVisualizationIndex: state.currentVisualizationIndex + 1,\r\n        prevVisualizationIndex: state.currentVisualizationIndex\r\n      };\r\n\r\n    case ActionConstants.GO_TO_PREV_VISUALIZATION:\r\n      return {\r\n        ...state,\r\n        currentVisualizationIndex: state.currentVisualizationIndex - 1,\r\n        prevVisualizationIndex: state.currentVisualizationIndex\r\n      };\r\n\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n","import { createStore } from 'redux';\r\nimport reducer from './reducer';\r\n\r\nconst store = createStore(\r\n  reducer,\r\n  (window as any).__REDUX_DEVTOOLS_EXTENSION__ &&\r\n    (window as any).__REDUX_DEVTOOLS_EXTENSION__()\r\n);\r\n\r\nexport default store;\r\n","import React from 'react';\r\nimport './LoadingVisualization.scss';\r\n\r\nconst LoadingVisualization: React.FC = () => (\r\n  <div className=\"loading-visualization\">\r\n    <div className=\"ring\">\r\n      <div />\r\n      <div />\r\n      <div />\r\n      <div />\r\n    </div>\r\n  </div>\r\n);\r\n\r\nexport default LoadingVisualization;\r\n","import React from 'react';\r\nimport Drummer from './Drummer';\r\nimport Halpern from './Halpern';\r\nimport Stars from './Stars';\r\nimport Rain from './Rain';\r\nimport { Props } from './VisualizationHOC';\r\n\r\nexport type QualitySettings = {\r\n  [quality: number]: { [setting: string]: any };\r\n};\r\n\r\nexport type Options = {\r\n  smoothing?: number;\r\n};\r\n\r\nexport type SelectableVisualization = {\r\n  component: React.ComponentType<Props>;\r\n  options?: Options;\r\n};\r\n\r\nconst visualizations: SelectableVisualization[] = [\r\n  {\r\n    component: React.lazy(() => import('./Rain'))\r\n  },\r\n  {\r\n    component: React.lazy(() => import('./Stars')),\r\n    options: { smoothing: 128 }\r\n  },\r\n  {\r\n    component: React.lazy(() => import('./Waveform'))\r\n  },\r\n  {\r\n    component: React.lazy(() => import('./Drummer')),\r\n    options: { smoothing: 64 }\r\n  },\r\n  {\r\n    component: React.lazy(() => import('./Halpern'))\r\n  }\r\n];\r\n\r\nexport default visualizations;\r\n","import React, { Suspense, useCallback } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { useTransition, animated } from 'react-spring';\r\nimport * as VisualizationHOC from './Visualizations/VisualizationHOC';\r\nimport LoadingVisualization from './Visualizations/LoadingVisualization';\r\nimport visualizations from './Visualizations';\r\nimport { modulo } from '../../utils';\r\nimport { StoreState } from '../../../src/store/types';\r\n\r\ntype Props = Pick<VisualizationHOC.Props, 'data' | 'lowPassData'>;\r\n\r\ntype StyledProps = Props & {\r\n  style: React.CSSProperties;\r\n};\r\n\r\nconst mapStateToProps = (state: StoreState) => ({\r\n  currentIndex: state.currentVisualizationIndex,\r\n  prevIndex: state.prevVisualizationIndex\r\n});\r\n\r\nconst styledVisualizations = visualizations.map(vis => {\r\n  return (props: StyledProps) => {\r\n    const { style, ...rest } = props;\r\n\r\n    return (\r\n      <animated.div className=\"visualization\" style={props.style}>\r\n        <vis.component {...rest} options={vis.options} />\r\n      </animated.div>\r\n    );\r\n  };\r\n});\r\n\r\nconst VisualizationSelector: React.FC<\r\n  Props & ReturnType<typeof mapStateToProps>\r\n> = ({ data, lowPassData, prevIndex, currentIndex }) => {\r\n  const visIndex = modulo(currentIndex, visualizations.length);\r\n\r\n  const direction = useCallback((current?, prev?) => {\r\n    let translateXMultiplier = 0;\r\n\r\n    if (current < prev) {\r\n      translateXMultiplier = 1;\r\n    } else if (prev < current) {\r\n      translateXMultiplier = -1;\r\n    }\r\n\r\n    return `translate3d(${100 * translateXMultiplier}%, 0, 0)`;\r\n  }, []);\r\n\r\n  const transitions = useTransition(visIndex, null, {\r\n    from: { transform: direction(currentIndex, prevIndex) },\r\n    enter: { transform: direction() },\r\n    leave: { transform: direction(prevIndex, currentIndex) },\r\n    initial: { transform: direction(0, -1) }\r\n  });\r\n\r\n  return (\r\n    <Suspense fallback={<LoadingVisualization />}>\r\n      {transitions.map(({ item, props, key }) => {\r\n        const Visualization = styledVisualizations[item];\r\n        return (\r\n          <Visualization\r\n            key={key}\r\n            data={data}\r\n            lowPassData={lowPassData}\r\n            style={props}\r\n          />\r\n        );\r\n      })}\r\n    </Suspense>\r\n  );\r\n};\r\n\r\nexport default connect(mapStateToProps)(VisualizationSelector);\r\n","import React, { useState, useEffect, useRef } from 'react';\r\nimport VisualizationSelector from '../Visualizer/VisualizationSelector';\r\nimport { FFT_SIZE } from '../../config';\r\n\r\ntype Props = {\r\n  audioContext?: AudioContext;\r\n  audioSource?: MediaElementAudioSourceNode;\r\n};\r\n\r\nconst Analyser: React.FC<Props> = ({ audioContext, audioSource }) => {\r\n  const [rawData, setRawData] = useState(new Uint8Array());\r\n  const [lowPassData, setLowPassData] = useState(new Uint8Array());\r\n\r\n  const animationFrameIdRef = useRef<number>();\r\n\r\n  useEffect(() => {\r\n    if (audioContext == null || audioSource == null) {\r\n      return;\r\n    }\r\n\r\n    const rawAnalyser = audioContext.createAnalyser();\r\n    rawAnalyser.fftSize = FFT_SIZE;\r\n    rawAnalyser.smoothingTimeConstant = 0;\r\n    audioSource.connect(rawAnalyser);\r\n    rawAnalyser.connect(audioContext.destination);\r\n\r\n    const filter = audioContext.createBiquadFilter();\r\n    filter.type = 'lowpass';\r\n    const lowPassAnalyser = audioContext.createAnalyser();\r\n    lowPassAnalyser.fftSize = FFT_SIZE;\r\n    lowPassAnalyser.smoothingTimeConstant = 0;\r\n    audioSource.connect(filter);\r\n    filter.connect(lowPassAnalyser);\r\n\r\n    const tick = () => {\r\n      const rawDataContainer = new Uint8Array(FFT_SIZE);\r\n      rawAnalyser.getByteTimeDomainData(rawDataContainer);\r\n      setRawData(rawDataContainer);\r\n\r\n      const lowPassDataContainer = new Uint8Array(FFT_SIZE);\r\n      lowPassAnalyser.getByteTimeDomainData(lowPassDataContainer);\r\n      setLowPassData(lowPassDataContainer);\r\n\r\n      animationFrameIdRef.current = window.requestAnimationFrame(tick);\r\n    };\r\n\r\n    animationFrameIdRef.current = window.requestAnimationFrame(tick);\r\n\r\n    return () => {\r\n      animationFrameIdRef.current != null &&\r\n        window.cancelAnimationFrame(animationFrameIdRef.current);\r\n      rawAnalyser && rawAnalyser.disconnect();\r\n      lowPassAnalyser && lowPassAnalyser.disconnect();\r\n      audioSource && audioSource.disconnect();\r\n    };\r\n  }, [audioContext, audioSource]);\r\n\r\n  return <VisualizationSelector data={rawData} lowPassData={lowPassData} />;\r\n};\r\n\r\nexport default Analyser;\r\n","import React from 'react';\r\nimport classNames from 'classnames';\r\nimport './LoadingAudio.scss';\r\n\r\ntype Props = {\r\n  isShown?: boolean;\r\n};\r\n\r\nconst LoadingAudio: React.FC<Props> = ({ isShown = true }) => (\r\n  <div className={classNames('loading-audio', { show: isShown })}>\r\n    <span className=\"loading-dot\" />\r\n    <span className=\"loading-dot\" />\r\n    <span className=\"loading-dot\" />\r\n  </div>\r\n);\r\n\r\nexport default LoadingAudio;\r\n","type Song = {\r\n  artist: string;\r\n  title: string;\r\n  path: string;\r\n};\r\n\r\nexport const songs: Song[] = [\r\n  {\r\n    artist: 'Nujabes',\r\n    title: 'Aruarian Dance',\r\n    path: 'https://blackwright-late.s3.amazonaws.com/nujabes-aruarian-dance.mp3'\r\n  },\r\n  {\r\n    artist: 'BØJET',\r\n    title: 'Lost',\r\n    path: 'https://blackwright-late.s3.amazonaws.com/b%C3%B8jet-lost.mp3'\r\n  },\r\n  {\r\n    artist: 'Kudasai',\r\n    title: 'Dream of Her',\r\n    path: 'https://blackwright-late.s3.amazonaws.com/kudasai-dream-of-her.mp3'\r\n  },\r\n  {\r\n    artist: 'Wys',\r\n    title: 'Close My Eyes',\r\n    path: 'https://blackwright-late.s3.amazonaws.com/wys-close-my-eyes.mp3'\r\n  },\r\n  {\r\n    artist: 'Sky.High',\r\n    title: `Cold Days (feat. j'san)`,\r\n    path:\r\n      'https://blackwright-late.s3.amazonaws.com/sky.high-cold-days-feat-jsan.mp3'\r\n  },\r\n  {\r\n    artist: 'Kudasai',\r\n    title: `The Girl I Haven't Met`,\r\n    path: 'https://blackwright-late.s3.amazonaws.com/kudasai-the-girl.mp3'\r\n  },\r\n  {\r\n    artist: 'Fujitsu',\r\n    title: 'Awaiting',\r\n    path: 'https://blackwright-late.s3.amazonaws.com/fujitsu-awaiting.mp3'\r\n  },\r\n  {\r\n    artist: 'Nymano',\r\n    title: 'For You',\r\n    path: 'https://blackwright-late.s3.amazonaws.com/nymano-for-you.mp3'\r\n  },\r\n  {\r\n    artist: 'Kudasai',\r\n    title: 'Technicolor',\r\n    path: 'https://blackwright-late.s3.amazonaws.com/kudasai-technicolor.mp3'\r\n  },\r\n  {\r\n    artist: 'Juan Rios',\r\n    title: 'Noche',\r\n    path: 'https://blackwright-late.s3.amazonaws.com/juan-rios-noche.mp3'\r\n  },\r\n  {\r\n    artist: 'Philanthrope',\r\n    title: 'Carwash',\r\n    path: 'https://blackwright-late.s3.amazonaws.com/philanthrope-carwash.mp3'\r\n  },\r\n  {\r\n    artist: 'agxxd1ne',\r\n    title: 'Sunday Morning',\r\n    path:\r\n      'https://blackwright-late.s3.amazonaws.com/agxxd1ne-sunday-morning.mp3'\r\n  },\r\n  {\r\n    artist: 'Flamingosis',\r\n    title: 'Football Head',\r\n    path:\r\n      'https://blackwright-late.s3.amazonaws.com/flamingosis-football-head.mp3'\r\n  },\r\n  {\r\n    artist: 'Nujabes',\r\n    title: 'Counting Stars',\r\n    path: 'https://blackwright-late.s3.amazonaws.com/nujabes-counting-stars.mp3'\r\n  }\r\n];\r\n","import React from 'react';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport {\r\n  faStepBackward,\r\n  faStepForward\r\n} from '@fortawesome/free-solid-svg-icons';\r\nimport './AudioControls.scss';\r\nimport { songs } from '../../../songs';\r\n\r\ntype Props = {\r\n  onHover: () => void;\r\n  onHoverStop: () => void;\r\n  audioIndex: number;\r\n  prevTrack: () => void;\r\n  nextTrack: () => void;\r\n};\r\n\r\nconst AudioControls: React.FC<Props> = ({\r\n  onHover,\r\n  onHoverStop,\r\n  audioIndex,\r\n  prevTrack,\r\n  nextTrack\r\n}) => {\r\n  const currentSong = songs[audioIndex];\r\n\r\n  return (\r\n    <div id=\"audio-controls\" onMouseEnter={onHover} onMouseLeave={onHoverStop}>\r\n      {currentSong.artist.toLocaleLowerCase()}\r\n      {' - '}\r\n      {currentSong.title.toLocaleLowerCase()}\r\n      <div id=\"track-controls\">\r\n        <button onTouchEnd={prevTrack} onMouseUp={prevTrack}>\r\n          <FontAwesomeIcon icon={faStepBackward} size=\"xs\" />\r\n        </button>\r\n        <button onTouchEnd={nextTrack} onMouseUp={nextTrack}>\r\n          <FontAwesomeIcon icon={faStepForward} size=\"xs\" />\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AudioControls;\r\n","import React, { useState, useEffect, useCallback, useRef } from 'react';\r\nimport { Dispatch } from 'redux';\r\nimport { connect } from 'react-redux';\r\nimport classNames from 'classnames';\r\nimport LoadingAudio from '../LoadingAudio';\r\nimport * as Actions from '../../store/actions';\r\nimport * as versionInfo from '../../metadata/build-version.json';\r\nimport AudioControls from './AudioControls';\r\nimport './Controls.scss';\r\n\r\nconst CONTROLS_FADE_OUT_DELAY = 3000;\r\nconst TOUCH_WAS_CLICK_THRESHOLD = 250;\r\nconst TOUCH_WAS_SWIPE_THRESHOLD = 350;\r\n\r\ntype Props = {\r\n  audioContext?: AudioContext;\r\n  wantsToPlay: boolean;\r\n  isPlaying: boolean;\r\n  togglePlay: () => void;\r\n  audioIndex: number;\r\n  prevTrack: () => void;\r\n  nextTrack: () => void;\r\n} & ReturnType<typeof mapDispatchToProps>;\r\n\r\ntype Touch = {\r\n  timestamp: number;\r\n  x: number;\r\n};\r\n\r\nconst Controls: React.FC<Props> = props => {\r\n  const [isOverlayShown, setIsOverlayShown] = useState(true);\r\n  const [isControlHovered, setIsControlHovered] = useState(false);\r\n\r\n  const timeoutRef = useRef<number>();\r\n  const touchRef = useRef<Touch>();\r\n\r\n  useEffect(() => {\r\n    const onKeyDown = (event: KeyboardEvent) => {\r\n      switch (event.which) {\r\n        case 37:\r\n        case 38: {\r\n          props.goToPrevVisualization();\r\n          break;\r\n        }\r\n        case 39:\r\n        case 40: {\r\n          props.goToNextVisualization();\r\n          break;\r\n        }\r\n      }\r\n    };\r\n\r\n    document.addEventListener('keydown', onKeyDown);\r\n    return () => document.removeEventListener('keydown', onKeyDown);\r\n  }, []);\r\n\r\n  const showOverlay = useCallback(() => {\r\n    timeoutRef.current != null && window.clearTimeout(timeoutRef.current);\r\n\r\n    setIsOverlayShown(true);\r\n    timeoutRef.current = window.setTimeout(() => {\r\n      if (!isControlHovered) {\r\n        setIsOverlayShown(false);\r\n      }\r\n    }, CONTROLS_FADE_OUT_DELAY);\r\n  }, [isControlHovered]);\r\n\r\n  const togglePlay = useCallback(() => {\r\n    props.audioContext && props.audioContext.resume();\r\n    props.togglePlay();\r\n    showOverlay();\r\n  }, [props.audioContext, props.togglePlay]);\r\n\r\n  const onTouchStart = useCallback((event: React.TouchEvent) => {\r\n    event.preventDefault();\r\n    touchRef.current = { timestamp: Date.now(), x: event.touches[0].clientX };\r\n  }, []);\r\n\r\n  const goToRepo = () => window.open('https://github.com/blackwright/late');\r\n\r\n  const onMouseDown = useCallback((event: React.MouseEvent) => {\r\n    if (event.nativeEvent.which === 1) {\r\n      touchRef.current = { timestamp: Date.now(), x: event.clientX };\r\n    }\r\n  }, []);\r\n\r\n  const onMouseUp = useCallback((event: React.MouseEvent) => {\r\n    if (\r\n      event.nativeEvent.which === 1 &&\r\n      touchRef.current &&\r\n      Date.now() - touchRef.current.timestamp < TOUCH_WAS_CLICK_THRESHOLD\r\n    ) {\r\n      togglePlay();\r\n    }\r\n  }, []);\r\n\r\n  const onTouchEnd = useCallback(\r\n    (event: React.TouchEvent) => {\r\n      event.preventDefault();\r\n      if (\r\n        touchRef.current &&\r\n        Date.now() - touchRef.current.timestamp < TOUCH_WAS_CLICK_THRESHOLD\r\n      ) {\r\n        showOverlay();\r\n      }\r\n\r\n      if (\r\n        touchRef.current &&\r\n        Date.now() - touchRef.current.timestamp < TOUCH_WAS_SWIPE_THRESHOLD\r\n      ) {\r\n        const deltaX = event.changedTouches[0].clientX - touchRef.current.x;\r\n        if (Math.abs(deltaX) > 50) {\r\n          if (deltaX < 0) {\r\n            props.goToPrevVisualization();\r\n          } else {\r\n            props.goToNextVisualization();\r\n          }\r\n        }\r\n      }\r\n    },\r\n    [isControlHovered]\r\n  );\r\n\r\n  const onPrev = useCallback(\r\n    (event: React.MouseEvent | React.TouchEvent) => {\r\n      event.preventDefault();\r\n      props.goToPrevVisualization();\r\n      showOverlay();\r\n    },\r\n    [isControlHovered]\r\n  );\r\n\r\n  const onNext = useCallback(\r\n    (event: React.MouseEvent | React.TouchEvent) => {\r\n      event.preventDefault();\r\n      props.goToNextVisualization();\r\n      showOverlay();\r\n    },\r\n    [isControlHovered]\r\n  );\r\n\r\n  const onHover = useCallback(() => setIsControlHovered(true), []);\r\n\r\n  const onHoverStop = useCallback(() => setIsControlHovered(false), []);\r\n\r\n  const { wantsToPlay, isPlaying, audioIndex, prevTrack, nextTrack } = props;\r\n\r\n  return (\r\n    <>\r\n      {wantsToPlay && !isPlaying && <LoadingAudio />}\r\n      <div\r\n        id=\"overlay\"\r\n        onTouchStart={onTouchStart}\r\n        onTouchEnd={onTouchEnd}\r\n        onMouseMove={showOverlay}\r\n        className={classNames({ show: isOverlayShown })}\r\n      >\r\n        <h1\r\n          id=\"title\"\r\n          onClick={goToRepo}\r\n          onTouchEnd={goToRepo}\r\n          onMouseEnter={onHover}\r\n          onMouseLeave={onHoverStop}\r\n        >\r\n          late\r\n        </h1>\r\n        <div id=\"version\">build {versionInfo.version}</div>\r\n        <div\r\n          id=\"play-pause-container\"\r\n          onMouseDown={onMouseDown}\r\n          onMouseUp={onMouseUp}\r\n          onTouchEnd={togglePlay}\r\n          onMouseEnter={onHover}\r\n          onMouseLeave={onHoverStop}\r\n        >\r\n          <div\r\n            className={classNames({\r\n              play: !wantsToPlay && !isPlaying,\r\n              pause: wantsToPlay && isPlaying\r\n            })}\r\n          />\r\n        </div>\r\n        <div className=\"navigation\">\r\n          <div\r\n            className=\"arrow-container\"\r\n            onTouchEnd={onPrev}\r\n            onMouseUp={onPrev}\r\n            onMouseEnter={onHover}\r\n            onMouseLeave={onHoverStop}\r\n          >\r\n            <svg\r\n              className=\"arrow\"\r\n              width=\"60px\"\r\n              height=\"80px\"\r\n              viewBox=\"0 0 50 80\"\r\n            >\r\n              <polyline\r\n                fill=\"none\"\r\n                stroke=\"#FFF\"\r\n                strokeWidth=\"3\"\r\n                strokeLinecap=\"round\"\r\n                strokeLinejoin=\"round\"\r\n                points=\"45.63,75.8 0.375,38.087 45.63,0.375\"\r\n              />\r\n            </svg>\r\n          </div>\r\n          <div\r\n            className=\"arrow-container\"\r\n            onTouchEnd={onNext}\r\n            onMouseUp={onNext}\r\n            onMouseEnter={onHover}\r\n            onMouseLeave={onHoverStop}\r\n          >\r\n            <svg\r\n              className=\"arrow\"\r\n              width=\"60px\"\r\n              height=\"80px\"\r\n              viewBox=\"0 0 50 80\"\r\n            >\r\n              <polyline\r\n                fill=\"none\"\r\n                stroke=\"#FFF\"\r\n                strokeWidth=\"3\"\r\n                strokeLinecap=\"round\"\r\n                strokeLinejoin=\"round\"\r\n                points=\"0.375,0.375 45.63,38.087 0.375,75.8\"\r\n              />\r\n            </svg>\r\n          </div>\r\n        </div>\r\n        <AudioControls\r\n          onHover={onHover}\r\n          onHoverStop={onHoverStop}\r\n          audioIndex={audioIndex}\r\n          prevTrack={prevTrack}\r\n          nextTrack={nextTrack}\r\n        />\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch: Dispatch) => ({\r\n  goToNextVisualization: () => dispatch(Actions.goToNextVisualization()),\r\n  goToPrevVisualization: () => dispatch(Actions.goToPrevVisualization())\r\n});\r\n\r\nexport default connect(\r\n  null,\r\n  mapDispatchToProps\r\n)(Controls);\r\n","import { ActionConstants, ActionUnionType } from './types';\r\n\r\nexport const goToNextVisualization = (): ActionUnionType => ({\r\n  type: ActionConstants.GO_TO_NEXT_VISUALIZATION\r\n});\r\n\r\nexport const goToPrevVisualization = (): ActionUnionType => ({\r\n  type: ActionConstants.GO_TO_PREV_VISUALIZATION\r\n});\r\n","import React, { useState, useRef, useEffect, useCallback } from 'react';\r\nimport Analyser from '../Analyser';\r\nimport Controls from '../Controls';\r\nimport { useStateRef } from '../../utils/hooks';\r\nimport { modulo } from '../../utils';\r\nimport { songs } from '../../songs';\r\n\r\nconst App: React.FC = () => {\r\n  const [wantsToPlay, setWantsToPlay] = useState(false);\r\n  const [isPlaying, setIsPlaying] = useState(false);\r\n  const [audioContext, setAudioContext, audioContextRef] = useStateRef<\r\n    AudioContext | undefined\r\n  >(undefined);\r\n  const [audioSource, setSource] = useState<MediaElementAudioSourceNode>();\r\n  const [audioIndex, setAudioIndex, audioIndexRef] = useStateRef(0);\r\n\r\n  const audioRef = useRef<HTMLAudioElement>(null);\r\n\r\n  const nextTrack = useCallback(() => {\r\n    const audioElement = audioRef.current!;\r\n    const nextAudioIndex = modulo(audioIndex + 1, songs.length);\r\n    audioElement.src = songs[nextAudioIndex].path;\r\n    audioElement.play();\r\n    setAudioIndex(nextAudioIndex);\r\n  }, [audioIndex, audioRef.current]);\r\n\r\n  const prevTrack = useCallback(() => {\r\n    const audioElement = audioRef.current!;\r\n    const prevAudioIndex = modulo(audioIndex - 1, songs.length);\r\n    const shouldStayOnThisTrack = audioElement.currentTime > 5;\r\n    audioElement.src =\r\n      songs[shouldStayOnThisTrack ? audioIndex : prevAudioIndex].path;\r\n    audioElement.play();\r\n    setAudioIndex(prevAudioIndex);\r\n  }, [audioIndex, audioRef.current]);\r\n\r\n  // attach audio event listeners\r\n  useEffect(() => {\r\n    const audioElement = audioRef.current!;\r\n\r\n    const onAudioPlay = () => setIsPlaying(true);\r\n    const onAudioPause = () => setIsPlaying(false);\r\n    const onAudioError = console.error;\r\n\r\n    audioElement.addEventListener('playing', onAudioPlay);\r\n    audioElement.addEventListener('pause', onAudioPause);\r\n    audioElement.addEventListener('error', onAudioError);\r\n\r\n    return () => {\r\n      audioElement.removeEventListener('playing', onAudioPlay);\r\n      audioElement.removeEventListener('pause', onAudioPause);\r\n      audioElement.removeEventListener('error', onAudioError);\r\n    };\r\n  }, []);\r\n\r\n  // next track listener on track end\r\n  useEffect(() => {\r\n    const audioElement = audioRef.current!;\r\n\r\n    audioElement.addEventListener('ended', nextTrack);\r\n    return () => audioElement.removeEventListener('ended', nextTrack);\r\n  }, [audioIndex, audioRef.current]);\r\n\r\n  const initializeAudioContext = useCallback(() => {\r\n    const audioElement = audioRef.current!;\r\n    const audioContext = new (window.AudioContext ||\r\n      (window as any).webkitAudioContext)();\r\n    const audioSource = audioContext.createMediaElementSource(audioElement);\r\n\r\n    setAudioContext(audioContext);\r\n    setSource(audioSource);\r\n  }, [audioRef.current]);\r\n\r\n  const togglePlay = useCallback(() => {\r\n    const audioElement = audioRef.current!;\r\n\r\n    if (audioElement.paused) {\r\n      setWantsToPlay(true);\r\n      audioElement.play();\r\n\r\n      if (!audioContextRef.current) {\r\n        initializeAudioContext();\r\n      }\r\n    } else {\r\n      setWantsToPlay(false);\r\n      audioElement.pause();\r\n    }\r\n  }, [audioRef.current]);\r\n\r\n  return (\r\n    <>\r\n      <audio\r\n        ref={audioRef}\r\n        id=\"audioElement\"\r\n        src={songs[0].path}\r\n        preload=\"auto\"\r\n        crossOrigin=\"anonymous\"\r\n      />\r\n\r\n      <Analyser audioContext={audioContext} audioSource={audioSource} />\r\n\r\n      <Controls\r\n        audioContext={audioContext}\r\n        wantsToPlay={wantsToPlay}\r\n        isPlaying={isPlaying}\r\n        togglePlay={togglePlay}\r\n        audioIndex={audioIndex}\r\n        prevTrack={prevTrack}\r\n        nextTrack={nextTrack}\r\n      />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default App;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { Provider } from 'react-redux';\r\nimport * as serviceWorker from './serviceWorker';\r\nimport store from './store';\r\nimport App from './components/App';\r\nimport './reset.scss';\r\nimport './index.scss';\r\n\r\nReactDOM.render(\r\n  <Provider store={store}>\r\n    <App />\r\n  </Provider>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: http://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n","export function modulo(number1: number, number2: number): number {\r\n  return ((number1 % number2) + number2) % number2;\r\n}\r\n\r\nexport function isMobileDevice(): boolean {\r\n  return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(\r\n    navigator.userAgent\r\n  );\r\n}\r\n\r\nfunction isInteger(number: number) {\r\n  return modulo(number, 1) === 0;\r\n}\r\n\r\nexport function randomNumberBetween(\r\n  min: number,\r\n  max: number,\r\n  decimalPrecision = 1\r\n) {\r\n  if (isInteger(min) && isInteger(max)) {\r\n    return min + Math.floor(Math.random() * (max - min));\r\n  }\r\n\r\n  const randomFloat = min + Math.random() * (max - min);\r\n  return Number(randomFloat.toPrecision(decimalPrecision));\r\n}\r\n\r\nexport function debounced(\r\n  fn: (...args: any[]) => any,\r\n  msToWait: number = 500,\r\n  isImmediate: boolean = false\r\n) {\r\n  let timeoutId: number | null = null;\r\n\r\n  return function(this: any, ...args: any[]): any {\r\n    const context = this;\r\n\r\n    const delayedFunction = function() {\r\n      timeoutId = null;\r\n\r\n      if (!isImmediate) {\r\n        fn.apply(context, args);\r\n      }\r\n    };\r\n\r\n    const shouldCallNow = isImmediate && timeoutId == null;\r\n\r\n    if (timeoutId != null) {\r\n      window.clearTimeout(timeoutId);\r\n    }\r\n\r\n    timeoutId = window.setTimeout(delayedFunction, msToWait);\r\n\r\n    if (shouldCallNow) {\r\n      fn.apply(context, args);\r\n    }\r\n  };\r\n}\r\n"],"sourceRoot":""}