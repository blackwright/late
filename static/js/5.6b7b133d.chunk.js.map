{"version":3,"sources":["components/Visualizer/Visualizations/VisualizationHOC.tsx","utils/colors.ts","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/get.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/superPropBase.js","components/Visualizer/Visualizations/Rain/renderer.ts","components/Visualizer/Visualizations/Rain/city/building.ts","components/Visualizer/Visualizations/Rain/city/index.ts","components/Visualizer/Visualizations/Rain/rain/index.ts","components/Visualizer/Visualizations/Rain/home/wall.ts","components/Visualizer/Visualizations/Rain/utils.ts","components/Visualizer/Visualizations/Rain/home/window.ts","components/Visualizer/Visualizations/Rain/home/dresser.ts","components/Visualizer/Visualizations/Rain/home/pictures.ts","components/Visualizer/Visualizations/Rain/home/table.ts","components/Visualizer/Visualizations/Rain/home/clock.ts","components/Visualizer/Visualizations/Rain/home/cat.ts","components/Visualizer/Visualizations/Rain/home/lamp.ts","components/Visualizer/Visualizations/Rain/home/index.ts","components/Visualizer/Visualizations/Rain/index.tsx"],"names":["__webpack_require__","d","__webpack_exports__","wrap","react__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_0___default","n","defaultProps","data","Uint8Array","lowPassData","options","WrappedComponent","_ref","arguments","length","undefined","rawIntensitiesRef","useRef","lowPassIntensitiesRef","startingTimestampRef","Date","now","totalDifferenceFromRawBaseline","totalDifferenceFromLowBaseline","renderedData","map","rawDataElement","i","Math","abs","lowPassDataElement","smoothing","sum","count","rangeIndex","rawIntensityMax","lowPassIntensitySum","lowPassIntensityCount","lowPassIntensityMax","current","forEach","rawIntensity","lowPassIntensity","currentRawIntensity","recentLowPassAvgIntensity","currentLowPassIntensity","concat","shift","isBeat","a","createElement","intensity","colorTriples","colorTriple","id","randomColorTriple","floor","random","getRandomColors","numColors","areUnique","colors","randomTriple","randomColor","includes","push","getRandomColor","getRandomColorTriple","colorCopy","Object","_Users_jerry_git_late_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__","reverse","get_get","target","property","receiver","Reflect","get","base","object","prototype","hasOwnProperty","call","getPrototypeOf","_superPropBase","desc","getOwnPropertyDescriptor","value","WINDOW_FRAME_THICKNESS_DIVISOR","Renderer","ctx","classCallCheck","this","canvasWidth","canvasHeight","oneThirdCanvasWidth","oneHalfCanvasHeight","windowFrameThickness","roundedRadius","canvas","width","height","max","save","createClass","key","restore","args","Building","blueprint","x","y","color","lights","lightHeight","randomNumberBetween","lightPadding","lightsPerFloor","buildingXPadding","buildingTopPadding","gapWidth","lightWidth","isOn","fillStyle","fillRect","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","next","done","light","err","return","City","_Renderer","_this","possibleConstructorReturn","layers","generateBuildings","inherits","_this2","_loop","layer","gap","building","leftMostBuilding","xOffset","currentLayer","generateLights","render","RAINDROPS_HEIGHTWISE","Raindrop","createdDate","timeDelta","strokeStyle","lineWidth","beginPath","moveTo","lineTo","stroke","Rainfall","raindrops","raindropHeight","raindrop","tick","splice","startingX","Wall","linearGradient","createLinearGradient","addColorStop","defaultCornerRadii","tl","tr","br","bl","roundedRect","radius","quadraticCurveTo","closePath","fill","Window","clearRect","muntinWidth","topLeftX","topRightX","topY","leftX","leftTopY","leftBottomY","rect","Dresser","wasBeat","dresserHandleMidpoint","speakerWidth","speakerHeight","speakerX","speakerY","driverRadius","min","driverCenterX","driverCenterY","arc","PI","dividerWidth","deckX","deckHeight","deckY","deckDetailX","bottomDetailY","knobRadius","knobX","knobY","clip","translate","knobMarkerAngle","knobMarkerStart","sin","cos","knobMarkerEnd","lineCap","dresser","stereo","wooferRadius","wooferCenterY","Pictures","pictures","_assertThisInitialize","assertThisInitialized","_this$pictures$","gradient1","nodes","nodeSize","point1","point2","currentNode","pop","_i","otherNode","sqrt","pow","_this$pictures$2","gradient2","randomAngle","planetX","planetY","randomRadius","_this$pictures$3","gradient3","starX","starY","graph","orbits","stars","FRUIT_COLORS","Table","thickness","tableCornerRadii","bowlCenterX","bowlWidth","bowlHeight","fruits","stemAngle","fruit","_i2","stemStart","stemEnd","bowlCornerRadii","bowlBaseHeight","bowlBaseWidth","bowlDecorationY","leg","top","centerpiece","Clock","clockSize","clockCoords","angle","start","end","hours","getHours","minutes","getMinutes","seconds","getSeconds","rotate","face","hands","Cat","isWagging","prevTailAngle","headRadius","bodyHeight","bodyWidth","createdTimestamp","tailWidth","tailY","lineJoin","rightEar","point","leftEar","head","body","tail","nextTailAngle","tailEnd","Lamp","stemX","stemHeight","lampWidth","shadeTopLeft","shadeTopRight","shadeBottomRight","shadeBottomLeft","lightAngle","deltaX","deltaY","atan2","radiansBetween","lightTriangleAdjacentWidth","tan","lightBottomLeftX","lightBottomRightX","stem","lampshade","Home","wall","window","table","clock","VisualizationHOC","cityCanvasRef","cityRef","useDebouncedResize","cityCanvas","_window","dpi","getContext","city","createCity","innerWidth","innerHeight","devicePixelRatio","rainCanvasRef","rainfallRef","rainCanvas","_window2","rainfall","createRain","homeCanvasRef","homeRef","clockIntervalRef","homeCanvas","_window3","home","clearTimeout","setInterval","createHome","catCanvasRef","catRef","catCanvas","_window4","cat","adoptCat","lampCanvasRef","lampRef","lampCanvas","_window5","lamp","createLamp","useEffect","raindropsToAdd","raindropsAdded","add","react_default","className","ref"],"mappings":"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","file":"static/js/5.6b7b133d.chunk.js","sourcesContent":["import React, { useRef } from 'react';\nimport { Options } from './index';\nimport './Visualization.scss';\n\nexport type Props = {\n  // array of frequency data with values 0-255\n  data: Uint8Array;\n  lowPassData: Uint8Array;\n  options?: Options;\n};\n\nexport type WrappedProps = {\n  data: Uint8Array;\n  lowPassData: Uint8Array;\n  isBeat: boolean;\n  intensity: number;\n  lowPassIntensity: number;\n};\n\nconst defaultProps: Props = {\n  data: new Uint8Array(),\n  lowPassData: new Uint8Array(),\n  options: {}\n};\n\n// all visualization components should be wrapped with this HOC\nexport function wrap(\n  WrappedComponent: React.ComponentType<WrappedProps>\n): React.ComponentType<Props> {\n  return function({ data, lowPassData, options }: Props = defaultProps) {\n    const rawIntensitiesRef = useRef<number[]>([]);\n    const lowPassIntensitiesRef = useRef<number[]>([]);\n    const startingTimestampRef = useRef<number>(Date.now());\n\n    let totalDifferenceFromRawBaseline = 0;\n    let totalDifferenceFromLowBaseline = 0;\n\n    const renderedData = data.map((rawDataElement, i) => {\n      totalDifferenceFromRawBaseline += Math.abs(rawDataElement - 128);\n\n      const lowPassDataElement = lowPassData[i];\n      totalDifferenceFromLowBaseline += Math.abs(lowPassDataElement - 128);\n\n      if (options == null || !options.smoothing) {\n        return rawDataElement;\n      } else {\n        // smooth out each data value using a range of values around it,\n        // the range of this window is the value of options.smoothing\n        let sum = 0;\n        let count = 0;\n\n        let rangeIndex = i - options.smoothing;\n\n        while (rangeIndex < i + options.smoothing) {\n          const rawDataAtRangeIndex = data[rangeIndex] || 128;\n          sum += rawDataAtRangeIndex;\n          count += 1;\n          rangeIndex += 1;\n        }\n\n        return sum / count;\n      }\n    });\n\n    let rawIntensityMax = 0;\n\n    let lowPassIntensitySum = 0;\n    let lowPassIntensityCount = 0;\n    let lowPassIntensityMax = 0;\n\n    rawIntensitiesRef.current.forEach((rawIntensity, i) => {\n      if (rawIntensity > rawIntensityMax) {\n        rawIntensityMax = rawIntensity;\n      }\n\n      const lowPassIntensity = lowPassIntensitiesRef.current[i];\n      lowPassIntensitySum += lowPassIntensity;\n      lowPassIntensityCount += 1;\n\n      if (lowPassIntensity > lowPassIntensityMax) {\n        lowPassIntensityMax = lowPassIntensity;\n      }\n    });\n\n    const currentRawIntensity = totalDifferenceFromRawBaseline / data.length;\n    const recentLowPassAvgIntensity =\n      lowPassIntensitySum / lowPassIntensityCount || 0;\n\n    const currentLowPassIntensity =\n      totalDifferenceFromLowBaseline / lowPassData.length;\n\n    rawIntensitiesRef.current = rawIntensitiesRef.current.concat(\n      currentRawIntensity\n    );\n    lowPassIntensitiesRef.current = lowPassIntensitiesRef.current.concat(\n      currentLowPassIntensity\n    );\n\n    // remove intensities older than 2 seconds\n    if (Date.now() - startingTimestampRef.current > 2000) {\n      rawIntensitiesRef.current.shift();\n      lowPassIntensitiesRef.current.shift();\n    }\n\n    const isBeat = currentLowPassIntensity > recentLowPassAvgIntensity * 1.5;\n\n    return (\n      <WrappedComponent\n        data={renderedData}\n        lowPassData={lowPassData}\n        isBeat={isBeat}\n        intensity={currentRawIntensity}\n        lowPassIntensity={currentLowPassIntensity}\n      />\n    );\n  };\n}\n","const colorTriples = [\n  ['#0E9AA7', '#F6CD61', '#FE8A71'],\n  ['#EE4540', '#801336', '#2D142C'],\n  ['#8FB9A8', '#FDFBD4', '#FCD0BA'],\n  ['#AC6D83', '#685D79', '#465C7A'],\n  ['#F36E38', '#EF4648', '#582841'],\n  ['#F1F1F1', '#9BD7D1', '#305D7A'],\n  ['#DEA5B6', '#F3CD8C', '#F2E9C2'],\n  ['#E27B47', '#EFCA58', '#46B29E'],\n  ['#2E7345', '#2E9975', '#2DB3B3'],\n  ['#52A3CC', '#7EA1E5', '#AAAAF2'],\n  ['#CC5285', '#CC5285', '#F2BCAA'],\n  ['#D8E0BB', '#B6CEC7', '#86A3C3']\n];\n\nconst colorTriplesWithIds = colorTriples.map((colorTriple, i) => ({\n  id: i,\n  colorTriple\n}));\n\nfunction randomColorTriple() {\n  return colorTriples[Math.floor(Math.random() * colorTriples.length)];\n}\n\nexport function getRandomColors(numColors: number, areUnique?: boolean): string[] {\n  const colors: string[] = [];\n\n  while (colors.length < numColors) {\n    const randomTriple = randomColorTriple();\n    const randomColor = randomTriple[Math.floor(Math.random() * randomTriple.length)];\n\n    if (areUnique && colors.includes(randomColor)) {\n      break;\n    }\n\n    colors.push(randomColor);\n  }\n  return colors;\n}\n\nexport function getRandomColor() {\n  return getRandomColors(1)[0];\n}\n\nexport function getRandomColorTriple() {\n  const colorCopy = [...randomColorTriple()];\n  if (Math.random() <= 0.5) {\n    return colorCopy.reverse();\n  } else {\n    return colorCopy;\n  }\n}\n","import getPrototypeOf from \"./getPrototypeOf\";\nimport superPropBase from \"./superPropBase\";\nexport default function _get(target, property, receiver) {\n  if (typeof Reflect !== \"undefined\" && Reflect.get) {\n    _get = Reflect.get;\n  } else {\n    _get = function _get(target, property, receiver) {\n      var base = superPropBase(target, property);\n      if (!base) return;\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n\n      if (desc.get) {\n        return desc.get.call(receiver);\n      }\n\n      return desc.value;\n    };\n  }\n\n  return _get(target, property, receiver || target);\n}","import getPrototypeOf from \"./getPrototypeOf\";\nexport default function _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = getPrototypeOf(object);\n    if (object === null) break;\n  }\n\n  return object;\n}","const WINDOW_FRAME_THICKNESS_DIVISOR = 50;\n\nexport abstract class Renderer {\n  protected canvasWidth: number;\n  protected canvasHeight: number;\n  protected oneThirdCanvasWidth: number;\n  protected oneHalfCanvasHeight: number;\n  protected windowFrameThickness: number;\n  protected roundedRadius: number;\n\n  constructor(protected ctx: CanvasRenderingContext2D) {\n    this.canvasWidth = ctx.canvas.width;\n    this.canvasHeight = ctx.canvas.height;\n    this.oneThirdCanvasWidth = this.canvasWidth / 3;\n    this.oneHalfCanvasHeight = this.canvasHeight / 2;\n    this.windowFrameThickness = Math.floor(\n      Math.max(this.canvasWidth, this.canvasHeight) /\n        WINDOW_FRAME_THICKNESS_DIVISOR\n    );\n    this.roundedRadius = Math.floor(this.windowFrameThickness / 3);\n    ctx.save();\n  }\n\n  // for initial paint - subclasses should call super.render()\n  render(): void {\n    this.ctx.restore();\n  }\n\n  // for animation\n  tick(args: any): void {}\n}\n","import { randomNumberBetween } from '../../../../../utils';\n\nconst LIGHT_COLOR = 'rgb(255, 255, 255)';\nconst MIN_LIGHT_HEIGHT_RATIO = 0.02;\nconst MAX_LIGHT_HEIGHT_RATIO = 0.03;\nconst MIN_LIGHTS_PER_FLOOR = 2;\nconst MAX_LIGHTS_PER_FLOOR = 6;\nconst MIN_GAP_WIDTH_RATIO = 0.01;\nconst MAX_GAP_WIDTH_RATIO = 0.05;\nconst MIN_LIGHT_PADDING_RATIO = 0.01;\nconst MAX_LIGHT_PADDING_RATIO = 0.03;\nconst MIN_BUILDING_X_PADDING_RATIO = 0.05;\nconst MAX_BUILDING_X_PADDING_RATIO = 0.1;\nconst MIN_BUILDING_TOP_PADDING_RATIO = 0.025;\nconst MAX_BUILDING_TOP_PADDING_RATIO = 0.1;\n\nexport type BuildingBlueprint = {\n  ctx: CanvasRenderingContext2D;\n  canvasHeight: number;\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n  color: string;\n};\n\ntype Light = {\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n  isOn: boolean;\n};\n\nexport class Building {\n  private ctx: CanvasRenderingContext2D;\n  private canvasHeight: number;\n\n  public x: number;\n  public y: number;\n  public width: number;\n  public height: number;\n  public color: string;\n  public lights: Light[] = [];\n\n  constructor(blueprint: BuildingBlueprint) {\n    this.ctx = blueprint.ctx;\n    this.canvasHeight = blueprint.canvasHeight;\n    this.x = blueprint.x;\n    this.y = blueprint.y;\n    this.width = blueprint.width;\n    this.height = blueprint.height;\n    this.color = blueprint.color;\n  }\n\n  // called externally so that buildings may be\n  // repositioned before light positions are determined\n  generateLights() {\n    const { canvasHeight, width, height } = this;\n\n    const lightHeight =\n      randomNumberBetween(MIN_LIGHT_HEIGHT_RATIO, MAX_LIGHT_HEIGHT_RATIO) *\n      height;\n\n    const lightPadding =\n      randomNumberBetween(MIN_LIGHT_PADDING_RATIO, MAX_LIGHT_PADDING_RATIO) *\n      height;\n\n    const lightsPerFloor = randomNumberBetween(\n      MIN_LIGHTS_PER_FLOOR,\n      MAX_LIGHTS_PER_FLOOR\n    );\n\n    const buildingXPadding =\n      randomNumberBetween(\n        MIN_BUILDING_X_PADDING_RATIO,\n        MAX_BUILDING_X_PADDING_RATIO\n      ) * width;\n\n    const buildingTopPadding =\n      randomNumberBetween(\n        MIN_BUILDING_TOP_PADDING_RATIO,\n        MAX_BUILDING_TOP_PADDING_RATIO\n      ) * height;\n\n    const gapWidth =\n      randomNumberBetween(MIN_GAP_WIDTH_RATIO, MAX_GAP_WIDTH_RATIO) * width;\n\n    const lightWidth =\n      (this.width - buildingXPadding * 2 - gapWidth * (lightsPerFloor - 1)) /\n      lightsPerFloor;\n\n    const lights: Light[] = [];\n    let x = this.x + buildingXPadding;\n    let y = this.y + buildingTopPadding;\n\n    while (y < canvasHeight * 0.98) {\n      // each iteration generates a row of lights for the floor\n      if (x >= this.x + this.width - buildingXPadding) {\n        // start a new floor\n        x = this.x + buildingXPadding;\n        y += lightHeight + lightPadding;\n      } else {\n        lights.push({\n          x,\n          y,\n          width: lightWidth,\n          height: lightHeight,\n          isOn: Math.random() > 0.4\n        });\n\n        x += lightWidth + gapWidth;\n      }\n    }\n\n    this.lights = lights;\n  }\n\n  render() {\n    const { ctx, x, y, width, height, color } = this;\n    ctx.save();\n\n    // render building\n    ctx.fillStyle = color;\n    ctx.fillRect(x, y, width, height);\n\n    // render lights\n    ctx.fillStyle = LIGHT_COLOR;\n    for (const light of this.lights) {\n      if (light.isOn) {\n        ctx.fillRect(light.x, light.y, light.width, light.height);\n      }\n    }\n\n    // garbage collect\n    this.lights = [];\n\n    ctx.restore();\n  }\n}\n","import { Renderer } from '../renderer';\nimport { Building } from './building';\nimport { randomNumberBetween } from '../../../../../utils';\nimport { getRandomColor } from '../../../../../utils/colors';\n\nconst LAYER_OVERLAY_COLOR = 'rgba(65, 35, 66, 0.6)';\n\nconst MAX_BUILDING_HEIGHT_RATIO = 0.95;\nconst MIN_BUILDING_HEIGHT_RATIO = 0.3;\nconst MIN_BUILDING_WIDTH_RATIO = 0.08;\nconst MAX_BUILDING_WIDTH_RATIO = 0.15;\nconst MIN_BUILDING_GAP_RATIO = 0.02;\nconst MAX_BUILDING_GAP_RATIO = 0.05;\nconst NUMBER_OF_LAYERS = 3;\n\nexport class City extends Renderer {\n  private layers: Building[][] = [];\n\n  constructor(ctx: CanvasRenderingContext2D) {\n    super(ctx);\n    this.generateBuildings();\n  }\n\n  generateBuildings() {\n    const { ctx, canvasWidth, canvasHeight } = this;\n\n    for (let i = 0; i < NUMBER_OF_LAYERS; i++) {\n      // buildings per layer\n      const layer: Building[] = [];\n      let x = canvasWidth / 3;\n\n      while (x < (canvasWidth * 2) / 3) {\n        const width =\n          randomNumberBetween(\n            MIN_BUILDING_WIDTH_RATIO,\n            MAX_BUILDING_WIDTH_RATIO,\n            2\n          ) * canvasWidth;\n\n        const height =\n          randomNumberBetween(\n            MIN_BUILDING_HEIGHT_RATIO,\n            MAX_BUILDING_HEIGHT_RATIO,\n            2\n          ) * canvasHeight;\n\n        const gap =\n          randomNumberBetween(MIN_BUILDING_GAP_RATIO, MAX_BUILDING_GAP_RATIO) *\n          canvasWidth;\n\n        const building = new Building({\n          y: canvasHeight - height,\n          color: getRandomColor(),\n          ctx,\n          canvasHeight,\n          x,\n          width,\n          height\n        });\n\n        layer.push(building);\n\n        x += width + gap;\n      }\n\n      // offset the buildings so the leftmost starts off screen\n      const leftMostBuilding = layer[0];\n\n      const xOffset = randomNumberBetween(\n        leftMostBuilding.width * 0.25,\n        leftMostBuilding.width * 0.75\n      );\n\n      layer.forEach(building => (building.x -= xOffset));\n      this.layers.push(layer);\n    }\n  }\n\n  render() {\n    super.render();\n\n    const { ctx, canvasWidth, canvasHeight, layers } = this;\n\n    for (let i = 0; i < layers.length; i++) {\n      const currentLayer = layers[i];\n\n      if (i === layers.length - 1) {\n        currentLayer.forEach(building => building.generateLights());\n      }\n\n      for (const building of currentLayer) {\n        building.render();\n      }\n\n      // fade each layer out a bit\n      ctx.fillStyle = LAYER_OVERLAY_COLOR;\n      ctx.fillRect(0, 0, canvasWidth, canvasHeight);\n    }\n\n    // garbage collect\n    this.layers = [];\n  }\n}\n","const TIME_TO_FALL = 300;\nconst RAINDROPS_HEIGHTWISE = 10;\nconst RAINDROP_COLOR = '#788';\n\nclass Raindrop {\n  private createdDate: number;\n  public y = 0;\n\n  constructor(\n    private ctx: CanvasRenderingContext2D,\n    private canvasHeight: number,\n    public x: number,\n    public height: number\n  ) {\n    this.createdDate = Date.now();\n  }\n\n  tick(now: number) {\n    const timeDelta = now - this.createdDate;\n    this.y = Math.floor(\n      (timeDelta / TIME_TO_FALL) * this.canvasHeight * 0.75 +\n        this.canvasHeight * 0.25\n    );\n  }\n\n  render() {\n    const { ctx, x, y, height } = this;\n\n    ctx.strokeStyle = RAINDROP_COLOR;\n    ctx.lineWidth = 1;\n\n    ctx.beginPath();\n    ctx.moveTo(x, y);\n    ctx.lineTo(x, y + height);\n    ctx.stroke();\n  }\n}\n\nexport class Rainfall {\n  private raindrops: Raindrop[] = [];\n  private raindropHeight: number;\n  public canvasWidth: number;\n  public canvasHeight: number;\n\n  constructor(private ctx: CanvasRenderingContext2D) {\n    this.canvasWidth = ctx.canvas.width;\n    this.canvasHeight = ctx.canvas.height;\n    this.raindropHeight = Math.floor(\n      (this.canvasHeight * 0.5) / RAINDROPS_HEIGHTWISE\n    );\n  }\n\n  tick() {\n    const { raindrops, canvasHeight } = this;\n\n    const now = Date.now();\n\n    for (let i = raindrops.length - 1; i >= 0; i--) {\n      const raindrop = raindrops[i];\n      raindrop.tick(now);\n\n      // remove raindrops that have fallen out of view\n      if (raindrop.y >= canvasHeight * 0.75) {\n        raindrops.splice(i, 1);\n      }\n    }\n  }\n\n  add() {\n    const { ctx, canvasWidth, canvasHeight, raindrops, raindropHeight } = this;\n\n    const startingX = Math.random() * (canvasWidth / 3 - 1) + canvasWidth / 3;\n\n    raindrops.push(new Raindrop(ctx, canvasHeight, startingX, raindropHeight));\n  }\n\n  render() {\n    this.raindrops.forEach(raindrop => raindrop.render());\n  }\n}\n","import { Renderer } from '../renderer';\n\nconst WALL_START_COLOR = '#181623';\nconst WALL_END_COLOR = '#111019';\n\nexport class Wall extends Renderer {\n  constructor(ctx: CanvasRenderingContext2D) {\n    super(ctx);\n  }\n\n  render() {\n    super.render();\n\n    const { ctx, canvasWidth, canvasHeight } = this;\n\n    const linearGradient = this.ctx.createLinearGradient(0, 0, 0, canvasHeight);\n    linearGradient.addColorStop(0, WALL_START_COLOR);\n    linearGradient.addColorStop(1, WALL_END_COLOR);\n    ctx.fillStyle = linearGradient;\n    ctx.fillRect(0, 0, canvasWidth, canvasHeight);\n  }\n}\n","export type CornerRadii = {\n  tl: number;\n  tr: number;\n  br: number;\n  bl: number;\n};\n\nconst defaultCornerRadii = {\n  tl: 0,\n  tr: 0,\n  br: 0,\n  bl: 0\n};\n\nexport function roundedRect(\n  ctx: CanvasRenderingContext2D,\n  x: number,\n  y: number,\n  width: number,\n  height: number,\n  radius: CornerRadii = defaultCornerRadii,\n  stroke = false\n) {\n  ctx.beginPath();\n\n  ctx.moveTo(x + radius.tl, y);\n  ctx.lineTo(x + width - radius.tr, y);\n  ctx.quadraticCurveTo(x + width, y, x + width, y + radius.tr);\n\n  ctx.lineTo(x + width, y + height - radius.br);\n  ctx.quadraticCurveTo(\n    x + width,\n    y + height,\n    x + width - radius.br,\n    y + height\n  );\n\n  ctx.lineTo(x + radius.bl, y + height);\n  ctx.quadraticCurveTo(x, y + height, x, y + height - radius.bl);\n\n  ctx.lineTo(x, y + radius.tl);\n  ctx.quadraticCurveTo(x, y, x + radius.tl, y);\n\n  ctx.closePath();\n  ctx.fill();\n  stroke && ctx.stroke();\n}\n\nexport function distanceBetween(\n  point1: { x: number; y: number },\n  point2: { x: number; y: number }\n) {\n  return Math.sqrt(\n    Math.pow(point2.x - point1.x, 2) + Math.pow(point2.y - point1.y, 2)\n  );\n}\n\n// where 0 degrees corresponds to positive direction of x-axis\nexport function radiansBetween(\n  point1: { x: number; y: number },\n  point2: { x: number; y: number }\n) {\n  const deltaX = point2.x - point1.x;\n  const deltaY = point2.y - point1.y;\n  return Math.atan2(deltaY, deltaX);\n}\n","import { Renderer } from '../renderer';\nimport { roundedRect, CornerRadii } from '../utils';\n\nconst WINDOW_FRAME_COLOR = '#3D1A1E';\nconst WINDOW_DECORATION_COLOR = '#682634';\n\nexport class Window extends Renderer {\n  constructor(ctx: CanvasRenderingContext2D) {\n    super(ctx);\n  }\n\n  render() {\n    super.render();\n\n    const {\n      ctx,\n      oneThirdCanvasWidth,\n      oneHalfCanvasHeight,\n      windowFrameThickness\n    } = this;\n\n    ctx.fillStyle = WINDOW_FRAME_COLOR;\n\n    // window trim\n    ctx.fillRect(\n      oneThirdCanvasWidth - windowFrameThickness,\n      oneHalfCanvasHeight / 2 - windowFrameThickness,\n      oneThirdCanvasWidth + windowFrameThickness * 2,\n      oneHalfCanvasHeight + windowFrameThickness * 2\n    );\n\n    // make a hole\n    ctx.clearRect(\n      oneThirdCanvasWidth,\n      oneHalfCanvasHeight / 2,\n      oneThirdCanvasWidth,\n      oneHalfCanvasHeight\n    );\n\n    // window muntin\n    const muntinWidth = Math.floor(windowFrameThickness / 2);\n\n    const topLeftX = (oneThirdCanvasWidth * 4) / 3 - (muntinWidth * 2) / 3;\n    const topRightX = (oneThirdCanvasWidth * 5) / 3 - muntinWidth / 3;\n    const topY = oneHalfCanvasHeight / 2 - windowFrameThickness;\n\n    const leftX = oneThirdCanvasWidth - windowFrameThickness;\n    const leftTopY = (oneHalfCanvasHeight * 5) / 6 - (muntinWidth * 2) / 3;\n    const leftBottomY = (oneHalfCanvasHeight * 7) / 6 - muntinWidth / 3;\n\n    ctx.fillRect(\n      topLeftX,\n      topY,\n      muntinWidth,\n      oneHalfCanvasHeight + windowFrameThickness * 2\n    );\n\n    ctx.fillRect(\n      topRightX,\n      topY,\n      muntinWidth,\n      oneHalfCanvasHeight + windowFrameThickness * 2\n    );\n\n    ctx.fillRect(\n      leftX,\n      leftTopY,\n      oneThirdCanvasWidth + windowFrameThickness * 2,\n      muntinWidth\n    );\n\n    ctx.fillRect(\n      leftX,\n      leftBottomY,\n      oneThirdCanvasWidth + windowFrameThickness * 2,\n      muntinWidth\n    );\n\n    ctx.fillStyle = WINDOW_DECORATION_COLOR;\n\n    // window head\n    ctx.fillRect(\n      oneThirdCanvasWidth - windowFrameThickness * 2,\n      oneHalfCanvasHeight / 2 - windowFrameThickness * 2,\n      oneThirdCanvasWidth + windowFrameThickness * 4,\n      windowFrameThickness - 1\n    );\n\n    // window stool\n    const windowSillCornerRadii: CornerRadii = {\n      tl: 0,\n      tr: 0,\n      bl: this.roundedRadius,\n      br: this.roundedRadius\n    };\n\n    roundedRect(\n      ctx,\n      oneThirdCanvasWidth - windowFrameThickness * 2,\n      (oneHalfCanvasHeight * 3) / 2 + windowFrameThickness + 1,\n      oneThirdCanvasWidth + windowFrameThickness * 4,\n      windowFrameThickness,\n      windowSillCornerRadii\n    );\n\n    // trim decoration\n    ctx.lineWidth = 2;\n    ctx.strokeStyle = WINDOW_DECORATION_COLOR;\n    ctx.rect(\n      oneThirdCanvasWidth - (windowFrameThickness * 2) / 3,\n      oneHalfCanvasHeight / 2 - (windowFrameThickness * 2) / 3,\n      oneThirdCanvasWidth + (windowFrameThickness * 4) / 3,\n      oneHalfCanvasHeight + (windowFrameThickness * 4) / 3\n    );\n    ctx.stroke();\n\n    ctx.rect(\n      oneThirdCanvasWidth - (windowFrameThickness * 5) / 9,\n      oneHalfCanvasHeight / 2 - (windowFrameThickness * 5) / 9,\n      oneThirdCanvasWidth + (windowFrameThickness * 10) / 9,\n      oneHalfCanvasHeight + (windowFrameThickness * 10) / 9\n    );\n    ctx.stroke();\n  }\n}\n","import { Renderer } from '../renderer';\n\nconst WOOD_COLOR = '#122C2B';\nconst WOOD_DECORATION_COLOR = '#091c1b';\nconst STEREO_COLOR = '#222';\nconst STEREO_DETAIL_COLOR = '#444';\nconst STEREO_DARK_COLOR = '#111';\n\nexport class Dresser extends Renderer {\n  public wasBeat?: boolean;\n\n  constructor(ctx: CanvasRenderingContext2D) {\n    super(ctx);\n  }\n\n  dresser() {\n    const { ctx, canvasWidth, canvasHeight, windowFrameThickness } = this;\n\n    const x = (canvasWidth * 2) / 3 + windowFrameThickness * 5;\n    const y = (canvasHeight * 2) / 3;\n\n    // dresser body\n    ctx.fillStyle = WOOD_COLOR;\n    ctx.fillRect(x, y, canvasWidth, canvasHeight);\n\n    // dresser detail rectangle\n    ctx.strokeStyle = WOOD_DECORATION_COLOR;\n    ctx.lineWidth = 3;\n    ctx.beginPath();\n    ctx.rect(\n      x + windowFrameThickness,\n      y + windowFrameThickness,\n      canvasWidth,\n      canvasHeight\n    );\n    ctx.stroke();\n\n    // dresser top handle\n    const dresserWidth = canvasWidth - (x + windowFrameThickness);\n    const dresserHandleMidpoint =\n      x + windowFrameThickness + (dresserWidth * 3) / 5;\n\n    ctx.beginPath();\n    ctx.moveTo(dresserHandleMidpoint, y + windowFrameThickness * 2.5);\n    ctx.lineTo(canvasWidth, y + windowFrameThickness * 2.5);\n    ctx.lineWidth = (windowFrameThickness * 2) / 3;\n    ctx.stroke();\n\n    // dresser horizontal detail line\n    ctx.beginPath();\n    ctx.moveTo(x + windowFrameThickness, y + windowFrameThickness * 6);\n    ctx.lineTo(canvasWidth, y + windowFrameThickness * 6);\n    ctx.lineWidth = 2;\n    ctx.stroke();\n\n    // dresser bottom handle\n    ctx.beginPath();\n    ctx.moveTo(dresserHandleMidpoint, y + windowFrameThickness * 7.5);\n    ctx.lineTo(canvasWidth, y + windowFrameThickness * 7.5);\n    ctx.lineWidth = (windowFrameThickness * 2) / 3;\n    ctx.stroke();\n  }\n\n  stereo() {\n    const { ctx, canvasWidth, canvasHeight, windowFrameThickness } = this;\n\n    const dresserX = (canvasWidth * 2) / 3 + windowFrameThickness * 5;\n    const dresserY = (canvasHeight * 2) / 3;\n\n    // speaker body\n    const speakerWidth = windowFrameThickness * 3.5;\n    const speakerHeight = canvasHeight * 0.2;\n    const speakerX = dresserX + windowFrameThickness * 4;\n    const speakerY = dresserY - speakerHeight;\n\n    ctx.fillStyle = STEREO_COLOR;\n    ctx.fillRect(speakerX, speakerY, speakerWidth, speakerHeight);\n\n    // mid driver\n    const driverRadius = Math.min(speakerWidth, speakerHeight) / 8;\n    const driverCenterX = speakerX + speakerWidth / 2;\n    const driverCenterY = speakerY + driverRadius * 2;\n\n    ctx.fillStyle = STEREO_DARK_COLOR;\n    ctx.beginPath();\n    ctx.arc(driverCenterX, driverCenterY, driverRadius, 0, Math.PI * 2);\n    ctx.fill();\n\n    // dividers\n    const dividerWidth = windowFrameThickness / 10;\n    ctx.fillStyle = STEREO_DARK_COLOR;\n\n    ctx.fillRect(\n      speakerX - dividerWidth,\n      speakerY,\n      dividerWidth,\n      speakerHeight\n    );\n\n    ctx.fillRect(\n      speakerX + speakerWidth,\n      speakerY,\n      dividerWidth,\n      speakerHeight\n    );\n\n    // deck\n    const deckX = speakerX + speakerWidth + dividerWidth;\n    const deckHeight = speakerHeight * 0.8;\n    const deckY = speakerY + speakerHeight - deckHeight;\n\n    ctx.fillStyle = STEREO_COLOR;\n    ctx.fillRect(deckX, deckY, canvasWidth, deckHeight);\n\n    const deckDetailX = deckX + windowFrameThickness / 2;\n\n    ctx.fillStyle = STEREO_DETAIL_COLOR;\n    ctx.strokeStyle = STEREO_DARK_COLOR;\n    ctx.lineWidth = windowFrameThickness / 8;\n    ctx.beginPath();\n    ctx.rect(\n      deckDetailX,\n      deckY + windowFrameThickness * 1.5,\n      canvasWidth,\n      deckHeight * 0.25\n    );\n    ctx.fill();\n    ctx.stroke();\n\n    ctx.fillStyle = STEREO_DARK_COLOR;\n    ctx.fillRect(\n      deckDetailX,\n      deckY + windowFrameThickness,\n      canvasWidth,\n      windowFrameThickness / 4\n    );\n\n    const bottomDetailY = deckY + deckHeight - windowFrameThickness * 0.8;\n    ctx.fillRect(\n      deckX + windowFrameThickness * 2,\n      bottomDetailY,\n      canvasWidth,\n      windowFrameThickness / 4\n    );\n\n    ctx.fillStyle = STEREO_DETAIL_COLOR;\n    const knobRadius = windowFrameThickness / 2;\n    const knobX = deckX + windowFrameThickness;\n    const knobY = bottomDetailY + windowFrameThickness / 8;\n    ctx.beginPath();\n    ctx.arc(knobX, knobY, knobRadius, 0, Math.PI * 2);\n    ctx.fill();\n    ctx.clip();\n    ctx.save();\n\n    ctx.translate(knobX, knobY);\n    const knobMarkerAngle = Math.PI * 0.75;\n    const knobMarkerStart = {\n      x: Math.sin(knobMarkerAngle) * (knobRadius - windowFrameThickness / 4),\n      y: Math.cos(knobMarkerAngle) * (knobRadius - windowFrameThickness / 4)\n    };\n    const knobMarkerEnd = {\n      x: Math.sin(knobMarkerAngle) * knobRadius * 2,\n      y: Math.cos(knobMarkerAngle) * knobRadius * 2\n    };\n    ctx.lineWidth = windowFrameThickness / 8;\n    ctx.lineCap = 'round';\n    ctx.beginPath();\n    ctx.moveTo(knobMarkerStart.x, knobMarkerStart.y);\n    ctx.lineTo(knobMarkerEnd.x, knobMarkerEnd.y);\n    ctx.stroke();\n    ctx.restore();\n\n    ctx.restore();\n  }\n\n  render() {\n    super.render();\n\n    this.dresser();\n    this.stereo();\n    this.tick();\n  }\n\n  tick(isBeat = false) {\n    if (this.wasBeat === isBeat) {\n      return;\n    }\n\n    this.wasBeat = isBeat;\n\n    const { ctx, canvasWidth, canvasHeight, windowFrameThickness } = this;\n\n    const dresserX = (canvasWidth * 2) / 3 + windowFrameThickness * 5;\n    const dresserY = (canvasHeight * 2) / 3;\n\n    // speaker body\n    const speakerWidth = windowFrameThickness * 3.5;\n    const speakerHeight = canvasHeight * 0.2;\n    const speakerX = dresserX + windowFrameThickness * 4;\n    const speakerY = dresserY - speakerHeight;\n\n    // mid driver\n    const driverRadius = Math.min(speakerWidth, speakerHeight) / 8;\n    const driverCenterX = speakerX + speakerWidth / 2;\n\n    // speaker woofer\n    const wooferRadius = Math.min(speakerWidth, speakerHeight) / 2.5;\n    const wooferCenterY = Math.max(\n      speakerY + wooferRadius + driverRadius * 4,\n      speakerY + speakerHeight - (wooferRadius + driverRadius * 2)\n    );\n\n    ctx.strokeStyle = STEREO_DETAIL_COLOR;\n    ctx.fillStyle = STEREO_COLOR;\n    ctx.lineWidth = windowFrameThickness / 8;\n    ctx.beginPath();\n    ctx.arc(driverCenterX, wooferCenterY, wooferRadius, 0, Math.PI * 2);\n    ctx.fill();\n    ctx.stroke();\n\n    ctx.fillStyle = STEREO_DARK_COLOR;\n    ctx.beginPath();\n    ctx.arc(\n      driverCenterX,\n      wooferCenterY,\n      isBeat ? wooferRadius * 0.63 : wooferRadius * 0.6,\n      0,\n      Math.PI * 2\n    );\n    ctx.fill();\n  }\n}\n","import { Renderer } from '../renderer';\nimport { distanceBetween } from '../utils';\n\nconst WOOD_COLOR = '#122C2B';\nconst PICUTRE_NODE_COUNT = 10;\nconst PICTURE_STAR_COUNT = 30;\n\ntype Picture = {\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n};\n\nexport class Pictures extends Renderer {\n  pictures: Picture[] = [];\n\n  constructor(ctx: CanvasRenderingContext2D) {\n    super(ctx);\n\n    const { oneThirdCanvasWidth, windowFrameThickness } = this;\n\n    // X & Y coords and dimensions for each picture\n    this.pictures.push({\n      x: (oneThirdCanvasWidth * 3) / 4 - windowFrameThickness * 4,\n      y: -windowFrameThickness,\n      width: windowFrameThickness * 4,\n      height: windowFrameThickness * 5\n    });\n\n    this.pictures.push({\n      x: this.pictures[0].x - windowFrameThickness * 7,\n      y: windowFrameThickness * 2,\n      width: windowFrameThickness * 5,\n      height: windowFrameThickness * 4\n    });\n\n    this.pictures.push({\n      x: this.pictures[1].x + windowFrameThickness * 2,\n      y:\n        this.pictures[1].y +\n        this.pictures[1].height +\n        windowFrameThickness * 1.5,\n      width: windowFrameThickness * 6,\n      height: windowFrameThickness * 8\n    });\n  }\n\n  graph() {\n    const { ctx, windowFrameThickness } = this;\n    const { x, y, width, height } = this.pictures[0];\n\n    ctx.save();\n    ctx.beginPath();\n    ctx.rect(x, y, width, height);\n    ctx.clip();\n\n    const gradient1 = ctx.createLinearGradient(x, y, x, y + height);\n    gradient1.addColorStop(0, '#24131f');\n    gradient1.addColorStop(1, '#051b1f');\n    ctx.fillStyle = gradient1;\n    ctx.fill();\n\n    const nodes: Array<{ x: number; y: number }> = [];\n    const nodeSize = windowFrameThickness / 6;\n\n    for (let i = 0; i < PICUTRE_NODE_COUNT; i++) {\n      nodes.push({\n        x: Math.floor(Math.random() * width + x),\n        y: Math.floor(Math.random() * height + y)\n      });\n    }\n\n    const nodeColor = '#703c3a';\n    ctx.fillStyle = nodeColor;\n    ctx.strokeStyle = nodeColor;\n    ctx.lineWidth = 1;\n\n    while (nodes.length) {\n      const currentNode = nodes.pop()!;\n      ctx.beginPath();\n      ctx.arc(currentNode.x, currentNode.y, nodeSize / 2, 0, Math.PI * 2);\n      ctx.fill();\n\n      for (const otherNode of nodes) {\n        if (distanceBetween(currentNode, otherNode) < height / 4) {\n          ctx.beginPath();\n          ctx.moveTo(currentNode.x, currentNode.y);\n          ctx.lineTo(otherNode.x, otherNode.y);\n          ctx.stroke();\n        }\n      }\n    }\n\n    ctx.strokeStyle = WOOD_COLOR;\n    ctx.lineWidth = windowFrameThickness / 1.5;\n    ctx.beginPath();\n    ctx.rect(x, y, width, height);\n    ctx.stroke();\n\n    ctx.restore();\n  }\n\n  orbits() {\n    const { ctx, windowFrameThickness } = this;\n    const { x, y, width, height } = this.pictures[1];\n\n    ctx.save();\n\n    ctx.beginPath();\n    ctx.rect(x, y, width, height);\n    ctx.clip();\n\n    const gradient2 = ctx.createLinearGradient(x, y, x, y + height);\n    gradient2.addColorStop(0, '#556e53');\n    gradient2.addColorStop(1, '#29435c');\n    ctx.fillStyle = gradient2;\n    ctx.fill();\n\n    // sun\n    const color = '#879591';\n    ctx.fillStyle = color;\n    ctx.strokeStyle = color;\n    ctx.beginPath();\n    ctx.arc(x + width / 2, y + height / 2, height / 14, 0, Math.PI * 2);\n    ctx.fill();\n\n    // orbits\n    for (\n      let radius = Math.floor(height / 6);\n      radius <= height / 2;\n      radius += windowFrameThickness / 4\n    ) {\n      ctx.beginPath();\n      ctx.arc(x + width / 2, y + height / 2, radius, 0, Math.PI * 2);\n      ctx.stroke();\n\n      const randomAngle = Math.random() * Math.PI * 2;\n      const planetX = x + width / 2 + Math.cos(randomAngle) * radius;\n      const planetY = y + height / 2 + Math.sin(randomAngle) * radius;\n      const randomRadius = Math.random() * (width / 64) + width / 192;\n      ctx.beginPath();\n      ctx.arc(planetX, planetY, randomRadius, 0, Math.PI * 2);\n      ctx.fill();\n    }\n\n    ctx.strokeStyle = '#152a38';\n    ctx.lineWidth = windowFrameThickness / 1.2;\n    ctx.beginPath();\n    ctx.rect(x, y, width, height);\n    ctx.stroke();\n\n    ctx.restore();\n  }\n\n  stars() {\n    const { ctx, windowFrameThickness } = this;\n    const { x, y, width, height } = this.pictures[2];\n\n    ctx.save();\n\n    // background\n    ctx.beginPath();\n    ctx.rect(x, y, width, height);\n    ctx.clip();\n\n    const gradient3 = ctx.createLinearGradient(x, y, x, y + height);\n    gradient3.addColorStop(0, '#09325E');\n    gradient3.addColorStop(0.75, '#2A2A47');\n    ctx.fillStyle = gradient3;\n    ctx.fill();\n\n    // sky\n    ctx.fillStyle = '#F5E7F8';\n\n    for (let i = 0; i < PICTURE_STAR_COUNT; i++) {\n      const starX = Math.floor(Math.random() * width + x);\n      const starY = Math.floor(Math.random() * height + y);\n      const radius = Math.floor(Math.random() * 2 + 1);\n      ctx.beginPath();\n      ctx.arc(starX, starY, radius, 0, Math.PI * 2);\n      ctx.fill();\n    }\n\n    ctx.strokeStyle = '#0D0B21';\n    ctx.lineWidth = windowFrameThickness / 1.5;\n    ctx.beginPath();\n    ctx.rect(x, y, width, height);\n    ctx.stroke();\n\n    ctx.restore();\n  }\n\n  render() {\n    super.render();\n\n    this.graph();\n    this.orbits();\n    this.stars();\n\n    this.pictures = [];\n  }\n}\n","import { Renderer } from '../renderer';\nimport { roundedRect, CornerRadii } from '../utils';\n\nconst WOOD_COLOR = '#122C2B';\nconst TABLE_DECORATION_COLOR = '#06151A';\nconst BOWL_COLOR = '#3e3e3e';\nconst BOWL_BASE_COLOR = '#1e1e1e';\nconst FRUIT_COLORS = ['#564837', '#713C3A'];\nconst FRUIT_STEM_COLOR = '#04070F';\n\nexport class Table extends Renderer {\n  y: number;\n\n  constructor(ctx: CanvasRenderingContext2D) {\n    super(ctx);\n\n    this.y = this.canvasHeight * 0.7;\n  }\n\n  top() {\n    const {\n      ctx,\n      y,\n      windowFrameThickness,\n      oneThirdCanvasWidth,\n      roundedRadius\n    } = this;\n\n    const width = oneThirdCanvasWidth * 0.7;\n    const thickness = windowFrameThickness * 1.35;\n\n    const tableCornerRadii: CornerRadii = {\n      tl: 0,\n      tr: roundedRadius,\n      br: 0,\n      bl: 0\n    };\n\n    ctx.fillStyle = WOOD_COLOR;\n    roundedRect(ctx, 0, y, width, thickness, tableCornerRadii);\n\n    ctx.fillStyle = TABLE_DECORATION_COLOR;\n    ctx.beginPath();\n    ctx.rect(\n      0,\n      y + thickness - windowFrameThickness / 4,\n      width,\n      windowFrameThickness / 4\n    );\n    ctx.fill();\n  }\n\n  leg() {\n    const {\n      ctx,\n      y,\n      windowFrameThickness,\n      canvasHeight,\n      oneThirdCanvasWidth\n    } = this;\n\n    ctx.strokeStyle = WOOD_COLOR;\n    ctx.lineWidth = windowFrameThickness * 1.5;\n    ctx.beginPath();\n    ctx.moveTo(oneThirdCanvasWidth * 0.5, y);\n    ctx.lineTo(oneThirdCanvasWidth * 0.5, canvasHeight);\n    ctx.stroke();\n  }\n\n  centerpiece() {\n    const {\n      ctx,\n      y,\n      windowFrameThickness,\n      canvasWidth,\n      oneThirdCanvasWidth\n    } = this;\n\n    const bowlCenterX = oneThirdCanvasWidth * 0.25;\n    const bowlWidth = oneThirdCanvasWidth * 0.3;\n    const bowlHeight = windowFrameThickness * 2;\n\n    // fruit\n    const fruits = [\n      {\n        xOffset: (bowlWidth - bowlWidth * 0.4) / 4,\n        y: y - bowlHeight,\n        radius: bowlWidth * 0.2,\n        color: FRUIT_COLORS[0],\n        stemAngle: Math.PI * 0.9\n      },\n      {\n        xOffset: -(bowlWidth - bowlWidth * 0.4) / 4,\n        y: y - bowlHeight + bowlHeight / 8,\n        radius: bowlWidth * 0.2,\n        color: FRUIT_COLORS[1],\n        stemAngle: Math.PI * 1.1\n      }\n    ];\n\n    for (const fruit of fruits) {\n      ctx.fillStyle = fruit.color;\n      ctx.beginPath();\n      ctx.arc(\n        bowlCenterX + fruit.xOffset,\n        fruit.y,\n        fruit.radius,\n        0,\n        Math.PI * 2\n      );\n      ctx.fill();\n    }\n\n    ctx.strokeStyle = FRUIT_STEM_COLOR;\n    ctx.lineCap = 'round';\n    ctx.lineWidth = 2;\n\n    for (const fruit of fruits) {\n      ctx.save();\n      ctx.translate(bowlCenterX + fruit.xOffset, fruit.y);\n      const stemStart = {\n        x: Math.sin(fruit.stemAngle) * fruits[1].radius * 0.9,\n        y: Math.cos(fruit.stemAngle) * fruits[1].radius * 0.9\n      };\n      const stemEnd = {\n        x: Math.sin(fruit.stemAngle) * fruits[1].radius * 1.1,\n        y: Math.cos(fruit.stemAngle) * fruits[1].radius * 1.1\n      };\n      ctx.beginPath();\n      ctx.moveTo(stemStart.x, stemStart.y);\n      ctx.lineTo(stemEnd.x, stemEnd.y);\n      ctx.stroke();\n      ctx.restore();\n    }\n\n    // bowl\n    const bowlCornerRadii: CornerRadii = {\n      tl: 0,\n      tr: 0,\n      br: oneThirdCanvasWidth * 0.1,\n      bl: oneThirdCanvasWidth * 0.1\n    };\n\n    const bowlBaseHeight = bowlHeight / 8;\n    const bowlBaseWidth = bowlWidth * 0.5;\n\n    ctx.fillStyle = BOWL_BASE_COLOR;\n    ctx.fillRect(\n      bowlCenterX - bowlBaseWidth / 2,\n      y - bowlHeight - bowlBaseHeight,\n      bowlBaseWidth,\n      bowlHeight + bowlBaseHeight\n    );\n\n    ctx.fillStyle = BOWL_COLOR;\n    roundedRect(\n      ctx,\n      bowlCenterX - bowlWidth / 2,\n      y - bowlHeight - bowlBaseHeight,\n      bowlWidth,\n      bowlHeight,\n      bowlCornerRadii\n    );\n\n    ctx.save();\n    ctx.clip();\n    ctx.lineWidth = 2;\n    ctx.strokeStyle = TABLE_DECORATION_COLOR;\n    const bowlDecorationY = y - bowlHeight - bowlBaseHeight + bowlHeight / 6;\n    ctx.beginPath();\n    ctx.moveTo(0, bowlDecorationY);\n    ctx.lineTo(canvasWidth, bowlDecorationY);\n    ctx.stroke();\n    ctx.restore();\n  }\n\n  render() {\n    super.render();\n\n    this.leg();\n    this.top();\n    this.centerpiece();\n  }\n}\n","import { Renderer } from '../renderer';\n\nconst WOOD_COLOR = '#122C2B';\nconst CLOCK_INNER_COLOR = '#4B4721';\nconst CLOCK_HANDS_COLOR = '#192124';\nconst CLOCK_DECORATION_COLOR = '#06151A';\n\nexport class Clock extends Renderer {\n  private clockSize: number;\n  private clockCoords: { x: number; y: number };\n\n  constructor(ctx: CanvasRenderingContext2D) {\n    super(ctx);\n    this.clockSize = this.windowFrameThickness * 5;\n    const x = Math.max(\n      this.canvasWidth * 0.7,\n      (this.canvasWidth * 2) / 3 + this.windowFrameThickness * 8\n    );\n    const y = this.canvasHeight / 5;\n    this.clockCoords = { x, y };\n  }\n\n  face() {\n    const { ctx, clockSize, clockCoords } = this;\n    const { x, y } = clockCoords;\n\n    ctx.strokeStyle = WOOD_COLOR;\n\n    // clock frame\n    ctx.lineWidth = this.windowFrameThickness / 2;\n    ctx.beginPath();\n    ctx.arc(x, y, clockSize / 1.75, 0, Math.PI * 2, true);\n    ctx.stroke();\n\n    ctx.strokeStyle = CLOCK_DECORATION_COLOR;\n    ctx.beginPath();\n    ctx.arc(x, y, clockSize / 2, 0, Math.PI * 2, true);\n    ctx.stroke();\n\n    ctx.beginPath();\n    ctx.arc(x, y, clockSize / 2, 0, Math.PI * 2, true);\n    ctx.fillStyle = CLOCK_INNER_COLOR;\n    ctx.fill();\n\n    // markings\n    ctx.lineWidth = 2;\n    ctx.strokeStyle = CLOCK_HANDS_COLOR;\n\n    ctx.save();\n    ctx.translate(x, y);\n\n    for (let i = 1; i <= 60; i++) {\n      const angle = (i * Math.PI) / 30;\n\n      const start = {\n        x: Math.sin(angle) * (clockSize / 2 - clockSize / 20),\n        y: Math.cos(angle) * (clockSize / 2 - clockSize / 20)\n      };\n      const end = {\n        x: Math.sin(angle) * (clockSize / 2 - clockSize / 15),\n        y: Math.cos(angle) * (clockSize / 2 - clockSize / 15)\n      };\n\n      ctx.beginPath();\n      ctx.moveTo(start.x, start.y);\n      ctx.lineTo(end.x, end.y);\n      ctx.stroke();\n    }\n\n    ctx.restore();\n  }\n\n  hands() {\n    const { ctx, clockSize, clockCoords } = this;\n    const { x, y } = clockCoords;\n\n    // fill in hands area so we can redraw them\n    ctx.beginPath();\n    ctx.arc(x, y, clockSize / 2 - clockSize / 15, 0, Math.PI * 2, true);\n    ctx.fillStyle = CLOCK_INNER_COLOR;\n    ctx.fill();\n\n    ctx.lineWidth = clockSize / 40;\n    ctx.lineCap = 'round';\n    ctx.strokeStyle = CLOCK_HANDS_COLOR;\n\n    ctx.save();\n    ctx.translate(x, y);\n\n    const now = new Date();\n    const hours = now.getHours();\n    const minutes = now.getMinutes();\n    const seconds = now.getSeconds();\n\n    // hour hand\n    ctx.save();\n    ctx.rotate((Math.PI / 6) * (hours + minutes / 60 + seconds / 3600));\n    ctx.beginPath();\n    ctx.moveTo(0, 10);\n    ctx.lineTo(0, -clockSize / 4);\n    ctx.stroke();\n    ctx.restore();\n\n    // minute hand\n    ctx.save();\n    ctx.rotate((Math.PI / 30) * (minutes + seconds / 60));\n    ctx.beginPath();\n    ctx.moveTo(0, 10);\n    ctx.lineTo(0, -clockSize / 2.75);\n    ctx.stroke();\n    ctx.restore();\n\n    // second hand\n    ctx.lineWidth = clockSize / 100;\n    ctx.save();\n    ctx.rotate((Math.PI / 30) * seconds);\n    ctx.beginPath();\n    ctx.moveTo(0, 10);\n    ctx.lineTo(0, -clockSize / 2.7);\n    ctx.stroke();\n    ctx.restore();\n\n    ctx.restore();\n  }\n\n  render() {\n    super.render();\n    this.face();\n    this.hands();\n  }\n\n  tick() {\n    this.hands();\n  }\n}\n","import { Renderer } from '../renderer';\n\nconst CAT_COLOR = '#000';\n\nexport class Cat extends Renderer {\n  private isWagging = false;\n  private prevTailAngle = -Math.PI / 2;\n  private headRadius: number;\n  private bodyHeight: number;\n  private bodyWidth: number;\n  private x: number;\n  private createdTimestamp: number;\n  private tailWidth: number;\n  private tailY: number;\n\n  constructor(ctx: CanvasRenderingContext2D) {\n    super(ctx);\n\n    const {\n      windowFrameThickness,\n      oneThirdCanvasWidth,\n      oneHalfCanvasHeight\n    } = this;\n\n    this.x = oneThirdCanvasWidth * 2 - windowFrameThickness * 1.2;\n    this.headRadius = windowFrameThickness;\n    this.bodyHeight = windowFrameThickness * 3;\n    this.bodyWidth = windowFrameThickness * 2.2;\n    this.createdTimestamp = Date.now();\n    this.tailWidth = windowFrameThickness / 2;\n    this.tailY =\n      (oneHalfCanvasHeight * 3) / 2 + windowFrameThickness - this.tailWidth / 2;\n  }\n\n  head() {\n    const { ctx, oneHalfCanvasHeight, x, headRadius } = this;\n    const y = (oneHalfCanvasHeight * 3) / 2 - this.bodyHeight - this.headRadius;\n\n    ctx.fillStyle = CAT_COLOR;\n    ctx.strokeStyle = CAT_COLOR;\n    ctx.beginPath();\n    ctx.arc(x, y, headRadius, 0, Math.PI * 2);\n    ctx.fill();\n\n    // ears\n    ctx.save();\n    ctx.translate(x, y);\n\n    ctx.lineWidth = 5;\n    ctx.lineJoin = 'round';\n\n    const rightEar = {\n      start: {\n        x: Math.sin(Math.PI * 0.85) * headRadius,\n        y: Math.cos(Math.PI * 0.85) * headRadius\n      },\n      point: {\n        x: Math.sin(Math.PI * 0.8) * headRadius * 1.4,\n        y: Math.cos(Math.PI * 0.8) * headRadius * 1.4\n      },\n      end: {\n        x: Math.sin(Math.PI * 0.7) * headRadius,\n        y: Math.cos(Math.PI * 0.7) * headRadius\n      }\n    };\n\n    ctx.beginPath();\n    ctx.moveTo(rightEar.start.x, rightEar.start.y);\n    ctx.lineTo(rightEar.point.x, rightEar.point.y);\n    ctx.lineTo(rightEar.end.x, rightEar.end.y);\n    ctx.closePath();\n    ctx.fill();\n    ctx.stroke();\n\n    const leftEar = {\n      start: {\n        x: Math.sin(Math.PI * 1.2) * headRadius,\n        y: Math.cos(Math.PI * 1.2) * headRadius\n      },\n      point: {\n        x: Math.sin(Math.PI * 1.22) * headRadius * 1.5,\n        y: Math.cos(Math.PI * 1.22) * headRadius * 1.5\n      },\n      end: {\n        x: Math.sin(Math.PI * 1.3) * headRadius,\n        y: Math.cos(Math.PI * 1.3) * headRadius\n      }\n    };\n\n    ctx.beginPath();\n    ctx.moveTo(leftEar.start.x, leftEar.start.y);\n    ctx.lineTo(leftEar.point.x, leftEar.point.y);\n    ctx.lineTo(leftEar.end.x, leftEar.end.y);\n    ctx.closePath();\n    ctx.fill();\n    ctx.stroke();\n\n    ctx.restore();\n  }\n\n  body() {\n    const {\n      ctx,\n      oneHalfCanvasHeight,\n      windowFrameThickness,\n      x,\n      headRadius,\n      bodyWidth,\n      bodyHeight\n    } = this;\n    const y = (oneHalfCanvasHeight * 3) / 2 - bodyHeight;\n\n    ctx.beginPath();\n    ctx.moveTo(x, y - headRadius / 2);\n    ctx.quadraticCurveTo(\n      x - bodyWidth * 0.75,\n      y + bodyHeight / 4,\n      x - bodyWidth / 3,\n      y + bodyHeight + windowFrameThickness\n    );\n    ctx.lineTo(x + bodyWidth / 2, y + bodyHeight + windowFrameThickness);\n    ctx.quadraticCurveTo(\n      x + bodyWidth * 1.2,\n      y + bodyHeight + windowFrameThickness,\n      x + bodyWidth / 3,\n      y - headRadius / 3\n    );\n    ctx.closePath();\n    ctx.fill();\n\n    // left leg\n    ctx.beginPath();\n    ctx.moveTo(x - bodyWidth / 4, y + bodyHeight * 0.3);\n    ctx.quadraticCurveTo(\n      x - bodyWidth,\n      y + bodyHeight,\n      x - bodyWidth / 3,\n      y + bodyHeight + windowFrameThickness\n    );\n    ctx.lineTo(x + bodyWidth / 2, y + bodyHeight + windowFrameThickness);\n    ctx.closePath();\n    ctx.fill();\n  }\n\n  tail() {\n    const { ctx, tailWidth, x, bodyWidth, tailY } = this;\n\n    ctx.lineWidth = tailWidth;\n    ctx.lineCap = 'round';\n    ctx.beginPath();\n    ctx.moveTo(x, tailY);\n    ctx.lineTo(x - bodyWidth, tailY);\n    ctx.stroke();\n  }\n\n  render() {\n    super.render();\n\n    const { ctx, canvasWidth, canvasHeight } = this;\n    ctx.clearRect(0, 0, canvasWidth, canvasHeight);\n\n    this.head();\n    this.body();\n    this.tail();\n  }\n\n  tick() {\n    const {\n      ctx,\n      canvasWidth,\n      canvasHeight,\n      createdTimestamp,\n      x,\n      bodyWidth,\n      tailY\n    } = this;\n    // tail wag\n    const timeDelta = Date.now() - createdTimestamp;\n\n    // oscillate between angles\n    let nextTailAngle =\n      -Math.PI / 2 + (Math.sin(timeDelta / 200) * -Math.PI) / 20;\n\n    if (this.prevTailAngle > -Math.PI / 2 && nextTailAngle < -Math.PI / 2) {\n      // each oscillation has a chance of producing a tail wag\n      this.isWagging = Math.random() < 0.2;\n    }\n\n    this.prevTailAngle = nextTailAngle;\n\n    if (nextTailAngle > -Math.PI / 2) {\n      nextTailAngle = -Math.PI / 2;\n    }\n\n    if (!this.isWagging) {\n      this.tail();\n      return;\n    }\n\n    ctx.clearRect(0, 0, canvasWidth, canvasHeight);\n\n    this.head();\n    this.body();\n\n    ctx.save();\n    ctx.translate(x, tailY);\n\n    const tailEnd = {\n      x: Math.sin(nextTailAngle) * bodyWidth,\n      y: Math.cos(nextTailAngle) * bodyWidth\n    };\n\n    ctx.beginPath();\n    ctx.moveTo(0, 0);\n    ctx.quadraticCurveTo(\n      -bodyWidth,\n      (-Math.cos(nextTailAngle) * bodyWidth) / 10,\n      tailEnd.x,\n      tailEnd.y\n    );\n    ctx.stroke();\n\n    ctx.restore();\n  }\n}\n","import { Renderer } from '../renderer';\nimport { radiansBetween } from '../utils';\n\nconst STEM_COLOR = '#8e8e8e';\nconst LIGHT_COLOR = 'rgba(252, 243, 126, 0.085)';\n\ntype ShadeCoords = { x: number; y: number };\n\nexport class Lamp extends Renderer {\n  private stemX: number;\n  private stemHeight: number;\n  private lampWidth: number;\n  private shadeTopLeft: ShadeCoords;\n  private shadeTopRight: ShadeCoords;\n  private shadeBottomRight: ShadeCoords;\n  private shadeBottomLeft: ShadeCoords;\n\n  constructor(ctx: CanvasRenderingContext2D) {\n    super(ctx);\n\n    const { canvasWidth, canvasHeight, windowFrameThickness } = this;\n\n    this.stemX = (canvasWidth * 7) / 11;\n    this.stemHeight = canvasHeight / 5;\n    this.lampWidth = windowFrameThickness * 3.5;\n\n    this.shadeTopLeft = {\n      x: this.stemX - windowFrameThickness / 5,\n      y: this.stemHeight + windowFrameThickness\n    };\n    this.shadeTopRight = {\n      x: this.stemX + windowFrameThickness / 5,\n      y: this.stemHeight + windowFrameThickness\n    };\n    this.shadeBottomRight = {\n      x: this.stemX + this.lampWidth / 2,\n      y: this.stemHeight + windowFrameThickness * 3\n    };\n    this.shadeBottomLeft = {\n      x: this.stemX - this.lampWidth / 2,\n      y: this.stemHeight + windowFrameThickness * 3\n    };\n  }\n\n  stem() {\n    const { ctx, windowFrameThickness, stemX, stemHeight } = this;\n\n    ctx.strokeStyle = STEM_COLOR;\n    ctx.fillStyle = STEM_COLOR;\n    ctx.lineWidth = windowFrameThickness / 5;\n\n    ctx.beginPath();\n    ctx.moveTo(stemX, 0);\n    ctx.lineTo(stemX, stemHeight);\n    ctx.stroke();\n\n    ctx.lineWidth = 1;\n    ctx.fillRect(\n      stemX - windowFrameThickness / 5,\n      stemHeight - 1,\n      (windowFrameThickness * 2) / 5,\n      windowFrameThickness\n    );\n    ctx.stroke();\n  }\n\n  lampshade() {\n    const {\n      ctx,\n      shadeTopLeft,\n      shadeTopRight,\n      shadeBottomRight,\n      shadeBottomLeft\n    } = this;\n\n    ctx.beginPath();\n    ctx.moveTo(shadeTopLeft.x, shadeTopLeft.y);\n    ctx.lineTo(shadeTopRight.x, shadeTopRight.y);\n    ctx.lineTo(shadeBottomRight.x, shadeBottomRight.y);\n    ctx.lineTo(shadeBottomLeft.x, shadeBottomLeft.y);\n    ctx.closePath();\n    ctx.fill();\n    ctx.stroke();\n\n    // thin line of bright light color at bottom\n    ctx.fillStyle = '#ff7';\n    ctx.fillRect(\n      shadeBottomLeft.x,\n      shadeBottomLeft.y,\n      shadeBottomRight.x - shadeBottomLeft.x,\n      2\n    );\n  }\n\n  light() {\n    const {\n      ctx,\n      canvasHeight,\n      windowFrameThickness,\n      stemX,\n      stemHeight,\n      lampWidth,\n      shadeTopLeft,\n      shadeBottomRight,\n      shadeBottomLeft\n    } = this;\n\n    ctx.fillStyle = LIGHT_COLOR;\n    const lightHeight = canvasHeight - shadeBottomLeft.y;\n    // compensate for inverted canvas y-coords when\n    // getting angle between lampshade corners\n    const lightAngle = radiansBetween(shadeBottomLeft, {\n      x: shadeTopLeft.x,\n      y: shadeBottomLeft.y + shadeBottomLeft.y - shadeTopLeft.y\n    });\n\n    // light makes a right triangle with bottom of canvas so\n    // we can calculate its adjacent width using height and\n    // the angle of the lampshade\n    // tan θ = opposite (height) / adjacent (width)\n    const lightTriangleAdjacentWidth = lightHeight / Math.tan(lightAngle);\n\n    const lightBottomLeftX = shadeBottomLeft.x - lightTriangleAdjacentWidth;\n    const lightBottomRightX = shadeBottomRight.x + lightTriangleAdjacentWidth;\n\n    ctx.beginPath();\n    ctx.moveTo(stemX - lampWidth / 2, stemHeight + windowFrameThickness * 3);\n    ctx.lineTo(stemX + lampWidth / 2, stemHeight + windowFrameThickness * 3);\n    ctx.lineTo(lightBottomRightX, canvasHeight);\n    ctx.lineTo(lightBottomLeftX, canvasHeight);\n    ctx.fill();\n  }\n\n  render() {\n    super.render();\n\n    this.stem();\n    this.lampshade();\n    this.tick();\n  }\n\n  tick() {\n    const {\n      ctx,\n      canvasWidth,\n      canvasHeight,\n      windowFrameThickness,\n      stemHeight\n    } = this;\n\n    ctx.clearRect(\n      0,\n      // add 2 to clear under the thin line\n      stemHeight + windowFrameThickness * 3 + 2,\n      canvasWidth,\n      canvasHeight\n    );\n\n    this.light();\n  }\n}\n","import { Renderer } from '../renderer';\nimport { Wall } from './wall';\nimport { Window } from './window';\nimport { Dresser } from './dresser';\nimport { Pictures } from './pictures';\nimport { Table } from './table';\nimport { Clock } from './clock';\nexport { Cat } from './cat';\nexport { Lamp } from './lamp';\n\nexport class Home extends Renderer {\n  wall: Wall;\n  window: Window;\n  dresser: Dresser;\n  pictures: Pictures;\n  table: Table;\n  clock: Clock;\n\n  constructor(ctx: CanvasRenderingContext2D) {\n    super(ctx);\n\n    this.wall = new Wall(ctx);\n    this.window = new Window(ctx);\n    this.dresser = new Dresser(ctx);\n    this.pictures = new Pictures(ctx);\n    this.table = new Table(ctx);\n    this.clock = new Clock(ctx);\n  }\n\n  render() {\n    this.wall.render();\n    this.window.render();\n    this.dresser.render();\n    this.pictures.render();\n    this.table.render();\n    this.clock.render();\n  }\n}\n","import React, { useRef, useEffect } from 'react';\nimport * as VisualizationHOC from '../VisualizationHOC';\nimport { City } from './city';\nimport { Rainfall } from './rain';\nimport { Home, Cat, Lamp } from './home';\nimport { useDebouncedResize } from '../../../../utils/hooks';\nimport './Rain.scss';\n\nconst MAX_RAINDROPS_PER_TICK = 8;\n\nconst Rain: React.FC<VisualizationHOC.WrappedProps> = ({\n  data,\n  isBeat,\n  lowPassIntensity\n}) => {\n  // city\n  const cityCanvasRef = useRef<HTMLCanvasElement>(null);\n  const cityRef = useRef<City>();\n\n  useDebouncedResize(() => {\n    const cityCanvas = cityCanvasRef.current!;\n\n    const createCity = (width: number, height: number, dpi: number) => {\n      cityCanvas.width = width * dpi;\n      cityCanvas.height = height * dpi;\n\n      const ctx = cityCanvas.getContext('2d')!;\n      const city = new City(ctx);\n      cityRef.current = city;\n      city.render();\n    };\n\n    const { innerWidth, innerHeight, devicePixelRatio } = window;\n    createCity(innerWidth, innerHeight, devicePixelRatio);\n  }, []);\n\n  // rain\n  const rainCanvasRef = useRef<HTMLCanvasElement>(null);\n  const rainfallRef = useRef<Rainfall>();\n\n  useDebouncedResize(() => {\n    const rainCanvas = rainCanvasRef.current!;\n\n    const createRain = (width: number, height: number, dpi: number) => {\n      rainCanvas.width = width * dpi;\n      rainCanvas.height = height * dpi;\n\n      const ctx = rainCanvas.getContext('2d')!;\n      let rainfall = rainfallRef.current;\n      if (rainfall == null) {\n        rainfallRef.current = new Rainfall(ctx);\n      } else {\n        rainfall = rainfallRef.current!;\n        rainfall.canvasWidth = width * dpi;\n        rainfall.canvasHeight = height * dpi;\n      }\n    };\n\n    const { innerWidth, innerHeight, devicePixelRatio } = window;\n    createRain(innerWidth, innerHeight, devicePixelRatio);\n\n    return () => {\n      if (rainfallRef.current) {\n        rainfallRef.current = undefined;\n      }\n    };\n  }, []);\n\n  const homeCanvasRef = useRef<HTMLCanvasElement>(null);\n  const homeRef = useRef<Home>();\n  const clockIntervalRef = useRef<number>();\n\n  // home\n  useDebouncedResize(() => {\n    const homeCanvas = homeCanvasRef.current!;\n\n    const createHome = (width: number, height: number, dpi: number) => {\n      homeCanvas.width = width * dpi;\n      homeCanvas.height = height * dpi;\n\n      const ctx = homeCanvas.getContext('2d')!;\n\n      const home = new Home(ctx);\n      homeRef.current = home;\n      home.render();\n\n      clockIntervalRef.current && window.clearTimeout(clockIntervalRef.current);\n      clockIntervalRef.current = window.setInterval(\n        () => home.clock.tick(),\n        1000\n      );\n    };\n\n    const { innerWidth, innerHeight, devicePixelRatio } = window;\n    createHome(innerWidth, innerHeight, devicePixelRatio);\n  }, []);\n\n  // cat\n  const catCanvasRef = useRef<HTMLCanvasElement>(null);\n  const catRef = useRef<Cat>();\n\n  useDebouncedResize(() => {\n    const catCanvas = catCanvasRef.current!;\n\n    const adoptCat = (width: number, height: number, dpi: number) => {\n      catCanvas.width = width * dpi;\n      catCanvas.height = height * dpi;\n\n      const ctx = catCanvas.getContext('2d')!;\n\n      const cat = new Cat(ctx);\n      catRef.current = cat;\n      cat.render();\n    };\n\n    const { innerWidth, innerHeight, devicePixelRatio } = window;\n    adoptCat(innerWidth, innerHeight, devicePixelRatio);\n  }, []);\n\n  // lamp\n  const lampCanvasRef = useRef<HTMLCanvasElement>(null);\n  const lampRef = useRef<Lamp>();\n\n  useDebouncedResize(() => {\n    const lampCanvas = lampCanvasRef.current!;\n\n    const createLamp = (width: number, height: number, dpi: number) => {\n      lampCanvas.width = width * dpi;\n      lampCanvas.height = height * dpi;\n\n      const ctx = lampCanvas.getContext('2d')!;\n\n      const lamp = new Lamp(ctx);\n      lampRef.current = lamp;\n      lamp.render();\n    };\n\n    const { innerWidth, innerHeight, devicePixelRatio } = window;\n    createLamp(innerWidth, innerHeight, devicePixelRatio);\n  }, []);\n\n  // call animating effects on each data change\n  useEffect(() => {\n    const home = homeRef.current!;\n    const rainfall = rainfallRef.current!;\n    const cat = catRef.current!;\n    const lamp = lampRef.current!;\n\n    let raindropsToAdd = Math.floor(lowPassIntensity / 5);\n\n    if (raindropsToAdd > MAX_RAINDROPS_PER_TICK) {\n      raindropsToAdd = MAX_RAINDROPS_PER_TICK;\n    }\n\n    for (\n      let raindropsAdded = 0;\n      raindropsAdded < raindropsToAdd;\n      raindropsAdded++\n    ) {\n      rainfall.add();\n    }\n\n    rainfall.tick();\n    const { wasBeat } = home.dresser;\n    home.dresser.tick(isBeat);\n    // re-render lamp light since the dresser stereo\n    // may have been repainted by changing isBeat\n    if (wasBeat !== isBeat) {\n      lamp.tick();\n    }\n    cat.tick();\n\n    const rainCanvas = rainCanvasRef.current!;\n    const rainCtx = rainCanvas.getContext('2d')!;\n\n    rainCtx.clearRect(0, 0, rainCanvas.width, rainCanvas.height);\n\n    rainfall.render();\n  }, [data]);\n\n  return (\n    <div className=\"rain\">\n      <canvas ref={cityCanvasRef} />\n      <canvas ref={rainCanvasRef} />\n      <canvas ref={homeCanvasRef} />\n      <canvas ref={catCanvasRef} />\n      <canvas ref={lampCanvasRef} />\n    </div>\n  );\n};\n\nexport default VisualizationHOC.wrap(Rain);\n"],"sourceRoot":""}